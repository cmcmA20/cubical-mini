<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Solver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Solver.html" class="Module">Meta.Solver</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Meta.Literals.FromString.html" class="Module">Meta.Literals.FromString</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Meta.Variables.html" class="Module">Meta.Variables</a>
<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Meta.Reflection.html" class="Module">Meta.Reflection</a>

<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="227" class="Keyword">open</a> <a id="232" class="Keyword">import</a> <a id="239" href="Data.List.Instances.FromProduct.html" class="Module">Data.List.Instances.FromProduct</a>
<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>

<a id="300" class="Keyword">private</a> <a id="308" class="Keyword">variable</a>
  <a id="319" href="Meta.Solver.html#319" class="Generalizable">ℓ</a> <a id="321" class="Symbol">:</a> <a id="323" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="331" href="Meta.Solver.html#331" class="Generalizable">A</a> <a id="333" class="Symbol">:</a> <a id="335" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="340" href="Meta.Solver.html#319" class="Generalizable">ℓ</a>

<a id="343" class="Comment">--------------------------------------------------------------------------------</a>
<a id="424" class="Comment">-- Helpers</a>

<a id="solver-failed"></a><a id="436" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="450" class="Symbol">:</a> <a id="452" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="457" class="Symbol">→</a> <a id="459" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="464" class="Symbol">→</a> <a id="466" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="469" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="471" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="485" href="Meta.Solver.html#485" class="Bound">lhs</a> <a id="489" href="Meta.Solver.html#489" class="Bound">rhs</a> <a id="493" class="Symbol">=</a> <a id="495" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a>
  <a id="507" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="509" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="516" class="String">&quot;Could not equate the following expressions:\n  &quot;</a>
  <a id="568" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="570" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="578" href="Meta.Solver.html#485" class="Bound">lhs</a>
  <a id="584" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="586" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="593" class="String">&quot;\nAnd\n  &quot;</a> <a id="605" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="607" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="615" href="Meta.Solver.html#489" class="Bound">rhs</a> <a id="619" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

<a id="print-repr"></a><a id="622" href="Meta.Solver.html#622" class="Function">print-repr</a> <a id="633" class="Symbol">:</a> <a id="635" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="640" class="Symbol">→</a> <a id="642" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="647" class="Symbol">→</a> <a id="649" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="652" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="654" href="Meta.Solver.html#622" class="Function">print-repr</a> <a id="665" href="Meta.Solver.html#665" class="Bound">tm</a> <a id="668" href="Meta.Solver.html#668" class="Bound">repr</a> <a id="673" class="Symbol">=</a> <a id="675" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a>
  <a id="687" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="689" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="696" class="String">&quot;The expression\n  &quot;</a> <a id="717" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="719" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="727" href="Meta.Solver.html#665" class="Bound">tm</a>
  <a id="732" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="734" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="741" class="String">&quot;\nIs represented by the expression\n  &quot;</a>
  <a id="784" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="786" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="794" href="Meta.Solver.html#668" class="Bound">repr</a> <a id="799" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

<a id="print-var-repr"></a><a id="802" href="Meta.Solver.html#802" class="Function">print-var-repr</a> <a id="817" class="Symbol">:</a> <a id="819" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="824" class="Symbol">→</a> <a id="826" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="831" class="Symbol">→</a> <a id="833" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="838" class="Symbol">→</a> <a id="840" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="843" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="845" href="Meta.Solver.html#802" class="Function">print-var-repr</a> <a id="860" href="Meta.Solver.html#860" class="Bound">tm</a> <a id="863" href="Meta.Solver.html#863" class="Bound">repr</a> <a id="868" href="Meta.Solver.html#868" class="Bound">env</a> <a id="872" class="Symbol">=</a> <a id="874" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a>
  <a id="886" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="888" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="895" class="String">&quot;The expression\n  &quot;</a> <a id="916" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="918" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="926" href="Meta.Solver.html#860" class="Bound">tm</a>
  <a id="931" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="933" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="940" class="String">&quot;\nIs represented by the expression\n  &quot;</a>
  <a id="983" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="985" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="993" href="Meta.Solver.html#863" class="Bound">repr</a>
  <a id="1000" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1002" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="1009" class="String">&quot;\nIn the environment\n  &quot;</a> <a id="1036" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1038" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="1046" href="Meta.Solver.html#868" class="Bound">env</a> <a id="1050" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

<a id="1053" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1134" class="Comment">-- Simple Solvers</a>

<a id="1153" class="Keyword">record</a> <a id="Simple-solver"></a><a id="1160" href="Meta.Solver.html#1160" class="Record">Simple-solver</a> <a id="1174" class="Symbol">:</a> <a id="1176" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1181" class="Keyword">where</a>
  <a id="1189" class="Keyword">constructor</a> <a id="simple-solver"></a><a id="1201" href="Meta.Solver.html#1201" class="InductiveConstructor">simple-solver</a>
  <a id="1217" class="Keyword">field</a>
    <a id="Simple-solver.dont-reduce"></a><a id="1227" href="Meta.Solver.html#1227" class="Field">dont-reduce</a>       <a id="1245" class="Symbol">:</a> <a id="1247" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1252" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="Simple-solver.build-expr"></a><a id="1261" href="Meta.Solver.html#1261" class="Field">build-expr</a>        <a id="1279" class="Symbol">:</a> <a id="1281" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1286" class="Symbol">→</a> <a id="1288" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1291" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="Simple-solver.invoke-solver"></a><a id="1300" href="Meta.Solver.html#1300" class="Field">invoke-solver</a>     <a id="1318" class="Symbol">:</a> <a id="1320" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1325" class="Symbol">→</a> <a id="1327" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1332" class="Symbol">→</a> <a id="1334" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="Simple-solver.invoke-normaliser"></a><a id="1343" href="Meta.Solver.html#1343" class="Field">invoke-normaliser</a> <a id="1361" class="Symbol">:</a> <a id="1363" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>

<a id="1376" class="Keyword">module</a> <a id="1383" href="Meta.Solver.html#1383" class="Module">_</a> <a id="1385" class="Symbol">(</a><a id="1386" href="Meta.Solver.html#1386" class="Bound">solver</a> <a id="1393" class="Symbol">:</a> <a id="1395" href="Meta.Solver.html#1160" class="Record">Simple-solver</a><a id="1408" class="Symbol">)</a> <a id="1410" class="Keyword">where</a>
  <a id="1418" class="Keyword">open</a> <a id="1423" href="Meta.Solver.html#1160" class="Module">Simple-solver</a> <a id="1437" href="Meta.Solver.html#1386" class="Bound">solver</a>

  <a id="1447" href="Meta.Solver.html#1447" class="Function">mk-simple-solver</a> <a id="1464" class="Symbol">:</a> <a id="1466" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1471" class="Symbol">→</a> <a id="1473" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1476" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1480" href="Meta.Solver.html#1447" class="Function">mk-simple-solver</a> <a id="1497" href="Meta.Solver.html#1497" class="Bound">hole</a> <a id="1502" class="Symbol">=</a> <a id="1504" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="1522" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1528" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="1530" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="1545" class="Symbol">(</a><a id="1546" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1552" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1554" href="Meta.Solver.html#1227" class="Field">dont-reduce</a><a id="1565" class="Symbol">)</a> <a id="1567" class="Keyword">do</a>
      <a id="1576" href="Meta.Solver.html#1576" class="Bound">goal</a> <a id="1581" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1583" href="Agda.Builtin.Reflection.html#8878" class="Postulate">inferType</a> <a id="1593" href="Meta.Solver.html#1497" class="Bound">hole</a> <a id="1598" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1602" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a>
      <a id="1615" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1620" class="Symbol">(</a><a id="1621" href="Meta.Solver.html#1621" class="Bound">lhs</a> <a id="1625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1627" href="Meta.Solver.html#1627" class="Bound">rhs</a><a id="1630" class="Symbol">)</a> <a id="1632" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1634" href="Meta.Reflection.html#7638" class="Function">get-boundary</a> <a id="1647" href="Meta.Solver.html#1576" class="Bound">goal</a> <a id="1652" class="Keyword">where</a>
        <a id="1666" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1674" class="Symbol">→</a> <a id="1676" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="1686" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="1688" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="1695" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="1724" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1726" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="1734" href="Meta.Solver.html#1576" class="Bound">goal</a> <a id="1739" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>
      <a id="1747" href="Meta.Solver.html#1747" class="Bound">elhs</a> <a id="1752" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1754" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="1764" href="Meta.Solver.html#1621" class="Bound">lhs</a> <a id="1768" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1772" href="Meta.Solver.html#1261" class="Field">build-expr</a>
      <a id="1789" href="Meta.Solver.html#1789" class="Bound">erhs</a> <a id="1794" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1796" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="1806" href="Meta.Solver.html#1627" class="Bound">rhs</a> <a id="1810" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1814" href="Meta.Solver.html#1261" class="Field">build-expr</a>
      <a id="1831" href="Agda.Builtin.Reflection.html#11202" class="Postulate">noConstraints</a> <a id="1845" class="Symbol">(</a><a id="1846" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="1852" href="Meta.Solver.html#1497" class="Bound">hole</a> <a id="1857" class="Symbol">(</a><a id="1858" href="Meta.Solver.html#1300" class="Field">invoke-solver</a> <a id="1872" href="Meta.Solver.html#1747" class="Bound">elhs</a> <a id="1877" href="Meta.Solver.html#1789" class="Bound">erhs</a><a id="1881" class="Symbol">))</a>
        <a id="1892" href="Meta.Alt.html#315" class="Field Operator">&lt;|&gt;</a> <a id="1896" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="1910" href="Meta.Solver.html#1747" class="Bound">elhs</a> <a id="1915" href="Meta.Solver.html#1789" class="Bound">erhs</a>

  <a id="1923" href="Meta.Solver.html#1923" class="Function">mk-simple-normalise</a> <a id="1943" class="Symbol">:</a> <a id="1945" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1950" class="Symbol">→</a> <a id="1952" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1957" class="Symbol">→</a> <a id="1959" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1962" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1966" href="Meta.Solver.html#1923" class="Function">mk-simple-normalise</a> <a id="1986" href="Meta.Solver.html#1986" class="Bound">tm</a> <a id="1989" href="Meta.Solver.html#1989" class="Bound">hole</a> <a id="1994" class="Symbol">=</a> <a id="1996" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="2014" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2020" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2022" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="2037" class="Symbol">(</a><a id="2038" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2044" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2046" href="Meta.Solver.html#1227" class="Field">dont-reduce</a><a id="2057" class="Symbol">)</a> <a id="2059" class="Keyword">do</a>
      <a id="2068" href="Meta.Solver.html#2068" class="Bound">e</a> <a id="2070" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2072" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="2082" href="Meta.Solver.html#1986" class="Bound">tm</a> <a id="2085" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2089" href="Meta.Solver.html#1261" class="Field">build-expr</a>
      <a id="2106" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="2112" href="Meta.Solver.html#1989" class="Bound">hole</a> <a id="2117" class="Symbol">(</a><a id="2118" href="Meta.Solver.html#1343" class="Field">invoke-normaliser</a> <a id="2136" href="Meta.Solver.html#2068" class="Bound">e</a><a id="2137" class="Symbol">)</a>

  <a id="2142" href="Meta.Solver.html#2142" class="Function">mk-simple-repr</a> <a id="2157" class="Symbol">:</a> <a id="2159" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2164" class="Symbol">→</a> <a id="2166" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2171" class="Symbol">→</a> <a id="2173" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2176" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2180" href="Meta.Solver.html#2142" class="Function">mk-simple-repr</a> <a id="2195" href="Meta.Solver.html#2195" class="Bound">tm</a> <a id="2198" class="Symbol">_</a> <a id="2200" class="Symbol">=</a> <a id="2202" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="2220" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2226" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2228" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="2243" class="Symbol">(</a><a id="2244" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2250" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2252" href="Meta.Solver.html#1227" class="Field">dont-reduce</a><a id="2263" class="Symbol">)</a> <a id="2265" class="Keyword">do</a>
      <a id="2274" href="Meta.Solver.html#2274" class="Bound">repr</a> <a id="2279" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2281" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="2291" href="Meta.Solver.html#2195" class="Bound">tm</a> <a id="2294" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2298" href="Meta.Solver.html#1261" class="Field">build-expr</a>
      <a id="2315" href="Meta.Solver.html#622" class="Function">print-repr</a> <a id="2326" href="Meta.Solver.html#2195" class="Bound">tm</a> <a id="2329" href="Meta.Solver.html#2274" class="Bound">repr</a>

<a id="2335" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2416" class="Comment">-- Solvers with Variables</a>

<a id="2443" class="Keyword">record</a> <a id="Variable-solver"></a><a id="2450" href="Meta.Solver.html#2450" class="Record">Variable-solver</a> <a id="2466" class="Symbol">{</a><a id="2467" href="Meta.Solver.html#2467" class="Bound">ℓ</a><a id="2468" class="Symbol">}</a> <a id="2470" class="Symbol">(</a><a id="2471" href="Meta.Solver.html#2471" class="Bound">A</a> <a id="2473" class="Symbol">:</a> <a id="2475" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2480" href="Meta.Solver.html#2467" class="Bound">ℓ</a><a id="2481" class="Symbol">)</a> <a id="2483" class="Symbol">:</a> <a id="2485" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2490" href="Meta.Solver.html#2467" class="Bound">ℓ</a> <a id="2492" class="Keyword">where</a>
  <a id="2500" class="Keyword">constructor</a> <a id="var-solver"></a><a id="2512" href="Meta.Solver.html#2512" class="InductiveConstructor">var-solver</a>
  <a id="2525" class="Keyword">field</a>
    <a id="Variable-solver.dont-reduce"></a><a id="2535" href="Meta.Solver.html#2535" class="Field">dont-reduce</a> <a id="2547" class="Symbol">:</a> <a id="2549" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2554" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="Variable-solver.build-expr"></a><a id="2563" href="Meta.Solver.html#2563" class="Field">build-expr</a> <a id="2574" class="Symbol">:</a> <a id="2576" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="2586" href="Meta.Solver.html#2471" class="Bound">A</a> <a id="2588" class="Symbol">→</a> <a id="2590" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2595" class="Symbol">→</a> <a id="2597" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2600" class="Symbol">(</a><a id="2601" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2606" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="2608" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="2618" href="Meta.Solver.html#2471" class="Bound">A</a><a id="2619" class="Symbol">)</a>
    <a id="Variable-solver.invoke-solver"></a><a id="2625" href="Meta.Solver.html#2625" class="Field">invoke-solver</a> <a id="2639" class="Symbol">:</a> <a id="2641" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2646" class="Symbol">→</a> <a id="2648" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2653" class="Symbol">→</a> <a id="2655" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2660" class="Symbol">→</a> <a id="2662" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="Variable-solver.invoke-normaliser"></a><a id="2671" href="Meta.Solver.html#2671" class="Field">invoke-normaliser</a> <a id="2689" class="Symbol">:</a> <a id="2691" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2696" class="Symbol">→</a> <a id="2698" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2703" class="Symbol">→</a> <a id="2705" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>

<a id="2711" class="Keyword">module</a> <a id="2718" href="Meta.Solver.html#2718" class="Module">_</a> <a id="2720" class="Symbol">{</a><a id="2721" href="Meta.Solver.html#2721" class="Bound">ℓ</a><a id="2722" class="Symbol">}</a> <a id="2724" class="Symbol">{</a><a id="2725" href="Meta.Solver.html#2725" class="Bound">A</a> <a id="2727" class="Symbol">:</a> <a id="2729" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2734" href="Meta.Solver.html#2721" class="Bound">ℓ</a><a id="2735" class="Symbol">}</a> <a id="2737" class="Symbol">(</a><a id="2738" href="Meta.Solver.html#2738" class="Bound">solver</a> <a id="2745" class="Symbol">:</a> <a id="2747" href="Meta.Solver.html#2450" class="Record">Variable-solver</a> <a id="2763" href="Meta.Solver.html#2725" class="Bound">A</a><a id="2764" class="Symbol">)</a> <a id="2766" class="Keyword">where</a>
  <a id="2774" class="Keyword">open</a> <a id="2779" href="Meta.Solver.html#2450" class="Module">Variable-solver</a> <a id="2795" href="Meta.Solver.html#2738" class="Bound">solver</a>

  <a id="2805" href="Meta.Solver.html#2805" class="Function">mk-var-solver</a> <a id="2819" class="Symbol">:</a> <a id="2821" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2826" class="Symbol">→</a> <a id="2828" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2831" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2835" href="Meta.Solver.html#2805" class="Function">mk-var-solver</a> <a id="2849" href="Meta.Solver.html#2849" class="Bound">hole</a> <a id="2854" class="Symbol">=</a>
    <a id="2860" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="2878" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2884" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a>
    <a id="2890" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="2905" class="Symbol">(</a><a id="2906" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2912" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2914" href="Meta.Solver.html#2535" class="Field">dont-reduce</a><a id="2925" class="Symbol">)</a> <a id="2927" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2929" class="Keyword">do</a>
    <a id="2936" href="Meta.Solver.html#2936" class="Bound">goal</a> <a id="2941" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2943" href="Agda.Builtin.Reflection.html#8878" class="Postulate">inferType</a> <a id="2953" href="Meta.Solver.html#2849" class="Bound">hole</a> <a id="2958" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2962" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a>
    <a id="2973" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2978" class="Symbol">(</a><a id="2979" href="Meta.Solver.html#2979" class="Bound">lhs</a> <a id="2983" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2985" href="Meta.Solver.html#2985" class="Bound">rhs</a><a id="2988" class="Symbol">)</a> <a id="2990" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2992" href="Meta.Reflection.html#7638" class="Function">get-boundary</a> <a id="3005" href="Meta.Solver.html#2936" class="Bound">goal</a>
      <a id="3016" class="Keyword">where</a> <a id="3022" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3030" class="Symbol">→</a> <a id="3032" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="3042" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3044" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="3051" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="3080" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                                  <a id="3116" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="3124" href="Meta.Solver.html#2936" class="Bound">goal</a> <a id="3129" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3131" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="3138" href="Meta.Solver.html#3138" class="Bound">elhs</a> <a id="3143" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3145" href="Meta.Solver.html#3145" class="Bound">vs</a> <a id="3148" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3150" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="3160" href="Meta.Solver.html#2979" class="Bound">lhs</a> <a id="3164" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3168" href="Meta.Solver.html#2563" class="Field">build-expr</a> <a id="3179" href="Meta.Variables.html#2150" class="Function">empty-vars</a>
    <a id="3194" href="Meta.Solver.html#3194" class="Bound">erhs</a> <a id="3199" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3201" href="Meta.Solver.html#3201" class="Bound">vs</a> <a id="3204" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3206" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="3216" href="Meta.Solver.html#2985" class="Bound">rhs</a> <a id="3220" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3224" href="Meta.Solver.html#2563" class="Field">build-expr</a> <a id="3235" href="Meta.Solver.html#3145" class="Bound">vs</a>
    <a id="3242" href="Meta.Solver.html#3242" class="Bound">size</a> <a id="3247" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3249" href="Meta.Solver.html#3249" class="Bound">env</a> <a id="3253" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3255" href="Meta.Variables.html#3404" class="Function">environment</a> <a id="3267" href="Meta.Solver.html#3201" class="Bound">vs</a>
    <a id="3274" class="Symbol">(</a><a id="3275" href="Agda.Builtin.Reflection.html#11202" class="Postulate">noConstraints</a> <a id="3289" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3291" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="3297" href="Meta.Solver.html#2849" class="Bound">hole</a> <a id="3302" class="Symbol">(</a><a id="3303" href="Meta.Solver.html#2625" class="Field">invoke-solver</a> <a id="3317" href="Meta.Solver.html#3138" class="Bound">elhs</a> <a id="3322" href="Meta.Solver.html#3194" class="Bound">erhs</a> <a id="3327" href="Meta.Solver.html#3249" class="Bound">env</a><a id="3330" class="Symbol">))</a> <a id="3333" href="Meta.Alt.html#315" class="Field Operator">&lt;|&gt;</a>
      <a id="3343" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="3353" class="Symbol">(</a><a id="3354" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="3361" class="String">&quot;Could not equate the following expressions:\n  &quot;</a> <a id="3411" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                   <a id="3432" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="3440" href="Meta.Solver.html#3138" class="Bound">elhs</a> <a id="3445" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="3464" href="Agda.Builtin.Reflection.html#8223" class="InductiveConstructor">strErr</a> <a id="3471" class="String">&quot;\nAnd\n  &quot;</a> <a id="3483" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                   <a id="3504" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="3512" href="Meta.Solver.html#3194" class="Bound">erhs</a> <a id="3517" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3519" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3521" class="Symbol">)</a>

  <a id="3526" href="Meta.Solver.html#3526" class="Function">mk-var-normalise</a> <a id="3543" class="Symbol">:</a> <a id="3545" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3550" class="Symbol">→</a> <a id="3552" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3557" class="Symbol">→</a> <a id="3559" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3562" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3566" href="Meta.Solver.html#3526" class="Function">mk-var-normalise</a> <a id="3583" href="Meta.Solver.html#3583" class="Bound">tm</a> <a id="3586" href="Meta.Solver.html#3586" class="Bound">hole</a> <a id="3591" class="Symbol">=</a>
    <a id="3597" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="3615" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3621" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a>
    <a id="3627" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="3642" class="Symbol">(</a><a id="3643" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3651" href="Meta.Solver.html#2535" class="Field">dont-reduce</a><a id="3662" class="Symbol">)</a> <a id="3664" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3666" class="Keyword">do</a>
    <a id="3673" href="Meta.Solver.html#3673" class="Bound">e</a> <a id="3675" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3677" href="Meta.Solver.html#3677" class="Bound">vs</a> <a id="3680" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3682" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="3692" href="Meta.Solver.html#3583" class="Bound">tm</a> <a id="3695" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3699" href="Meta.Solver.html#2563" class="Field">build-expr</a> <a id="3710" href="Meta.Variables.html#2150" class="Function">empty-vars</a>
    <a id="3725" href="Meta.Solver.html#3725" class="Bound">size</a> <a id="3730" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3732" href="Meta.Solver.html#3732" class="Bound">env</a> <a id="3736" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3738" href="Meta.Variables.html#3404" class="Function">environment</a> <a id="3750" href="Meta.Solver.html#3677" class="Bound">vs</a>
    <a id="3757" href="Meta.Solver.html#3757" class="Bound">soln</a> <a id="3762" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3764" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a> <a id="3771" class="Symbol">(</a><a id="3772" href="Meta.Solver.html#2671" class="Field">invoke-normaliser</a> <a id="3790" href="Meta.Solver.html#3673" class="Bound">e</a> <a id="3792" href="Meta.Solver.html#3732" class="Bound">env</a><a id="3795" class="Symbol">)</a>
    <a id="3801" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="3807" href="Meta.Solver.html#3586" class="Bound">hole</a> <a id="3812" href="Meta.Solver.html#3757" class="Bound">soln</a>

  <a id="3820" href="Meta.Solver.html#3820" class="Function">mk-var-repr</a> <a id="3832" class="Symbol">:</a> <a id="3834" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3839" class="Symbol">→</a> <a id="3841" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3844" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3848" href="Meta.Solver.html#3820" class="Function">mk-var-repr</a> <a id="3860" href="Meta.Solver.html#3860" class="Bound">tm</a> <a id="3863" class="Symbol">=</a>
    <a id="3869" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="3887" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3893" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a>
    <a id="3899" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="3914" class="Symbol">(</a><a id="3915" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3921" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3923" href="Meta.Solver.html#2535" class="Field">dont-reduce</a><a id="3934" class="Symbol">)</a> <a id="3936" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3938" class="Keyword">do</a>
    <a id="3945" href="Meta.Solver.html#3945" class="Bound">repr</a> <a id="3950" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3952" href="Meta.Solver.html#3952" class="Bound">vs</a> <a id="3955" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3957" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a> <a id="3967" href="Meta.Solver.html#3860" class="Bound">tm</a> <a id="3970" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3974" href="Meta.Solver.html#2563" class="Field">build-expr</a> <a id="3985" href="Meta.Variables.html#2150" class="Function">empty-vars</a>
    <a id="4000" href="Meta.Solver.html#4000" class="Bound">size</a> <a id="4005" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4007" href="Meta.Solver.html#4007" class="Bound">env</a> <a id="4011" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4013" href="Meta.Variables.html#3404" class="Function">environment</a> <a id="4025" href="Meta.Solver.html#3952" class="Bound">vs</a>
    <a id="4032" href="Meta.Solver.html#802" class="Function">print-var-repr</a> <a id="4047" href="Meta.Solver.html#3860" class="Bound">tm</a> <a id="4050" href="Meta.Solver.html#3945" class="Bound">repr</a> <a id="4055" href="Meta.Solver.html#4007" class="Bound">env</a>
</pre></body></html>