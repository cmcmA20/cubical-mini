<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Solver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Solver.html" class="Module">Meta.Solver</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Meta.Literals.FromString.html" class="Module">Meta.Literals.FromString</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Meta.Variables.html" class="Module">Meta.Variables</a>
<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Meta.Reflection.html" class="Module">Meta.Reflection</a>

<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="200" class="Keyword">open</a> <a id="205" class="Keyword">import</a> <a id="212" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="227" class="Keyword">open</a> <a id="232" class="Keyword">import</a> <a id="239" href="Data.List.Instances.FromProduct.html" class="Module">Data.List.Instances.FromProduct</a>
<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>

<a id="300" class="Keyword">private</a> <a id="308" class="Keyword">variable</a>
  <a id="319" href="Meta.Solver.html#319" class="Generalizable">ℓ</a> <a id="321" class="Symbol">:</a> <a id="323" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="331" href="Meta.Solver.html#331" class="Generalizable">A</a> <a id="333" class="Symbol">:</a> <a id="335" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="340" href="Meta.Solver.html#319" class="Generalizable">ℓ</a>

<a id="343" class="Comment">--------------------------------------------------------------------------------</a>
<a id="424" class="Comment">-- Helpers</a>

<a id="solver-failed"></a><a id="436" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="450" class="Symbol">:</a> <a id="452" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="457" class="Symbol">→</a> <a id="459" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="464" class="Symbol">→</a> <a id="466" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="469" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="471" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="485" href="Meta.Solver.html#485" class="Bound">lhs</a> <a id="489" href="Meta.Solver.html#489" class="Bound">rhs</a> <a id="493" class="Symbol">=</a> <a id="495" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a>
  <a id="507" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="509" class="String">&quot;Could not equate the following expressions:\n  &quot;</a>
  <a id="561" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="563" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="571" href="Meta.Solver.html#485" class="Bound">lhs</a> <a id="575" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="577" class="String">&quot;\nAnd\n  &quot;</a> <a id="589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="591" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="599" href="Meta.Solver.html#489" class="Bound">rhs</a> <a id="603" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

<a id="print-repr"></a><a id="606" href="Meta.Solver.html#606" class="Function">print-repr</a> <a id="617" class="Symbol">:</a> <a id="619" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="624" class="Symbol">→</a> <a id="626" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="631" class="Symbol">→</a> <a id="633" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="636" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="638" href="Meta.Solver.html#606" class="Function">print-repr</a> <a id="649" href="Meta.Solver.html#649" class="Bound">tm</a> <a id="652" href="Meta.Solver.html#652" class="Bound">repr</a> <a id="657" class="Symbol">=</a> <a id="659" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a>
  <a id="671" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="673" class="String">&quot;The expression\n  &quot;</a> <a id="694" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="696" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="704" href="Meta.Solver.html#649" class="Bound">tm</a>
  <a id="709" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="711" class="String">&quot;\nIs represented by the expression\n  &quot;</a> <a id="752" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="754" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="762" href="Meta.Solver.html#652" class="Bound">repr</a> <a id="767" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

<a id="print-var-repr"></a><a id="770" href="Meta.Solver.html#770" class="Function">print-var-repr</a> <a id="785" class="Symbol">:</a> <a id="787" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="792" class="Symbol">→</a> <a id="794" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="799" class="Symbol">→</a> <a id="801" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="806" class="Symbol">→</a> <a id="808" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="811" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="813" href="Meta.Solver.html#770" class="Function">print-var-repr</a> <a id="828" href="Meta.Solver.html#828" class="Bound">tm</a> <a id="831" href="Meta.Solver.html#831" class="Bound">repr</a> <a id="836" href="Meta.Solver.html#836" class="Bound">env</a> <a id="840" class="Symbol">=</a> <a id="842" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a>
  <a id="854" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="856" class="String">&quot;The expression\n  &quot;</a> <a id="877" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="879" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="887" href="Meta.Solver.html#828" class="Bound">tm</a>
  <a id="892" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="894" class="String">&quot;\nIs represented by the expression\n  &quot;</a> <a id="935" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="937" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="945" href="Meta.Solver.html#831" class="Bound">repr</a>
  <a id="952" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="954" class="String">&quot;\nIn the environment\n  &quot;</a> <a id="981" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="983" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="991" href="Meta.Solver.html#836" class="Bound">env</a> <a id="995" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

<a id="print-boundary"></a><a id="998" href="Meta.Solver.html#998" class="Function">print-boundary</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1020" class="Symbol">→</a> <a id="1022" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1025" href="Meta.Solver.html#331" class="Generalizable">A</a>
<a id="1027" href="Meta.Solver.html#998" class="Function">print-boundary</a> <a id="1042" href="Meta.Solver.html#1042" class="Bound">goal</a> <a id="1047" class="Symbol">=</a> <a id="1049" href="Agda.Builtin.Reflection.html#8815" class="Postulate">typeError</a> <a id="1059" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="1061" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="1090" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1092" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="1100" href="Meta.Solver.html#1042" class="Bound">goal</a> <a id="1105" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>


<a id="1109" class="Keyword">data</a> <a id="Reduction-strategy"></a><a id="1114" href="Meta.Solver.html#1114" class="Datatype">Reduction-strategy</a> <a id="1133" class="Symbol">:</a> <a id="1135" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1140" class="Keyword">where</a>
  <a id="Reduction-strategy.no"></a><a id="1148" href="Meta.Solver.html#1148" class="InductiveConstructor">no</a> <a id="Reduction-strategy.whnf"></a><a id="1151" href="Meta.Solver.html#1151" class="InductiveConstructor">whnf</a> <a id="Reduction-strategy.norm"></a><a id="1156" href="Meta.Solver.html#1156" class="InductiveConstructor">norm</a> <a id="1161" class="Symbol">:</a> <a id="1163" href="Meta.Solver.html#1114" class="Datatype">Reduction-strategy</a>

<a id="1183" class="Keyword">private</a>
  <a id="prepare′"></a><a id="1193" href="Meta.Solver.html#1193" class="Function">prepare′</a> <a id="1202" class="Symbol">:</a> <a id="1204" href="Meta.Solver.html#1114" class="Datatype">Reduction-strategy</a> <a id="1223" class="Symbol">→</a> <a id="1225" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1230" class="Symbol">→</a> <a id="1232" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1235" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1242" href="Meta.Solver.html#1193" class="Function">prepare′</a> <a id="1251" href="Meta.Solver.html#1148" class="InductiveConstructor">no</a>   <a id="1256" class="Symbol">=</a> <a id="1258" href="Meta.Idiom.html#555" class="Field">pure</a>
  <a id="1265" href="Meta.Solver.html#1193" class="Function">prepare′</a> <a id="1274" href="Meta.Solver.html#1151" class="InductiveConstructor">whnf</a> <a id="1279" class="Symbol">=</a> <a id="1281" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a>
  <a id="1290" href="Meta.Solver.html#1193" class="Function">prepare′</a> <a id="1299" href="Meta.Solver.html#1156" class="InductiveConstructor">norm</a> <a id="1304" class="Symbol">=</a> <a id="1306" href="Agda.Builtin.Reflection.html#8957" class="Postulate">normalise</a>


<a id="1318" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1399" class="Comment">-- Simple Solvers</a>

<a id="1418" class="Keyword">record</a> <a id="Simple-solver"></a><a id="1425" href="Meta.Solver.html#1425" class="Record">Simple-solver</a> <a id="1439" class="Symbol">:</a> <a id="1441" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1446" class="Keyword">where</a>
  <a id="1454" class="Keyword">constructor</a> <a id="simple-solver"></a><a id="1466" href="Meta.Solver.html#1466" class="InductiveConstructor">simple-solver</a>
  <a id="1482" class="Keyword">field</a>
    <a id="Simple-solver.dont-reduce"></a><a id="1492" href="Meta.Solver.html#1492" class="Field">dont-reduce</a>       <a id="1510" class="Symbol">:</a> <a id="1512" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1517" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="Simple-solver.build-expr"></a><a id="1526" href="Meta.Solver.html#1526" class="Field">build-expr</a>        <a id="1544" class="Symbol">:</a> <a id="1546" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1551" class="Symbol">→</a> <a id="1553" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1556" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="Simple-solver.strat"></a><a id="1565" href="Meta.Solver.html#1565" class="Field">strat</a>             <a id="1583" class="Symbol">:</a> <a id="1585" href="Meta.Solver.html#1114" class="Datatype">Reduction-strategy</a>
    <a id="Simple-solver.invoke-solver"></a><a id="1608" href="Meta.Solver.html#1608" class="Field">invoke-solver</a>     <a id="1626" class="Symbol">:</a> <a id="1628" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1633" class="Symbol">→</a> <a id="1635" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1640" class="Symbol">→</a> <a id="1642" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="Simple-solver.invoke-normaliser"></a><a id="1651" href="Meta.Solver.html#1651" class="Field">invoke-normaliser</a> <a id="1669" class="Symbol">:</a> <a id="1671" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1676" class="Symbol">→</a> <a id="1678" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>

  <a id="Simple-solver.prepare"></a><a id="1686" href="Meta.Solver.html#1686" class="Function">prepare</a> <a id="1694" class="Symbol">=</a> <a id="1696" href="Meta.Solver.html#1193" class="Function">prepare′</a> <a id="1705" href="Meta.Solver.html#1565" class="Field">strat</a>

<a id="1712" class="Keyword">module</a> <a id="1719" href="Meta.Solver.html#1719" class="Module">_</a> <a id="1721" class="Symbol">(</a><a id="1722" href="Meta.Solver.html#1722" class="Bound">solver</a> <a id="1729" class="Symbol">:</a> <a id="1731" href="Meta.Solver.html#1425" class="Record">Simple-solver</a><a id="1744" class="Symbol">)</a> <a id="1746" class="Keyword">where</a>
  <a id="1754" class="Keyword">open</a> <a id="1759" href="Meta.Solver.html#1425" class="Module">Simple-solver</a> <a id="1773" href="Meta.Solver.html#1722" class="Bound">solver</a>

  <a id="1783" href="Meta.Solver.html#1783" class="Function">mk-simple-solver</a> <a id="1800" class="Symbol">:</a> <a id="1802" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1807" class="Symbol">→</a> <a id="1809" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1812" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1816" href="Meta.Solver.html#1783" class="Function">mk-simple-solver</a> <a id="1833" href="Meta.Solver.html#1833" class="Bound">hole</a> <a id="1838" class="Symbol">=</a> <a id="1840" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="1858" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1864" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="1866" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="1881" class="Symbol">(</a><a id="1882" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1888" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1890" href="Meta.Solver.html#1492" class="Field">dont-reduce</a><a id="1901" class="Symbol">)</a> <a id="1903" class="Keyword">do</a>
      <a id="1912" href="Meta.Solver.html#1912" class="Bound">goal</a> <a id="1917" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1919" href="Agda.Builtin.Reflection.html#8878" class="Postulate">inferType</a> <a id="1929" href="Meta.Solver.html#1833" class="Bound">hole</a> <a id="1934" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1938" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a>
      <a id="1951" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1956" class="Symbol">(</a><a id="1957" href="Meta.Solver.html#1957" class="Bound">lhs</a> <a id="1961" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1963" href="Meta.Solver.html#1963" class="Bound">rhs</a><a id="1966" class="Symbol">)</a> <a id="1968" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1970" href="Meta.Reflection.html#7652" class="Function">get-boundary</a> <a id="1983" href="Meta.Solver.html#1912" class="Bound">goal</a> <a id="1988" class="Keyword">where</a>
        <a id="2002" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2010" class="Symbol">→</a> <a id="2012" href="Meta.Solver.html#998" class="Function">print-boundary</a> <a id="2027" href="Meta.Solver.html#1912" class="Bound">goal</a>
      <a id="2038" href="Meta.Solver.html#2038" class="Bound">elhs</a> <a id="2043" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2045" href="Meta.Solver.html#1686" class="Function">prepare</a> <a id="2053" href="Meta.Solver.html#1957" class="Bound">lhs</a> <a id="2057" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2061" href="Meta.Solver.html#1526" class="Field">build-expr</a>
      <a id="2078" href="Meta.Solver.html#2078" class="Bound">erhs</a> <a id="2083" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2085" href="Meta.Solver.html#1686" class="Function">prepare</a> <a id="2093" href="Meta.Solver.html#1963" class="Bound">rhs</a> <a id="2097" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2101" href="Meta.Solver.html#1526" class="Field">build-expr</a>
      <a id="2118" href="Agda.Builtin.Reflection.html#11202" class="Postulate">noConstraints</a> <a id="2132" class="Symbol">(</a><a id="2133" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="2139" href="Meta.Solver.html#1833" class="Bound">hole</a> <a id="2144" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2146" href="Meta.Solver.html#1608" class="Field">invoke-solver</a> <a id="2160" href="Meta.Solver.html#2038" class="Bound">elhs</a> <a id="2165" href="Meta.Solver.html#2078" class="Bound">erhs</a><a id="2169" class="Symbol">)</a>
        <a id="2179" href="Meta.Alt.html#315" class="Field Operator">&lt;|&gt;</a> <a id="2183" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="2197" href="Meta.Solver.html#2038" class="Bound">elhs</a> <a id="2202" href="Meta.Solver.html#2078" class="Bound">erhs</a>

  <a id="2210" href="Meta.Solver.html#2210" class="Function">mk-simple-normalise</a> <a id="2230" class="Symbol">:</a> <a id="2232" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2237" class="Symbol">→</a> <a id="2239" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2244" class="Symbol">→</a> <a id="2246" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2249" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2253" href="Meta.Solver.html#2210" class="Function">mk-simple-normalise</a> <a id="2273" href="Meta.Solver.html#2273" class="Bound">tm</a> <a id="2276" href="Meta.Solver.html#2276" class="Bound">hole</a> <a id="2281" class="Symbol">=</a> <a id="2283" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="2301" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2307" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2309" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="2324" class="Symbol">(</a><a id="2325" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2331" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2333" href="Meta.Solver.html#1492" class="Field">dont-reduce</a><a id="2344" class="Symbol">)</a> <a id="2346" class="Keyword">do</a>
      <a id="2355" href="Meta.Solver.html#2355" class="Bound">e</a> <a id="2357" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2359" href="Meta.Solver.html#1686" class="Function">prepare</a> <a id="2367" href="Meta.Solver.html#2273" class="Bound">tm</a> <a id="2370" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2374" href="Meta.Solver.html#1526" class="Field">build-expr</a>
      <a id="2391" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="2397" href="Meta.Solver.html#2276" class="Bound">hole</a> <a id="2402" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2404" href="Meta.Solver.html#1651" class="Field">invoke-normaliser</a> <a id="2422" href="Meta.Solver.html#2355" class="Bound">e</a>

  <a id="2427" href="Meta.Solver.html#2427" class="Function">mk-simple-repr</a> <a id="2442" class="Symbol">:</a> <a id="2444" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2449" class="Symbol">→</a> <a id="2451" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2456" class="Symbol">→</a> <a id="2458" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2461" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2465" href="Meta.Solver.html#2427" class="Function">mk-simple-repr</a> <a id="2480" href="Meta.Solver.html#2480" class="Bound">tm</a> <a id="2483" class="Symbol">_</a> <a id="2485" class="Symbol">=</a> <a id="2487" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="2505" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2511" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="2513" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="2528" class="Symbol">(</a><a id="2529" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2535" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2537" href="Meta.Solver.html#1492" class="Field">dont-reduce</a><a id="2548" class="Symbol">)</a> <a id="2550" class="Keyword">do</a>
      <a id="2559" href="Meta.Solver.html#2559" class="Bound">repr</a> <a id="2564" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2566" href="Meta.Solver.html#1686" class="Function">prepare</a> <a id="2574" href="Meta.Solver.html#2480" class="Bound">tm</a> <a id="2577" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2581" href="Meta.Solver.html#1526" class="Field">build-expr</a>
      <a id="2598" href="Meta.Solver.html#606" class="Function">print-repr</a> <a id="2609" href="Meta.Solver.html#2480" class="Bound">tm</a> <a id="2612" href="Meta.Solver.html#2559" class="Bound">repr</a>


<a id="2619" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2700" class="Comment">-- Solvers with Variables</a>

<a id="2727" class="Keyword">record</a> <a id="Variable-solver"></a><a id="2734" href="Meta.Solver.html#2734" class="Record">Variable-solver</a> <a id="2750" class="Symbol">{</a><a id="2751" href="Meta.Solver.html#2751" class="Bound">ℓ</a><a id="2752" class="Symbol">}</a> <a id="2754" class="Symbol">(</a><a id="2755" href="Meta.Solver.html#2755" class="Bound">A</a> <a id="2757" class="Symbol">:</a> <a id="2759" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2764" href="Meta.Solver.html#2751" class="Bound">ℓ</a><a id="2765" class="Symbol">)</a> <a id="2767" class="Symbol">:</a> <a id="2769" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2774" href="Meta.Solver.html#2751" class="Bound">ℓ</a> <a id="2776" class="Keyword">where</a>
  <a id="2784" class="Keyword">constructor</a> <a id="var-solver"></a><a id="2796" href="Meta.Solver.html#2796" class="InductiveConstructor">var-solver</a>
  <a id="2809" class="Keyword">field</a>
    <a id="Variable-solver.dont-reduce"></a><a id="2819" href="Meta.Solver.html#2819" class="Field">dont-reduce</a>       <a id="2837" class="Symbol">:</a> <a id="2839" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2844" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="Variable-solver.build-expr"></a><a id="2853" href="Meta.Solver.html#2853" class="Field">build-expr</a>        <a id="2871" class="Symbol">:</a> <a id="2873" href="Meta.Variables.html#1842" class="Record">Variables</a> <a id="2883" href="Meta.Solver.html#2755" class="Bound">A</a> <a id="2885" class="Symbol">→</a> <a id="2887" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2892" class="Symbol">→</a> <a id="2894" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2897" class="Symbol">(</a><a id="2898" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2903" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="2905" href="Meta.Variables.html#1842" class="Record">Variables</a> <a id="2915" href="Meta.Solver.html#2755" class="Bound">A</a><a id="2916" class="Symbol">)</a>
    <a id="Variable-solver.strat"></a><a id="2922" href="Meta.Solver.html#2922" class="Field">strat</a>             <a id="2940" class="Symbol">:</a> <a id="2942" href="Meta.Solver.html#1114" class="Datatype">Reduction-strategy</a>
    <a id="Variable-solver.invoke-solver"></a><a id="2965" href="Meta.Solver.html#2965" class="Field">invoke-solver</a>     <a id="2983" class="Symbol">:</a> <a id="2985" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2990" class="Symbol">→</a> <a id="2992" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2997" class="Symbol">→</a> <a id="2999" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3004" class="Symbol">→</a> <a id="3006" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="Variable-solver.invoke-normaliser"></a><a id="3015" href="Meta.Solver.html#3015" class="Field">invoke-normaliser</a> <a id="3033" class="Symbol">:</a> <a id="3035" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3040" class="Symbol">→</a> <a id="3042" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3047" class="Symbol">→</a> <a id="3049" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>

  <a id="Variable-solver.prepare"></a><a id="3057" href="Meta.Solver.html#3057" class="Function">prepare</a> <a id="3065" class="Symbol">=</a> <a id="3067" href="Meta.Solver.html#1193" class="Function">prepare′</a> <a id="3076" href="Meta.Solver.html#2922" class="Field">strat</a>

<a id="3083" class="Keyword">module</a> <a id="3090" href="Meta.Solver.html#3090" class="Module">_</a> <a id="3092" class="Symbol">{</a><a id="3093" href="Meta.Solver.html#3093" class="Bound">ℓ</a><a id="3094" class="Symbol">}</a> <a id="3096" class="Symbol">{</a><a id="3097" href="Meta.Solver.html#3097" class="Bound">A</a> <a id="3099" class="Symbol">:</a> <a id="3101" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="3106" href="Meta.Solver.html#3093" class="Bound">ℓ</a><a id="3107" class="Symbol">}</a> <a id="3109" class="Symbol">(</a><a id="3110" href="Meta.Solver.html#3110" class="Bound">solver</a> <a id="3117" class="Symbol">:</a> <a id="3119" href="Meta.Solver.html#2734" class="Record">Variable-solver</a> <a id="3135" href="Meta.Solver.html#3097" class="Bound">A</a><a id="3136" class="Symbol">)</a> <a id="3138" class="Keyword">where</a>
  <a id="3146" class="Keyword">open</a> <a id="3151" href="Meta.Solver.html#2734" class="Module">Variable-solver</a> <a id="3167" href="Meta.Solver.html#3110" class="Bound">solver</a>

  <a id="3177" href="Meta.Solver.html#3177" class="Function">mk-var-solver</a> <a id="3191" class="Symbol">:</a> <a id="3193" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3198" class="Symbol">→</a> <a id="3200" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3203" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3207" href="Meta.Solver.html#3177" class="Function">mk-var-solver</a> <a id="3221" href="Meta.Solver.html#3221" class="Bound">hole</a> <a id="3226" class="Symbol">=</a>
    <a id="3232" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="3250" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3256" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a>
    <a id="3262" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="3277" class="Symbol">(</a><a id="3278" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3284" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3286" href="Meta.Solver.html#2819" class="Field">dont-reduce</a><a id="3297" class="Symbol">)</a> <a id="3299" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3301" class="Keyword">do</a>
    <a id="3308" href="Meta.Solver.html#3308" class="Bound">goal</a> <a id="3313" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3315" href="Agda.Builtin.Reflection.html#8878" class="Postulate">inferType</a> <a id="3325" href="Meta.Solver.html#3221" class="Bound">hole</a> <a id="3330" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3334" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a>
    <a id="3345" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3350" class="Symbol">(</a><a id="3351" href="Meta.Solver.html#3351" class="Bound">lhs</a> <a id="3355" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3357" href="Meta.Solver.html#3357" class="Bound">rhs</a><a id="3360" class="Symbol">)</a> <a id="3362" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3364" href="Meta.Reflection.html#7652" class="Function">get-boundary</a> <a id="3377" href="Meta.Solver.html#3308" class="Bound">goal</a>
      <a id="3388" class="Keyword">where</a> <a id="3394" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3402" class="Symbol">→</a> <a id="3404" href="Meta.Solver.html#998" class="Function">print-boundary</a> <a id="3419" href="Meta.Solver.html#3308" class="Bound">goal</a>
    <a id="3428" href="Meta.Solver.html#3428" class="Bound">elhs</a> <a id="3433" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3435" href="Meta.Solver.html#3435" class="Bound">vs</a> <a id="3438" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3440" href="Meta.Solver.html#3057" class="Function">prepare</a> <a id="3448" href="Meta.Solver.html#3351" class="Bound">lhs</a> <a id="3452" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3456" href="Meta.Solver.html#2853" class="Field">build-expr</a> <a id="3467" href="Meta.Variables.html#2153" class="Function">empty-vars</a>
    <a id="3482" href="Meta.Solver.html#3482" class="Bound">erhs</a> <a id="3487" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3489" href="Meta.Solver.html#3489" class="Bound">vs</a> <a id="3492" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3494" href="Meta.Solver.html#3057" class="Function">prepare</a> <a id="3502" href="Meta.Solver.html#3357" class="Bound">rhs</a> <a id="3506" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3510" href="Meta.Solver.html#2853" class="Field">build-expr</a> <a id="3521" href="Meta.Solver.html#3435" class="Bound">vs</a>
    <a id="3528" href="Meta.Solver.html#3528" class="Bound">size</a> <a id="3533" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3535" href="Meta.Solver.html#3535" class="Bound">env</a> <a id="3539" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3541" href="Meta.Variables.html#3407" class="Function">environment</a> <a id="3553" href="Meta.Solver.html#3489" class="Bound">vs</a>
    <a id="3560" class="Symbol">(</a><a id="3561" href="Agda.Builtin.Reflection.html#11202" class="Postulate">noConstraints</a> <a id="3575" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3577" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="3583" href="Meta.Solver.html#3221" class="Bound">hole</a> <a id="3588" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3590" href="Meta.Solver.html#2965" class="Field">invoke-solver</a> <a id="3604" href="Meta.Solver.html#3428" class="Bound">elhs</a> <a id="3609" href="Meta.Solver.html#3482" class="Bound">erhs</a> <a id="3614" href="Meta.Solver.html#3535" class="Bound">env</a><a id="3617" class="Symbol">)</a> <a id="3619" href="Meta.Alt.html#315" class="Field Operator">&lt;|&gt;</a>
      <a id="3629" href="Meta.Solver.html#436" class="Function">solver-failed</a> <a id="3643" href="Meta.Solver.html#3428" class="Bound">elhs</a> <a id="3648" href="Meta.Solver.html#3482" class="Bound">erhs</a>

  <a id="3656" href="Meta.Solver.html#3656" class="Function">mk-var-normalise</a> <a id="3673" class="Symbol">:</a> <a id="3675" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3680" class="Symbol">→</a> <a id="3682" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3687" class="Symbol">→</a> <a id="3689" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3692" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3696" href="Meta.Solver.html#3656" class="Function">mk-var-normalise</a> <a id="3713" href="Meta.Solver.html#3713" class="Bound">tm</a> <a id="3716" href="Meta.Solver.html#3716" class="Bound">hole</a> <a id="3721" class="Symbol">=</a>
    <a id="3727" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="3745" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3751" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a>
    <a id="3757" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="3772" class="Symbol">(</a><a id="3773" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3779" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3781" href="Meta.Solver.html#2819" class="Field">dont-reduce</a><a id="3792" class="Symbol">)</a> <a id="3794" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3796" class="Keyword">do</a>
    <a id="3803" href="Meta.Solver.html#3803" class="Bound">e</a> <a id="3805" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3807" href="Meta.Solver.html#3807" class="Bound">vs</a> <a id="3810" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3812" href="Meta.Solver.html#3057" class="Function">prepare</a> <a id="3820" href="Meta.Solver.html#3713" class="Bound">tm</a> <a id="3823" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3827" href="Meta.Solver.html#2853" class="Field">build-expr</a> <a id="3838" href="Meta.Variables.html#2153" class="Function">empty-vars</a>
    <a id="3853" href="Meta.Solver.html#3853" class="Bound">size</a> <a id="3858" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3860" href="Meta.Solver.html#3860" class="Bound">env</a> <a id="3864" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3866" href="Meta.Variables.html#3407" class="Function">environment</a> <a id="3878" href="Meta.Solver.html#3807" class="Bound">vs</a>
    <a id="3885" href="Meta.Solver.html#3885" class="Bound">soln</a> <a id="3890" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3892" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a> <a id="3899" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="3901" href="Meta.Solver.html#3015" class="Field">invoke-normaliser</a> <a id="3919" href="Meta.Solver.html#3803" class="Bound">e</a> <a id="3921" href="Meta.Solver.html#3860" class="Bound">env</a>
    <a id="3929" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="3935" href="Meta.Solver.html#3716" class="Bound">hole</a> <a id="3940" href="Meta.Solver.html#3885" class="Bound">soln</a>

  <a id="3948" href="Meta.Solver.html#3948" class="Function">mk-var-repr</a> <a id="3960" class="Symbol">:</a> <a id="3962" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3967" class="Symbol">→</a> <a id="3969" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3972" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3976" href="Meta.Solver.html#3948" class="Function">mk-var-repr</a> <a id="3988" href="Meta.Solver.html#3988" class="Bound">tm</a> <a id="3991" class="Symbol">=</a>
    <a id="3997" href="Agda.Builtin.Reflection.html#10125" class="Postulate">withNormalisation</a> <a id="4015" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4021" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a>
    <a id="4027" href="Agda.Builtin.Reflection.html#10769" class="Postulate">withReduceDefs</a> <a id="4042" class="Symbol">(</a><a id="4043" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4049" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4051" href="Meta.Solver.html#2819" class="Field">dont-reduce</a><a id="4062" class="Symbol">)</a> <a id="4064" href="Foundations.Pi.Base.html#1019" class="Function Operator">$</a> <a id="4066" class="Keyword">do</a>
    <a id="4073" href="Meta.Solver.html#4073" class="Bound">repr</a> <a id="4078" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4080" href="Meta.Solver.html#4080" class="Bound">vs</a> <a id="4083" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4085" href="Meta.Solver.html#3057" class="Function">prepare</a> <a id="4093" href="Meta.Solver.html#3988" class="Bound">tm</a> <a id="4096" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="4100" href="Meta.Solver.html#2853" class="Field">build-expr</a> <a id="4111" href="Meta.Variables.html#2153" class="Function">empty-vars</a>
    <a id="4126" href="Meta.Solver.html#4126" class="Bound">size</a> <a id="4131" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4133" href="Meta.Solver.html#4133" class="Bound">env</a> <a id="4137" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4139" href="Meta.Variables.html#3407" class="Function">environment</a> <a id="4151" href="Meta.Solver.html#4080" class="Bound">vs</a>
    <a id="4158" href="Meta.Solver.html#770" class="Function">print-var-repr</a> <a id="4173" href="Meta.Solver.html#3988" class="Bound">tm</a> <a id="4176" href="Meta.Solver.html#4073" class="Bound">repr</a> <a id="4181" href="Meta.Solver.html#4133" class="Bound">env</a>
</pre></body></html>