<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Solver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Solver.html" class="Module">Meta.Solver</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Meta.Variables.html" class="Module">Meta.Variables</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Meta.Reflection.html" class="Module">Meta.Reflection</a>

<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Data.String.Instances.IsString.html" class="Module">Data.String.Instances.IsString</a>

<a id="262" class="Keyword">private</a> <a id="270" class="Keyword">variable</a>
  <a id="281" href="Meta.Solver.html#281" class="Generalizable">ℓ</a> <a id="283" class="Symbol">:</a> <a id="285" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="293" href="Meta.Solver.html#293" class="Generalizable">A</a> <a id="295" class="Symbol">:</a> <a id="297" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="302" href="Meta.Solver.html#281" class="Generalizable">ℓ</a>

<a id="305" class="Comment">--------------------------------------------------------------------------------</a>
<a id="386" class="Comment">-- Helpers</a>

<a id="solver-failed"></a><a id="398" href="Meta.Solver.html#398" class="Function">solver-failed</a> <a id="412" class="Symbol">:</a> <a id="414" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="419" class="Symbol">→</a> <a id="421" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="426" class="Symbol">→</a> <a id="428" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="431" href="Meta.Solver.html#293" class="Generalizable">A</a>
<a id="433" href="Meta.Solver.html#398" class="Function">solver-failed</a> <a id="447" href="Meta.Solver.html#447" class="Bound">lhs</a> <a id="451" href="Meta.Solver.html#451" class="Bound">rhs</a> <a id="455" class="Symbol">=</a>
    <a id="461" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="471" class="Symbol">(</a><a id="472" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="479" class="String">&quot;Could not equate the following expressions:\n  &quot;</a> <a id="529" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="548" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="556" href="Meta.Solver.html#447" class="Bound">lhs</a> <a id="560" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
               <a id="577" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="584" class="String">&quot;\nAnd\n  &quot;</a> <a id="596" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="615" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="623" href="Meta.Solver.html#451" class="Bound">rhs</a> <a id="627" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="629" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="631" class="Symbol">)</a>

<a id="print-repr"></a><a id="634" href="Meta.Solver.html#634" class="Function">print-repr</a> <a id="645" class="Symbol">:</a> <a id="647" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="652" class="Symbol">→</a> <a id="654" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="659" class="Symbol">→</a> <a id="661" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="664" href="Meta.Solver.html#293" class="Generalizable">A</a>
<a id="666" href="Meta.Solver.html#634" class="Function">print-repr</a> <a id="677" href="Meta.Solver.html#677" class="Bound">tm</a> <a id="680" href="Meta.Solver.html#680" class="Bound">repr</a> <a id="685" class="Symbol">=</a>
  <a id="689" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="699" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="701" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="708" class="String">&quot;The expression\n  &quot;</a> <a id="729" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="747" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="755" href="Meta.Solver.html#677" class="Bound">tm</a> <a id="758" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
              <a id="774" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="781" class="String">&quot;\nIs represented by the expression\n  &quot;</a> <a id="822" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="840" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="848" href="Meta.Solver.html#680" class="Bound">repr</a> <a id="853" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="855" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="print-var-repr"></a><a id="859" href="Meta.Solver.html#859" class="Function">print-var-repr</a> <a id="874" class="Symbol">:</a> <a id="876" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="881" class="Symbol">→</a> <a id="883" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="888" class="Symbol">→</a> <a id="890" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="895" class="Symbol">→</a> <a id="897" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="900" href="Meta.Solver.html#293" class="Generalizable">A</a>
<a id="902" href="Meta.Solver.html#859" class="Function">print-var-repr</a> <a id="917" href="Meta.Solver.html#917" class="Bound">tm</a> <a id="920" href="Meta.Solver.html#920" class="Bound">repr</a> <a id="925" href="Meta.Solver.html#925" class="Bound">env</a> <a id="929" class="Symbol">=</a>
  <a id="933" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="943" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="945" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="952" class="String">&quot;The expression\n  &quot;</a> <a id="973" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="991" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="999" href="Meta.Solver.html#917" class="Bound">tm</a> <a id="1002" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
              <a id="1018" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="1025" class="String">&quot;\nIs represented by the expression\n  &quot;</a> <a id="1066" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="1084" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1092" href="Meta.Solver.html#920" class="Bound">repr</a> <a id="1097" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
              <a id="1113" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="1120" class="String">&quot;\nIn the environment\n  &quot;</a> <a id="1147" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="1165" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1173" href="Meta.Solver.html#925" class="Bound">env</a> <a id="1177" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1179" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="1183" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1264" class="Comment">-- Simple Solvers</a>

<a id="1283" class="Keyword">record</a> <a id="SimpleSolver"></a><a id="1290" href="Meta.Solver.html#1290" class="Record">SimpleSolver</a> <a id="1303" class="Symbol">:</a> <a id="1305" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1310" class="Keyword">where</a>
  <a id="1318" class="Keyword">constructor</a> <a id="simple-solver"></a><a id="1330" href="Meta.Solver.html#1330" class="InductiveConstructor">simple-solver</a>
  <a id="1346" class="Keyword">field</a>
    <a id="SimpleSolver.dont-reduce"></a><a id="1356" href="Meta.Solver.html#1356" class="Field">dont-reduce</a> <a id="1368" class="Symbol">:</a> <a id="1370" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1375" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="SimpleSolver.build-expr"></a><a id="1384" href="Meta.Solver.html#1384" class="Field">build-expr</a> <a id="1395" class="Symbol">:</a> <a id="1397" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="1407" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>
    <a id="SimpleSolver.invoke-solver"></a><a id="1416" href="Meta.Solver.html#1416" class="Field">invoke-solver</a> <a id="1430" class="Symbol">:</a> <a id="1432" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1437" class="Symbol">→</a> <a id="1439" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1444" class="Symbol">→</a> <a id="1446" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>
    <a id="SimpleSolver.invoke-normaliser"></a><a id="1455" href="Meta.Solver.html#1455" class="Field">invoke-normaliser</a> <a id="1473" class="Symbol">:</a> <a id="1475" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1480" class="Symbol">→</a> <a id="1482" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>

<a id="1488" class="Keyword">module</a> <a id="1495" href="Meta.Solver.html#1495" class="Module">_</a> <a id="1497" class="Symbol">(</a><a id="1498" href="Meta.Solver.html#1498" class="Bound">solver</a> <a id="1505" class="Symbol">:</a> <a id="1507" href="Meta.Solver.html#1290" class="Record">SimpleSolver</a><a id="1519" class="Symbol">)</a> <a id="1521" class="Keyword">where</a>
  <a id="1529" class="Keyword">open</a> <a id="1534" href="Meta.Solver.html#1290" class="Module">SimpleSolver</a> <a id="1547" href="Meta.Solver.html#1498" class="Bound">solver</a>

  <a id="1557" href="Meta.Solver.html#1557" class="Function">mk-simple-solver</a> <a id="1574" class="Symbol">:</a> <a id="1576" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1581" class="Symbol">→</a> <a id="1583" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="1586" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1590" href="Meta.Solver.html#1557" class="Function">mk-simple-solver</a> <a id="1607" href="Meta.Solver.html#1607" class="Bound">hole</a> <a id="1612" class="Symbol">=</a>
    <a id="1618" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="1636" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1642" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="1648" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="1663" class="Symbol">(</a><a id="1664" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1670" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1672" href="Meta.Solver.html#1356" class="Field">dont-reduce</a><a id="1683" class="Symbol">)</a> <a id="1685" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="1687" class="Keyword">do</a>
    <a id="1694" href="Meta.Solver.html#1694" class="Bound">goal</a> <a id="1699" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1701" href="Agda.Builtin.Reflection.html#8572" class="Postulate">inferType</a> <a id="1711" href="Meta.Solver.html#1607" class="Bound">hole</a> <a id="1716" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1720" href="Agda.Builtin.Reflection.html#8687" class="Postulate">reduce</a>
    <a id="1731" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1736" class="Symbol">(</a><a id="1737" href="Meta.Solver.html#1737" class="Bound">lhs</a> <a id="1741" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1743" href="Meta.Solver.html#1743" class="Bound">rhs</a><a id="1746" class="Symbol">)</a> <a id="1748" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1750" href="Meta.Reflection.html#6636" class="Function">get-boundary</a> <a id="1763" href="Meta.Solver.html#1694" class="Bound">goal</a>
      <a id="1774" class="Keyword">where</a> <a id="1780" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1788" class="Symbol">→</a> <a id="1790" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="1800" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="1802" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="1809" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="1838" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                                  <a id="1874" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1882" href="Meta.Solver.html#1694" class="Bound">goal</a> <a id="1887" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1889" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1896" href="Meta.Solver.html#1896" class="Bound">elhs</a> <a id="1901" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1903" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="1913" href="Meta.Solver.html#1737" class="Bound">lhs</a> <a id="1917" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1921" href="Meta.Solver.html#1384" class="Field">build-expr</a>
    <a id="1936" href="Meta.Solver.html#1936" class="Bound">erhs</a> <a id="1941" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1943" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="1953" href="Meta.Solver.html#1743" class="Bound">rhs</a> <a id="1957" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1961" href="Meta.Solver.html#1384" class="Field">build-expr</a>
    <a id="1976" class="Symbol">(</a><a id="1977" href="Agda.Builtin.Reflection.html#10893" class="Postulate">noConstraints</a> <a id="1991" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="1993" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="1999" href="Meta.Solver.html#1607" class="Bound">hole</a> <a id="2004" class="Symbol">(</a><a id="2005" href="Meta.Solver.html#1416" class="Field">invoke-solver</a> <a id="2019" href="Meta.Solver.html#1896" class="Bound">elhs</a> <a id="2024" href="Meta.Solver.html#1936" class="Bound">erhs</a><a id="2028" class="Symbol">))</a> <a id="2031" href="Meta.Alt.html#315" class="Field Operator">&lt;|&gt;</a> <a id="2035" href="Meta.Solver.html#398" class="Function">solver-failed</a> <a id="2049" href="Meta.Solver.html#1896" class="Bound">elhs</a> <a id="2054" href="Meta.Solver.html#1936" class="Bound">erhs</a>

  <a id="2062" href="Meta.Solver.html#2062" class="Function">mk-simple-normalise</a> <a id="2082" class="Symbol">:</a> <a id="2084" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2089" class="Symbol">→</a> <a id="2091" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2096" class="Symbol">→</a> <a id="2098" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2101" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2105" href="Meta.Solver.html#2062" class="Function">mk-simple-normalise</a> <a id="2125" href="Meta.Solver.html#2125" class="Bound">tm</a> <a id="2128" href="Meta.Solver.html#2128" class="Bound">hole</a> <a id="2133" class="Symbol">=</a>
    <a id="2139" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="2157" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2163" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="2169" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="2184" class="Symbol">(</a><a id="2185" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2191" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2193" href="Meta.Solver.html#1356" class="Field">dont-reduce</a><a id="2204" class="Symbol">)</a> <a id="2206" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="2208" class="Keyword">do</a>
    <a id="2215" href="Meta.Solver.html#2215" class="Bound">e</a> <a id="2217" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2219" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="2229" href="Meta.Solver.html#2125" class="Bound">tm</a> <a id="2232" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2236" href="Meta.Solver.html#1384" class="Field">build-expr</a>
    <a id="2251" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="2257" href="Meta.Solver.html#2128" class="Bound">hole</a> <a id="2262" class="Symbol">(</a><a id="2263" href="Meta.Solver.html#1455" class="Field">invoke-normaliser</a> <a id="2281" href="Meta.Solver.html#2215" class="Bound">e</a><a id="2282" class="Symbol">)</a>

  <a id="2287" href="Meta.Solver.html#2287" class="Function">mk-simple-repr</a> <a id="2302" class="Symbol">:</a> <a id="2304" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2309" class="Symbol">→</a> <a id="2311" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2314" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2318" href="Meta.Solver.html#2287" class="Function">mk-simple-repr</a> <a id="2333" href="Meta.Solver.html#2333" class="Bound">tm</a> <a id="2336" class="Symbol">=</a>
    <a id="2342" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="2360" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2366" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="2372" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="2387" class="Symbol">(</a><a id="2388" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2394" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2396" href="Meta.Solver.html#1356" class="Field">dont-reduce</a><a id="2407" class="Symbol">)</a> <a id="2409" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="2411" class="Keyword">do</a>
    <a id="2418" href="Meta.Solver.html#2418" class="Bound">repr</a> <a id="2423" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2425" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="2435" href="Meta.Solver.html#2333" class="Bound">tm</a> <a id="2438" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2442" href="Meta.Solver.html#1384" class="Field">build-expr</a>
    <a id="2457" href="Meta.Solver.html#634" class="Function">print-repr</a> <a id="2468" href="Meta.Solver.html#2333" class="Bound">tm</a> <a id="2471" href="Meta.Solver.html#2418" class="Bound">repr</a>

<a id="2477" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2558" class="Comment">-- Solvers with Variables</a>

<a id="2585" class="Keyword">record</a> <a id="VariableSolver"></a><a id="2592" href="Meta.Solver.html#2592" class="Record">VariableSolver</a> <a id="2607" class="Symbol">{</a><a id="2608" href="Meta.Solver.html#2608" class="Bound">ℓ</a><a id="2609" class="Symbol">}</a> <a id="2611" class="Symbol">(</a><a id="2612" href="Meta.Solver.html#2612" class="Bound">A</a> <a id="2614" class="Symbol">:</a> <a id="2616" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2621" href="Meta.Solver.html#2608" class="Bound">ℓ</a><a id="2622" class="Symbol">)</a> <a id="2624" class="Symbol">:</a> <a id="2626" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2631" href="Meta.Solver.html#2608" class="Bound">ℓ</a> <a id="2633" class="Keyword">where</a>
  <a id="2641" class="Keyword">constructor</a> <a id="var-solver"></a><a id="2653" href="Meta.Solver.html#2653" class="InductiveConstructor">var-solver</a>
  <a id="2666" class="Keyword">field</a>
    <a id="VariableSolver.dont-reduce"></a><a id="2676" href="Meta.Solver.html#2676" class="Field">dont-reduce</a> <a id="2688" class="Symbol">:</a> <a id="2690" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2695" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="VariableSolver.build-expr"></a><a id="2704" href="Meta.Solver.html#2704" class="Field">build-expr</a> <a id="2715" class="Symbol">:</a> <a id="2717" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="2727" href="Meta.Solver.html#2612" class="Bound">A</a> <a id="2729" class="Symbol">→</a> <a id="2731" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2736" class="Symbol">→</a> <a id="2738" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2741" class="Symbol">(</a><a id="2742" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2747" href="Foundations.Sigma.Base.html#498" class="Function Operator">×</a> <a id="2749" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="2759" href="Meta.Solver.html#2612" class="Bound">A</a><a id="2760" class="Symbol">)</a>
    <a id="VariableSolver.invoke-solver"></a><a id="2766" href="Meta.Solver.html#2766" class="Field">invoke-solver</a> <a id="2780" class="Symbol">:</a> <a id="2782" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2787" class="Symbol">→</a> <a id="2789" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2794" class="Symbol">→</a> <a id="2796" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2801" class="Symbol">→</a> <a id="2803" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>
    <a id="VariableSolver.invoke-normaliser"></a><a id="2812" href="Meta.Solver.html#2812" class="Field">invoke-normaliser</a> <a id="2830" class="Symbol">:</a> <a id="2832" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2837" class="Symbol">→</a> <a id="2839" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2844" class="Symbol">→</a> <a id="2846" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>

<a id="2852" class="Keyword">module</a> <a id="2859" href="Meta.Solver.html#2859" class="Module">_</a> <a id="2861" class="Symbol">{</a><a id="2862" href="Meta.Solver.html#2862" class="Bound">ℓ</a><a id="2863" class="Symbol">}</a> <a id="2865" class="Symbol">{</a><a id="2866" href="Meta.Solver.html#2866" class="Bound">A</a> <a id="2868" class="Symbol">:</a> <a id="2870" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2875" href="Meta.Solver.html#2862" class="Bound">ℓ</a><a id="2876" class="Symbol">}</a> <a id="2878" class="Symbol">(</a><a id="2879" href="Meta.Solver.html#2879" class="Bound">solver</a> <a id="2886" class="Symbol">:</a> <a id="2888" href="Meta.Solver.html#2592" class="Record">VariableSolver</a> <a id="2903" href="Meta.Solver.html#2866" class="Bound">A</a><a id="2904" class="Symbol">)</a> <a id="2906" class="Keyword">where</a>
  <a id="2914" class="Keyword">open</a> <a id="2919" href="Meta.Solver.html#2592" class="Module">VariableSolver</a> <a id="2934" href="Meta.Solver.html#2879" class="Bound">solver</a>

  <a id="2944" href="Meta.Solver.html#2944" class="Function">mk-var-solver</a> <a id="2958" class="Symbol">:</a> <a id="2960" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2965" class="Symbol">→</a> <a id="2967" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2970" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2974" href="Meta.Solver.html#2944" class="Function">mk-var-solver</a> <a id="2988" href="Meta.Solver.html#2988" class="Bound">hole</a> <a id="2993" class="Symbol">=</a>
    <a id="2999" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="3017" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3023" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="3029" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="3044" class="Symbol">(</a><a id="3045" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3051" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3053" href="Meta.Solver.html#2676" class="Field">dont-reduce</a><a id="3064" class="Symbol">)</a> <a id="3066" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3068" class="Keyword">do</a>
    <a id="3075" href="Meta.Solver.html#3075" class="Bound">goal</a> <a id="3080" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3082" href="Agda.Builtin.Reflection.html#8572" class="Postulate">inferType</a> <a id="3092" href="Meta.Solver.html#2988" class="Bound">hole</a> <a id="3097" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3101" href="Agda.Builtin.Reflection.html#8687" class="Postulate">reduce</a>
    <a id="3112" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3117" class="Symbol">(</a><a id="3118" href="Meta.Solver.html#3118" class="Bound">lhs</a> <a id="3122" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3124" href="Meta.Solver.html#3124" class="Bound">rhs</a><a id="3127" class="Symbol">)</a> <a id="3129" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3131" href="Meta.Reflection.html#6636" class="Function">get-boundary</a> <a id="3144" href="Meta.Solver.html#3075" class="Bound">goal</a>
      <a id="3155" class="Keyword">where</a> <a id="3161" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3169" class="Symbol">→</a> <a id="3171" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="3181" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3183" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="3190" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="3219" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                                  <a id="3255" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="3263" href="Meta.Solver.html#3075" class="Bound">goal</a> <a id="3268" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3270" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="3277" href="Meta.Solver.html#3277" class="Bound">elhs</a> <a id="3282" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3284" href="Meta.Solver.html#3284" class="Bound">vs</a> <a id="3287" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3289" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="3299" href="Meta.Solver.html#3118" class="Bound">lhs</a> <a id="3303" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3307" href="Meta.Solver.html#2704" class="Field">build-expr</a> <a id="3318" href="Meta.Variables.html#2150" class="Function">empty-vars</a>
    <a id="3333" href="Meta.Solver.html#3333" class="Bound">erhs</a> <a id="3338" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3340" href="Meta.Solver.html#3340" class="Bound">vs</a> <a id="3343" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3345" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="3355" href="Meta.Solver.html#3124" class="Bound">rhs</a> <a id="3359" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3363" href="Meta.Solver.html#2704" class="Field">build-expr</a> <a id="3374" href="Meta.Solver.html#3284" class="Bound">vs</a>
    <a id="3381" href="Meta.Solver.html#3381" class="Bound">size</a> <a id="3386" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3388" href="Meta.Solver.html#3388" class="Bound">env</a> <a id="3392" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3394" href="Meta.Variables.html#3414" class="Function">environment</a> <a id="3406" href="Meta.Solver.html#3340" class="Bound">vs</a>
    <a id="3413" class="Symbol">(</a><a id="3414" href="Agda.Builtin.Reflection.html#10893" class="Postulate">noConstraints</a> <a id="3428" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3430" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="3436" href="Meta.Solver.html#2988" class="Bound">hole</a> <a id="3441" class="Symbol">(</a><a id="3442" href="Meta.Solver.html#2766" class="Field">invoke-solver</a> <a id="3456" href="Meta.Solver.html#3277" class="Bound">elhs</a> <a id="3461" href="Meta.Solver.html#3333" class="Bound">erhs</a> <a id="3466" href="Meta.Solver.html#3388" class="Bound">env</a><a id="3469" class="Symbol">))</a> <a id="3472" href="Meta.Alt.html#315" class="Field Operator">&lt;|&gt;</a>
      <a id="3482" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="3492" class="Symbol">(</a><a id="3493" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="3500" class="String">&quot;Could not equate the following expressions:\n  &quot;</a> <a id="3550" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                   <a id="3571" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="3579" href="Meta.Solver.html#3277" class="Bound">elhs</a> <a id="3584" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="3603" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="3610" class="String">&quot;\nAnd\n  &quot;</a> <a id="3622" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                   <a id="3643" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="3651" href="Meta.Solver.html#3333" class="Bound">erhs</a> <a id="3656" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3658" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3660" class="Symbol">)</a>

  <a id="3665" href="Meta.Solver.html#3665" class="Function">mk-var-normalise</a> <a id="3682" class="Symbol">:</a> <a id="3684" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="3689" class="Symbol">→</a> <a id="3691" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="3696" class="Symbol">→</a> <a id="3698" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="3701" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3705" href="Meta.Solver.html#3665" class="Function">mk-var-normalise</a> <a id="3722" href="Meta.Solver.html#3722" class="Bound">tm</a> <a id="3725" href="Meta.Solver.html#3725" class="Bound">hole</a> <a id="3730" class="Symbol">=</a>
    <a id="3736" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="3754" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3760" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="3766" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="3781" class="Symbol">(</a><a id="3782" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3788" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3790" href="Meta.Solver.html#2676" class="Field">dont-reduce</a><a id="3801" class="Symbol">)</a> <a id="3803" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3805" class="Keyword">do</a>
    <a id="3812" href="Meta.Solver.html#3812" class="Bound">e</a> <a id="3814" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3816" href="Meta.Solver.html#3816" class="Bound">vs</a> <a id="3819" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3821" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="3831" href="Meta.Solver.html#3722" class="Bound">tm</a> <a id="3834" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3838" href="Meta.Solver.html#2704" class="Field">build-expr</a> <a id="3849" href="Meta.Variables.html#2150" class="Function">empty-vars</a>
    <a id="3864" href="Meta.Solver.html#3864" class="Bound">size</a> <a id="3869" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3871" href="Meta.Solver.html#3871" class="Bound">env</a> <a id="3875" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3877" href="Meta.Variables.html#3414" class="Function">environment</a> <a id="3889" href="Meta.Solver.html#3816" class="Bound">vs</a>
    <a id="3896" href="Meta.Solver.html#3896" class="Bound">soln</a> <a id="3901" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3903" href="Agda.Builtin.Reflection.html#8687" class="Postulate">reduce</a> <a id="3910" class="Symbol">(</a><a id="3911" href="Meta.Solver.html#2812" class="Field">invoke-normaliser</a> <a id="3929" href="Meta.Solver.html#3812" class="Bound">e</a> <a id="3931" href="Meta.Solver.html#3871" class="Bound">env</a><a id="3934" class="Symbol">)</a>
    <a id="3940" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="3946" href="Meta.Solver.html#3725" class="Bound">hole</a> <a id="3951" href="Meta.Solver.html#3896" class="Bound">soln</a>

  <a id="3959" href="Meta.Solver.html#3959" class="Function">mk-var-repr</a> <a id="3971" class="Symbol">:</a> <a id="3973" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="3978" class="Symbol">→</a> <a id="3980" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="3983" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3987" href="Meta.Solver.html#3959" class="Function">mk-var-repr</a> <a id="3999" href="Meta.Solver.html#3999" class="Bound">tm</a> <a id="4002" class="Symbol">=</a>
    <a id="4008" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="4026" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4032" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="4038" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="4053" class="Symbol">(</a><a id="4054" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4060" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4062" href="Meta.Solver.html#2676" class="Field">dont-reduce</a><a id="4073" class="Symbol">)</a> <a id="4075" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="4077" class="Keyword">do</a>
    <a id="4084" href="Meta.Solver.html#4084" class="Bound">repr</a> <a id="4089" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4091" href="Meta.Solver.html#4091" class="Bound">vs</a> <a id="4094" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4096" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="4106" href="Meta.Solver.html#3999" class="Bound">tm</a> <a id="4109" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="4113" href="Meta.Solver.html#2704" class="Field">build-expr</a> <a id="4124" href="Meta.Variables.html#2150" class="Function">empty-vars</a>
    <a id="4139" href="Meta.Solver.html#4139" class="Bound">size</a> <a id="4144" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4146" href="Meta.Solver.html#4146" class="Bound">env</a> <a id="4150" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4152" href="Meta.Variables.html#3414" class="Function">environment</a> <a id="4164" href="Meta.Solver.html#4091" class="Bound">vs</a>
    <a id="4171" href="Meta.Solver.html#859" class="Function">print-var-repr</a> <a id="4186" href="Meta.Solver.html#3999" class="Bound">tm</a> <a id="4189" href="Meta.Solver.html#4084" class="Bound">repr</a> <a id="4194" href="Meta.Solver.html#4146" class="Bound">env</a>
</pre></body></html>