<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Variables</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Variables.html" class="Module">Meta.Variables</a> <a id="46" class="Keyword">where</a>

<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Meta.Reflection.html" class="Module">Meta.Reflection</a>

<a id="112" class="Keyword">open</a> <a id="117" class="Keyword">import</a> <a id="124" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a>
<a id="165" class="Keyword">open</a> <a id="170" class="Keyword">import</a> <a id="177" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>
<a id="220" class="Keyword">open</a> <a id="225" class="Keyword">import</a> <a id="232" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a>

<a id="273" class="Comment">--------------------------------------------------------------------------------</a>
<a id="354" class="Comment">-- Variable Binding for Terms</a>
<a id="384" class="Comment">--</a>
<a id="387" class="Comment">-- Many reflection tasks will require us to construct abstract</a>
<a id="450" class="Comment">-- syntax trees representing reified expressions, which we will</a>
<a id="514" class="Comment">-- use to construct a normal form. This works fine up until we</a>
<a id="577" class="Comment">-- need to start finding normal forms for equational theories</a>
<a id="639" class="Comment">-- with some sort of commutativity. For instance, which expression</a>
<a id="706" class="Comment">-- should we prefer: &#39;x + y&#39; or &#39;y + x&#39;?</a>
<a id="747" class="Comment">--</a>
<a id="750" class="Comment">-- The first solution we may try here is to impose some ordering on</a>
<a id="818" class="Comment">-- `Term`, and then sort our lists. However, trying to define this</a>
<a id="885" class="Comment">-- ordering is complex, and it&#39;s not even clear if we /can/ impose</a>
<a id="952" class="Comment">-- a meaningful ordering.</a>
<a id="978" class="Comment">--</a>
<a id="981" class="Comment">-- The next solution is to try and order the variables by the</a>
<a id="1043" class="Comment">-- time they are /introduced/, which is what this module aims to do.</a>
<a id="1112" class="Comment">-- We introduce a type &#39;Variables&#39;, which is intended to be an abstract</a>
<a id="1184" class="Comment">-- source of variable expressions. This allows us to produce fresh</a>
<a id="1251" class="Comment">-- (already quoted) variables of type &#39;Fin&#39;, which can be inserted</a>
<a id="1318" class="Comment">-- into the syntax tree while it&#39;s being constructed.</a>
<a id="1372" class="Comment">--</a>
<a id="1375" class="Comment">-- Once the syntax trees have been completed, we can grab an</a>
<a id="1436" class="Comment">-- environment using the aptly named &#39;environment&#39; function.</a>
<a id="1497" class="Comment">-- This returns a (already quoted) environment &#39;Vec A n&#39;,</a>
<a id="1555" class="Comment">-- which allows us to easily build up quoted</a>
<a id="1600" class="Comment">-- calls to our normalization functions rather easily.</a>

<a id="1656" class="Comment">-- We üõê the wisdom that reversing a list/vector is a type</a>
<a id="1714" class="Comment">-- error!</a>
<a id="1724" class="Keyword">data</a> <a id="Env"></a><a id="1729" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="1733" class="Symbol">{</a><a id="1734" href="Meta.Variables.html#1734" class="Bound">‚Ñì</a><a id="1735" class="Symbol">}</a> <a id="1737" class="Symbol">(</a><a id="1738" href="Meta.Variables.html#1738" class="Bound">A</a> <a id="1740" class="Symbol">:</a> <a id="1742" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1747" href="Meta.Variables.html#1734" class="Bound">‚Ñì</a><a id="1748" class="Symbol">)</a> <a id="1750" class="Symbol">:</a> <a id="1752" href="Agda.Builtin.Nat.html#203" class="Datatype">‚Ñï</a> <a id="1754" class="Symbol">‚Üí</a> <a id="1756" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1761" href="Meta.Variables.html#1734" class="Bound">‚Ñì</a> <a id="1763" class="Keyword">where</a>
  <a id="Env.[]"></a><a id="1771" href="Meta.Variables.html#1771" class="InductiveConstructor">[]</a> <a id="1774" class="Symbol">:</a> <a id="1776" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="1780" href="Meta.Variables.html#1738" class="Bound">A</a> <a id="1782" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>
  <a id="Env._‚ñ∑_"></a><a id="1789" href="Meta.Variables.html#1789" class="InductiveConstructor Operator">_‚ñ∑_</a> <a id="1793" class="Symbol">:</a> <a id="1795" class="Symbol">‚àÄ</a> <a id="1797" class="Symbol">{</a><a id="1798" href="Meta.Variables.html#1798" class="Bound">n</a><a id="1799" class="Symbol">}</a> <a id="1801" class="Symbol">‚Üí</a> <a id="1803" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="1807" href="Meta.Variables.html#1738" class="Bound">A</a> <a id="1809" href="Meta.Variables.html#1798" class="Bound">n</a> <a id="1811" class="Symbol">‚Üí</a> <a id="1813" href="Meta.Variables.html#1738" class="Bound">A</a> <a id="1815" class="Symbol">‚Üí</a> <a id="1817" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="1821" href="Meta.Variables.html#1738" class="Bound">A</a> <a id="1823" class="Symbol">(</a><a id="1824" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1828" href="Meta.Variables.html#1798" class="Bound">n</a><a id="1829" class="Symbol">)</a>

<a id="1832" class="Keyword">record</a> <a id="Variables"></a><a id="1839" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="1849" class="Symbol">{</a><a id="1850" href="Meta.Variables.html#1850" class="Bound">a</a><a id="1851" class="Symbol">}</a> <a id="1853" class="Symbol">(</a><a id="1854" href="Meta.Variables.html#1854" class="Bound">A</a> <a id="1856" class="Symbol">:</a> <a id="1858" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1863" href="Meta.Variables.html#1850" class="Bound">a</a><a id="1864" class="Symbol">)</a> <a id="1866" class="Symbol">:</a> <a id="1868" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1873" href="Meta.Variables.html#1850" class="Bound">a</a> <a id="1875" class="Keyword">where</a>
  <a id="1883" class="Keyword">constructor</a> <a id="mk-variables"></a><a id="1895" href="Meta.Variables.html#1895" class="InductiveConstructor">mk-variables</a>
  <a id="1910" class="Keyword">field</a>
    <a id="1920" class="Symbol">{</a><a id="Variables.nvars"></a><a id="1921" href="Meta.Variables.html#1921" class="Field">nvars</a><a id="1926" class="Symbol">}</a> <a id="1928" class="Symbol">:</a> <a id="1930" href="Agda.Builtin.Nat.html#203" class="Datatype">‚Ñï</a>
    <a id="1936" class="Comment">-- We store the bindings in reverse order so that it&#39;s</a>
    <a id="1995" class="Comment">-- cheap to add a new one.</a>
    <a id="Variables.bound"></a><a id="2026" href="Meta.Variables.html#2026" class="Field">bound</a> <a id="2032" class="Symbol">:</a> <a id="2034" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="2038" href="Meta.Variables.html#1854" class="Bound">A</a> <a id="2040" href="Meta.Variables.html#1921" class="Field">nvars</a>
    <a id="Variables.variables"></a><a id="2050" href="Meta.Variables.html#2050" class="Field">variables</a> <a id="2060" class="Symbol">:</a> <a id="2062" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2067" class="Symbol">‚Üí</a> <a id="2069" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2075" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>

<a id="2081" class="Keyword">open</a> <a id="2086" href="Meta.Variables.html#1839" class="Module">Variables</a>

<a id="2097" class="Keyword">private</a> <a id="2105" class="Keyword">variable</a>
  <a id="2116" href="Meta.Variables.html#2116" class="Generalizable">a</a> <a id="2118" href="Meta.Variables.html#2118" class="Generalizable">b</a> <a id="2120" class="Symbol">:</a> <a id="2122" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="2130" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="2132" class="Symbol">:</a> <a id="2134" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2139" href="Meta.Variables.html#2116" class="Generalizable">a</a>
  <a id="2143" href="Meta.Variables.html#2143" class="Generalizable">n</a> <a id="2145" class="Symbol">:</a> <a id="2147" href="Agda.Builtin.Nat.html#203" class="Datatype">‚Ñï</a>

<a id="empty-vars"></a><a id="2150" href="Meta.Variables.html#2150" class="Function">empty-vars</a> <a id="2161" class="Symbol">:</a> <a id="2163" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="2173" href="Meta.Variables.html#2130" class="Generalizable">A</a>
<a id="2175" href="Meta.Variables.html#2150" class="Function">empty-vars</a> <a id="2186" class="Symbol">=</a> <a id="2188" href="Meta.Variables.html#1895" class="InductiveConstructor">mk-variables</a> <a id="2201" href="Meta.Variables.html#1771" class="InductiveConstructor">[]</a> <a id="2204" class="Symbol">(Œª</a> <a id="2207" href="Meta.Variables.html#2207" class="Bound">_</a> <a id="2209" class="Symbol">‚Üí</a> <a id="2211" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2218" class="Symbol">)</a>

<a id="2221" class="Keyword">private</a>
  <a id="bind"></a><a id="2231" href="Meta.Variables.html#2231" class="Function">bind</a> <a id="2236" class="Symbol">:</a> <a id="2238" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2243" class="Symbol">‚Üí</a> <a id="2245" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2250" class="Symbol">‚Üí</a> <a id="2252" class="Symbol">(</a><a id="2253" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2258" class="Symbol">‚Üí</a> <a id="2260" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2266" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2270" class="Symbol">)</a> <a id="2272" class="Symbol">‚Üí</a> <a id="2274" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2279" class="Symbol">‚Üí</a> <a id="2281" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2287" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2294" href="Meta.Variables.html#2231" class="Function">bind</a> <a id="2299" href="Meta.Variables.html#2299" class="Bound">tm</a> <a id="2302" href="Meta.Variables.html#2302" class="Bound">tm-var</a> <a id="2309" href="Meta.Variables.html#2309" class="Bound">lookup</a> <a id="2316" href="Meta.Variables.html#2316" class="Bound">tm‚Ä≤</a> <a id="2320" class="Keyword">with</a> <a id="2325" href="Meta.Variables.html#2309" class="Bound">lookup</a> <a id="2332" href="Meta.Variables.html#2316" class="Bound">tm‚Ä≤</a> <a id="2336" class="Symbol">|</a> <a id="2338" href="Meta.Variables.html#2299" class="Bound">tm</a> <a id="2341" href="Meta.Reflection.html#4905" class="Function Operator">term=?</a> <a id="2348" href="Meta.Variables.html#2316" class="Bound">tm‚Ä≤</a>
  <a id="2354" class="Symbol">...</a> <a id="2358" class="Symbol">|</a> <a id="2360" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2365" href="Meta.Variables.html#2365" class="Bound">tm‚Ä≤-var</a> <a id="2373" class="Symbol">|</a> <a id="2375" class="Symbol">_</a> <a id="2377" class="Symbol">=</a> <a id="2379" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2384" href="Meta.Variables.html#2365" class="Bound">tm‚Ä≤-var</a>
  <a id="2394" class="Symbol">...</a> <a id="2398" class="Symbol">|</a> <a id="2400" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>      <a id="2413" class="Symbol">|</a> <a id="2415" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="2420" class="Symbol">=</a> <a id="2422" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2427" class="Bound">tm-var</a>
  <a id="2436" class="Symbol">...</a> <a id="2440" class="Symbol">|</a> <a id="2442" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>      <a id="2455" class="Symbol">|</a> <a id="2457" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2463" class="Symbol">=</a> <a id="2465" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

  <a id="fin-term"></a><a id="2476" href="Meta.Variables.html#2476" class="Function">fin-term</a> <a id="2485" class="Symbol">:</a> <a id="2487" href="Agda.Builtin.Nat.html#203" class="Datatype">‚Ñï</a> <a id="2489" class="Symbol">‚Üí</a> <a id="2491" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2498" href="Meta.Variables.html#2476" class="Function">fin-term</a> <a id="2507" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2512" class="Symbol">=</a> <a id="2514" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="2518" class="Symbol">(</a><a id="2519" class="Keyword">quote</a> <a id="2525" href="Data.Fin.Base.html#213" class="InductiveConstructor">fzero</a><a id="2530" class="Symbol">)</a> <a id="2532" class="Symbol">(</a><a id="2533" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a> <a id="2541" href="Meta.Reflection.html#2701" class="InductiveConstructor Operator">h‚à∑</a> <a id="2544" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2546" class="Symbol">)</a>
  <a id="2550" href="Meta.Variables.html#2476" class="Function">fin-term</a> <a id="2559" class="Symbol">(</a><a id="2560" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2564" href="Meta.Variables.html#2564" class="Bound">n</a><a id="2565" class="Symbol">)</a> <a id="2567" class="Symbol">=</a> <a id="2569" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="2573" class="Symbol">(</a><a id="2574" class="Keyword">quote</a> <a id="2580" href="Data.Fin.Base.html#243" class="InductiveConstructor">fsuc</a><a id="2584" class="Symbol">)</a> <a id="2586" class="Symbol">(</a><a id="2587" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a> <a id="2595" href="Meta.Reflection.html#2701" class="InductiveConstructor Operator">h‚à∑</a> <a id="2598" href="Meta.Variables.html#2476" class="Function">fin-term</a> <a id="2607" href="Meta.Variables.html#2564" class="Bound">n</a> <a id="2609" href="Meta.Reflection.html#2669" class="InductiveConstructor Operator">v‚à∑</a> <a id="2612" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2614" class="Symbol">)</a>

  <a id="env-rec"></a><a id="2619" href="Meta.Variables.html#2619" class="Function">env-rec</a> <a id="2627" class="Symbol">:</a> <a id="2629" class="Symbol">(</a><a id="2630" href="Meta.Variables.html#2630" class="Bound">Mot</a> <a id="2634" class="Symbol">:</a> <a id="2636" class="Symbol">@</a><a id="2637" class="Symbol">0</a> <a id="2639" href="Agda.Builtin.Nat.html#203" class="Datatype">‚Ñï</a> <a id="2641" class="Symbol">‚Üí</a> <a id="2643" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2648" href="Meta.Variables.html#2118" class="Generalizable">b</a><a id="2649" class="Symbol">)</a>
          <a id="2661" class="Symbol">‚Üí</a> <a id="2663" class="Symbol">(‚àÄ</a> <a id="2666" class="Symbol">{</a><a id="2667" href="Meta.Variables.html#2667" class="Bound">n</a><a id="2668" class="Symbol">}</a> <a id="2670" class="Symbol">‚Üí</a> <a id="2672" href="Meta.Variables.html#2630" class="Bound">Mot</a> <a id="2676" href="Meta.Variables.html#2667" class="Bound">n</a> <a id="2678" class="Symbol">‚Üí</a> <a id="2680" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="2682" class="Symbol">‚Üí</a> <a id="2684" href="Meta.Variables.html#2630" class="Bound">Mot</a> <a id="2688" class="Symbol">(</a><a id="2689" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2693" href="Meta.Variables.html#2667" class="Bound">n</a><a id="2694" class="Symbol">))</a>
          <a id="2707" class="Symbol">‚Üí</a> <a id="2709" href="Meta.Variables.html#2630" class="Bound">Mot</a> <a id="2713" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>
          <a id="2728" class="Symbol">‚Üí</a> <a id="2730" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="2734" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="2736" href="Meta.Variables.html#2143" class="Generalizable">n</a> <a id="2738" class="Symbol">‚Üí</a> <a id="2740" href="Meta.Variables.html#2630" class="Bound">Mot</a> <a id="2744" href="Meta.Variables.html#2143" class="Generalizable">n</a>
  <a id="2748" href="Meta.Variables.html#2619" class="Function">env-rec</a> <a id="2756" href="Meta.Variables.html#2756" class="Bound">Mot</a> <a id="2760" href="Meta.Variables.html#2760" class="Bound Operator">_‚ñ∑*_</a> <a id="2765" href="Meta.Variables.html#2765" class="Bound">[]*</a> <a id="2769" href="Meta.Variables.html#1771" class="InductiveConstructor">[]</a>       <a id="2778" class="Symbol">=</a> <a id="2780" href="Meta.Variables.html#2765" class="Bound">[]*</a>
  <a id="2786" href="Meta.Variables.html#2619" class="Function">env-rec</a> <a id="2794" href="Meta.Variables.html#2794" class="Bound">Mot</a> <a id="2798" href="Meta.Variables.html#2798" class="Bound Operator">_‚ñ∑*_</a> <a id="2803" href="Meta.Variables.html#2803" class="Bound">[]*</a> <a id="2807" class="Symbol">(</a><a id="2808" href="Meta.Variables.html#2808" class="Bound">xs</a> <a id="2811" href="Meta.Variables.html#1789" class="InductiveConstructor Operator">‚ñ∑</a> <a id="2813" href="Meta.Variables.html#2813" class="Bound">x</a><a id="2814" class="Symbol">)</a> <a id="2816" class="Symbol">=</a> <a id="2818" href="Meta.Variables.html#2619" class="Function">env-rec</a> <a id="2826" class="Symbol">(Œª</a> <a id="2829" href="Meta.Variables.html#2829" class="Bound">z</a> <a id="2831" class="Symbol">‚Üí</a> <a id="2833" href="Meta.Variables.html#2794" class="Bound">Mot</a> <a id="2837" class="Symbol">(</a><a id="2838" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2842" href="Meta.Variables.html#2829" class="Bound">z</a><a id="2843" class="Symbol">))</a> <a id="2846" href="Meta.Variables.html#2798" class="Bound Operator">_‚ñ∑*_</a> <a id="2851" class="Symbol">(</a><a id="2852" href="Meta.Variables.html#2803" class="Bound">[]*</a> <a id="2856" href="Meta.Variables.html#2798" class="Bound Operator">‚ñ∑*</a> <a id="2859" href="Meta.Variables.html#2813" class="Bound">x</a><a id="2860" class="Symbol">)</a> <a id="2862" href="Meta.Variables.html#2808" class="Bound">xs</a>

  <a id="reverse-env"></a><a id="2868" href="Meta.Variables.html#2868" class="Function">reverse-env</a> <a id="2880" class="Symbol">:</a> <a id="2882" href="Meta.Variables.html#1729" class="Datatype">Env</a> <a id="2886" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="2888" href="Meta.Variables.html#2143" class="Generalizable">n</a> <a id="2890" class="Symbol">‚Üí</a> <a id="2892" href="Data.Vec.Base.html#232" class="Datatype">Vec</a> <a id="2896" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="2898" href="Meta.Variables.html#2143" class="Generalizable">n</a>
  <a id="2902" href="Meta.Variables.html#2868" class="Function">reverse-env</a> <a id="2914" class="Symbol">{</a><a id="2915" href="Meta.Variables.html#2915" class="Bound">A</a><a id="2916" class="Symbol">}</a> <a id="2918" href="Meta.Variables.html#2918" class="Bound">env</a> <a id="2922" class="Symbol">=</a> <a id="2924" href="Meta.Variables.html#2619" class="Function">env-rec</a> <a id="2932" class="Symbol">(</a><a id="2933" href="Data.Vec.Base.html#232" class="Datatype">Vec</a> <a id="2937" href="Meta.Variables.html#2915" class="Bound">A</a><a id="2938" class="Symbol">)</a> <a id="2940" class="Symbol">(Œª</a> <a id="2943" href="Meta.Variables.html#2943" class="Bound">xs</a> <a id="2946" href="Meta.Variables.html#2946" class="Bound">x</a> <a id="2948" class="Symbol">‚Üí</a> <a id="2950" href="Meta.Variables.html#2946" class="Bound">x</a> <a id="2952" href="Data.Vec.Base.html#292" class="InductiveConstructor Operator">‚à∑</a> <a id="2954" href="Meta.Variables.html#2943" class="Bound">xs</a><a id="2956" class="Symbol">)</a> <a id="2958" href="Data.Vec.Base.html#273" class="InductiveConstructor">[]</a> <a id="2961" href="Meta.Variables.html#2918" class="Bound">env</a>



<a id="2968" class="Comment">-- Get the variable associated with a term, binding a new</a>
<a id="3026" class="Comment">-- one as need be. Note that this returns the variable</a>
<a id="3081" class="Comment">-- as a quoted term!</a>
<a id="bind-var"></a><a id="3102" href="Meta.Variables.html#3102" class="Function">bind-var</a> <a id="3111" class="Symbol">:</a> <a id="3113" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="3123" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="3125" class="Symbol">‚Üí</a> <a id="3127" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3132" class="Symbol">‚Üí</a> <a id="3134" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3137" class="Symbol">(</a><a id="3138" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3143" href="Foundations.Sigma.Base.html#498" class="Function Operator">√ó</a> <a id="3145" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="3155" href="Meta.Variables.html#2130" class="Generalizable">A</a><a id="3156" class="Symbol">)</a>
<a id="3158" href="Meta.Variables.html#3102" class="Function">bind-var</a> <a id="3167" href="Meta.Variables.html#3167" class="Bound">vs</a> <a id="3170" href="Meta.Variables.html#3170" class="Bound">tm</a> <a id="3173" class="Keyword">with</a> <a id="3178" href="Meta.Variables.html#2050" class="Field">variables</a> <a id="3188" href="Meta.Variables.html#3167" class="Bound">vs</a> <a id="3191" href="Meta.Variables.html#3170" class="Bound">tm</a>
<a id="3194" class="Symbol">...</a> <a id="3198" class="Symbol">|</a> <a id="3200" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3205" href="Meta.Variables.html#3205" class="Bound">v</a> <a id="3207" class="Symbol">=</a> <a id="3209" class="Keyword">do</a>
  <a id="3214" href="Agda.Builtin.Reflection.html#8645" class="Postulate">returnTC</a> <a id="3223" class="Symbol">(</a><a id="3224" href="Meta.Variables.html#3205" class="Bound">v</a> <a id="3226" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3228" class="Bound">vs</a><a id="3230" class="Symbol">)</a>
<a id="3232" class="Symbol">...</a> <a id="3236" class="Symbol">|</a> <a id="3238" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3246" class="Symbol">=</a> <a id="3248" class="Keyword">do</a>
  <a id="3253" href="Meta.Variables.html#3253" class="Bound">a</a> <a id="3255" href="Meta.Bind.html#190" class="Field Operator">‚Üê</a> <a id="3257" href="Agda.Builtin.Reflection.html#9142" class="Postulate">unquoteTC</a> <a id="3267" class="Bound">tm</a>
  <a id="3272" class="Keyword">let</a> <a id="3276" href="Meta.Variables.html#3276" class="Bound">v</a> <a id="3278" class="Symbol">=</a> <a id="3280" href="Meta.Variables.html#2476" class="Function">fin-term</a> <a id="3289" class="Symbol">(</a><a id="3290" href="Meta.Variables.html#1921" class="Field">nvars</a> <a id="3296" class="Bound">vs</a><a id="3298" class="Symbol">)</a>
  <a id="3302" class="Keyword">let</a> <a id="3306" href="Meta.Variables.html#3306" class="Bound">vs‚Ä≤</a> <a id="3310" class="Symbol">=</a> <a id="3312" href="Meta.Variables.html#1895" class="InductiveConstructor">mk-variables</a> <a id="3325" class="Symbol">(</a><a id="3326" href="Meta.Variables.html#2026" class="Field">bound</a> <a id="3332" class="Bound">vs</a> <a id="3335" href="Meta.Variables.html#1789" class="InductiveConstructor Operator">‚ñ∑</a> <a id="3337" href="Meta.Variables.html#3253" class="Bound">a</a><a id="3338" class="Symbol">)</a>
                         <a id="3365" class="Symbol">(</a><a id="3366" href="Meta.Variables.html#2231" class="Function">bind</a> <a id="3371" class="Bound">tm</a> <a id="3374" href="Meta.Variables.html#3276" class="Bound">v</a> <a id="3376" class="Symbol">(</a><a id="3377" href="Meta.Variables.html#2050" class="Field">variables</a> <a id="3387" class="Bound">vs</a><a id="3389" class="Symbol">))</a>
  <a id="3394" href="Agda.Builtin.Reflection.html#8645" class="Postulate">returnTC</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Meta.Variables.html#3276" class="Bound">v</a> <a id="3406" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3408" href="Meta.Variables.html#3306" class="Bound">vs‚Ä≤</a><a id="3411" class="Symbol">)</a>

<a id="environment"></a><a id="3414" href="Meta.Variables.html#3414" class="Function">environment</a> <a id="3426" class="Symbol">:</a> <a id="3428" href="Meta.Variables.html#1839" class="Record">Variables</a> <a id="3438" href="Meta.Variables.html#2130" class="Generalizable">A</a> <a id="3440" class="Symbol">‚Üí</a> <a id="3442" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3445" class="Symbol">(</a><a id="3446" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3451" href="Foundations.Sigma.Base.html#498" class="Function Operator">√ó</a> <a id="3453" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3457" class="Symbol">)</a>
<a id="3459" href="Meta.Variables.html#3414" class="Function">environment</a> <a id="3471" href="Meta.Variables.html#3471" class="Bound">vs</a> <a id="3474" class="Symbol">=</a> <a id="3476" class="Keyword">do</a>
  <a id="3481" href="Meta.Variables.html#3481" class="Bound">env</a> <a id="3485" href="Meta.Bind.html#190" class="Field Operator">‚Üê</a> <a id="3487" href="Agda.Builtin.Reflection.html#9089" class="Postulate">quoteTC</a> <a id="3495" class="Symbol">(</a><a id="3496" href="Meta.Variables.html#2868" class="Function">reverse-env</a> <a id="3508" class="Symbol">(</a><a id="3509" href="Meta.Variables.html#2026" class="Field">bound</a> <a id="3515" href="Meta.Variables.html#3471" class="Bound">vs</a><a id="3517" class="Symbol">))</a>
  <a id="3522" href="Meta.Variables.html#3522" class="Bound">size</a> <a id="3527" href="Meta.Bind.html#190" class="Field Operator">‚Üê</a> <a id="3529" href="Agda.Builtin.Reflection.html#9089" class="Postulate">quoteTC</a> <a id="3537" class="Symbol">(</a><a id="3538" href="Meta.Variables.html#1921" class="Field">nvars</a> <a id="3544" href="Meta.Variables.html#3471" class="Bound">vs</a><a id="3546" class="Symbol">)</a>
  <a id="3550" href="Agda.Builtin.Reflection.html#8645" class="Postulate">returnTC</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Meta.Variables.html#3522" class="Bound">size</a> <a id="3565" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3567" href="Meta.Variables.html#3481" class="Bound">env</a><a id="3570" class="Symbol">)</a>
</pre></body></html>