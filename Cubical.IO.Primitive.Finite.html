<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Cubical.IO.Primitive.Finite</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Primitive IO: simple bindings to Haskell types and functions</a>
<a id="170" class="Comment">-- Everything is assumed to be finite</a>
<a id="208" class="Comment">------------------------------------------------------------------------</a>

<a id="282" class="Keyword">module</a> <a id="289" href="Cubical.IO.Primitive.Finite.html" class="Module">Cubical.IO.Primitive.Finite</a> <a id="317" class="Keyword">where</a>

<a id="324" class="Comment">-- NOTE: the contents of this module should be accessed via `Cubical.IO` or</a>
<a id="400" class="Comment">-- `Cubical.IO.Finite`.</a>

<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Agda.Builtin.IO.html" class="Module">Agda.Builtin.IO</a>
<a id="453" class="Keyword">open</a> <a id="458" class="Keyword">import</a> <a id="465" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a> <a id="515" class="Keyword">using</a> <a id="521" class="Symbol">()</a> <a id="524" class="Keyword">renaming</a> <a id="533" class="Symbol">(</a><a id="534" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="536" class="Symbol">to</a> <a id="539" class="Record">Unit</a><a id="543" class="Symbol">)</a>

<a id="546" class="Comment">------------------------------------------------------------------------</a>
<a id="619" class="Comment">-- Simple lazy IO</a>

<a id="638" class="Comment">-- Note that the functions below produce commands which, when</a>
<a id="700" class="Comment">-- executed, may raise exceptions.</a>

<a id="736" class="Comment">-- Note also that the semantics of these functions depends on the</a>
<a id="802" class="Comment">-- version of the Haskell base library. If the version is 4.2.0.0 (or</a>
<a id="872" class="Comment">-- later?), then the functions use the character encoding specified by</a>
<a id="943" class="Comment">-- the locale. For older versions of the library (going back to at</a>
<a id="1010" class="Comment">-- least version 3) the functions use ISO-8859-1.</a>

<a id="1061" class="Keyword">postulate</a>
  <a id="getLine"></a><a id="1073" href="Cubical.IO.Primitive.Finite.html#1073" class="Postulate">getLine</a>     <a id="1085" class="Symbol">:</a> <a id="1087" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1090" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="readFile"></a><a id="1099" href="Cubical.IO.Primitive.Finite.html#1099" class="Postulate">readFile</a>    <a id="1111" class="Symbol">:</a> <a id="1113" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1125" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="writeFile"></a><a id="1134" href="Cubical.IO.Primitive.Finite.html#1134" class="Postulate">writeFile</a>   <a id="1146" class="Symbol">:</a> <a id="1148" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1155" class="Symbol">→</a> <a id="1157" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1164" class="Symbol">→</a> <a id="1166" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1169" href="Cubical.IO.Primitive.Finite.html#539" class="Record">Unit</a>
  <a id="appendFile"></a><a id="1176" href="Cubical.IO.Primitive.Finite.html#1176" class="Postulate">appendFile</a>  <a id="1188" class="Symbol">:</a> <a id="1190" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1197" class="Symbol">→</a> <a id="1199" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1206" class="Symbol">→</a> <a id="1208" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1211" href="Cubical.IO.Primitive.Finite.html#539" class="Record">Unit</a>
  <a id="putStr"></a><a id="1218" href="Cubical.IO.Primitive.Finite.html#1218" class="Postulate">putStr</a>      <a id="1230" class="Symbol">:</a> <a id="1232" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1239" class="Symbol">→</a> <a id="1241" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1244" href="Cubical.IO.Primitive.Finite.html#539" class="Record">Unit</a>
  <a id="putStrLn"></a><a id="1251" href="Cubical.IO.Primitive.Finite.html#1251" class="Postulate">putStrLn</a>    <a id="1263" class="Symbol">:</a> <a id="1265" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1272" class="Symbol">→</a> <a id="1274" href="Agda.Builtin.IO.html#137" class="Postulate">IO</a> <a id="1277" href="Cubical.IO.Primitive.Finite.html#539" class="Record">Unit</a>

<a id="1283" class="Symbol">{-#</a> <a id="1287" class="Keyword">FOREIGN</a> <a id="1295" class="Pragma">GHC</a> <a id="1299" class="Pragma">import</a> <a id="1306" class="Pragma">qualified</a> <a id="1316" class="Pragma">Data.Text</a>    <a id="1329" class="Pragma">as</a> <a id="1332" class="Pragma">T</a>   <a id="1336" class="Symbol">#-}</a>
<a id="1340" class="Symbol">{-#</a> <a id="1344" class="Keyword">FOREIGN</a> <a id="1352" class="Pragma">GHC</a> <a id="1356" class="Pragma">import</a> <a id="1363" class="Pragma">qualified</a> <a id="1373" class="Pragma">Data.Text.IO</a> <a id="1386" class="Pragma">as</a> <a id="1389" class="Pragma">TIO</a> <a id="1393" class="Symbol">#-}</a>
<a id="1397" class="Symbol">{-#</a> <a id="1401" class="Keyword">FOREIGN</a> <a id="1409" class="Pragma">GHC</a> <a id="1413" class="Pragma">import</a> <a id="1420" class="Pragma">qualified</a> <a id="1430" class="Pragma">System.IO</a>           <a id="1450" class="Symbol">#-}</a>
<a id="1454" class="Symbol">{-#</a> <a id="1458" class="Keyword">FOREIGN</a> <a id="1466" class="Pragma">GHC</a> <a id="1470" class="Pragma">import</a> <a id="1477" class="Pragma">qualified</a> <a id="1487" class="Pragma">Control.Exception</a>   <a id="1507" class="Symbol">#-}</a>

<a id="1512" class="Symbol">{-#</a> <a id="1516" class="Keyword">FOREIGN</a> <a id="1524" class="Pragma">GHC</a>
  <a id="1530" class="Pragma">--</a> <a id="1533" class="Pragma">Reads</a> <a id="1539" class="Pragma">a</a> <a id="1541" class="Pragma">finite</a> <a id="1548" class="Pragma">file.</a> <a id="1554" class="Pragma">Raises</a> <a id="1561" class="Pragma">an</a> <a id="1564" class="Pragma">exception</a> <a id="1574" class="Pragma">if</a> <a id="1577" class="Pragma">the</a> <a id="1581" class="Pragma">file</a> <a id="1586" class="Pragma">path</a> <a id="1591" class="Pragma">refers</a>
  <a id="1600" class="Pragma">--</a> <a id="1603" class="Pragma">to</a> <a id="1606" class="Pragma">a</a> <a id="1608" class="Pragma">non-physical</a> <a id="1621" class="Pragma">file</a> <a id="1626" class="Pragma">(like</a> <a id="1632" class="Pragma">&quot;/dev/zero&quot;).</a>
  <a id="1648" class="Pragma">readFiniteFile</a> <a id="1663" class="Pragma">::</a> <a id="1666" class="Pragma">T.Text</a> <a id="1673" class="Pragma">-&gt;</a> <a id="1676" class="Pragma">IO</a> <a id="1679" class="Pragma">T.Text</a>
  <a id="1688" class="Pragma">readFiniteFile</a> <a id="1703" class="Pragma">f</a> <a id="1705" class="Pragma">=</a> <a id="1707" class="Pragma">do</a>
    <a id="1714" class="Pragma">h</a> <a id="1716" class="Pragma">&lt;-</a> <a id="1719" class="Pragma">System.IO.openFile</a> <a id="1738" class="Pragma">(T.unpack</a> <a id="1748" class="Pragma">f)</a> <a id="1751" class="Pragma">System.IO.ReadMode</a>
    <a id="1774" class="Pragma">Control.Exception.bracketOnError</a> <a id="1807" class="Pragma">(return</a> <a id="1815" class="Pragma">())</a> <a id="1819" class="Pragma">(\_</a> <a id="1823" class="Pragma">-&gt;</a> <a id="1826" class="Pragma">System.IO.hClose</a> <a id="1843" class="Pragma">h)</a>
                                                 <a id="1895" class="Pragma">(\_</a> <a id="1899" class="Pragma">-&gt;</a> <a id="1902" class="Pragma">System.IO.hFileSize</a> <a id="1922" class="Pragma">h)</a>
    <a id="1929" class="Pragma">TIO.hGetContents</a> <a id="1946" class="Pragma">h</a>
<a id="1948" class="Symbol">#-}</a>

<a id="1953" class="Symbol">{-#</a> <a id="1957" class="Keyword">COMPILE</a> <a id="1965" class="Keyword">GHC</a> <a id="1969" href="Cubical.IO.Primitive.Finite.html#1073" class="Postulate">getLine</a>    <a id="1980" class="Pragma">=</a> <a id="1982" class="Pragma">TIO.getLine</a>               <a id="2008" class="Symbol">#-}</a>
<a id="2012" class="Symbol">{-#</a> <a id="2016" class="Keyword">COMPILE</a> <a id="2024" class="Keyword">GHC</a> <a id="2028" href="Cubical.IO.Primitive.Finite.html#1099" class="Postulate">readFile</a>   <a id="2039" class="Pragma">=</a> <a id="2041" class="Pragma">readFiniteFile</a>            <a id="2067" class="Symbol">#-}</a>
<a id="2071" class="Symbol">{-#</a> <a id="2075" class="Keyword">COMPILE</a> <a id="2083" class="Keyword">GHC</a> <a id="2087" href="Cubical.IO.Primitive.Finite.html#1134" class="Postulate">writeFile</a>  <a id="2098" class="Pragma">=</a> <a id="2100" class="Pragma">TIO.writeFile</a> <a id="2114" class="Pragma">.</a> <a id="2116" class="Pragma">T.unpack</a>  <a id="2126" class="Symbol">#-}</a>
<a id="2130" class="Symbol">{-#</a> <a id="2134" class="Keyword">COMPILE</a> <a id="2142" class="Keyword">GHC</a> <a id="2146" href="Cubical.IO.Primitive.Finite.html#1176" class="Postulate">appendFile</a> <a id="2157" class="Pragma">=</a> <a id="2159" class="Pragma">TIO.appendFile</a> <a id="2174" class="Pragma">.</a> <a id="2176" class="Pragma">T.unpack</a> <a id="2185" class="Symbol">#-}</a>
<a id="2189" class="Symbol">{-#</a> <a id="2193" class="Keyword">COMPILE</a> <a id="2201" class="Keyword">GHC</a> <a id="2205" href="Cubical.IO.Primitive.Finite.html#1218" class="Postulate">putStr</a>     <a id="2216" class="Pragma">=</a> <a id="2218" class="Pragma">TIO.putStr</a>                <a id="2244" class="Symbol">#-}</a>
<a id="2248" class="Symbol">{-#</a> <a id="2252" class="Keyword">COMPILE</a> <a id="2260" class="Keyword">GHC</a> <a id="2264" href="Cubical.IO.Primitive.Finite.html#1251" class="Postulate">putStrLn</a>   <a id="2275" class="Pragma">=</a> <a id="2277" class="Pragma">TIO.putStrLn</a>              <a id="2303" class="Symbol">#-}</a>

<a id="2308" class="Symbol">{-#</a> <a id="2312" class="Keyword">COMPILE</a> <a id="2320" class="Keyword">UHC</a> <a id="2324" href="Cubical.IO.Primitive.Finite.html#1099" class="Postulate">readFile</a> <a id="2333" class="Pragma">=</a> <a id="2335" class="Pragma">UHC.Agda.Builtins.primReadFiniteFile</a>  <a id="2373" class="Symbol">#-}</a>
</pre></body></html>