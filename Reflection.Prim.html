<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.Prim</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">{-

Some basic utilities for reflection

-}</a>
<a id="45" class="Symbol">{-#</a> <a id="49" class="Keyword">OPTIONS</a> <a id="57" class="Pragma">--safe</a> <a id="64" class="Symbol">#-}</a>
<a id="68" class="Keyword">module</a> <a id="75" href="Reflection.Prim.html" class="Module">Reflection.Prim</a> <a id="91" class="Keyword">where</a>

<a id="98" class="Keyword">open</a> <a id="103" class="Keyword">import</a> <a id="110" href="Foundations.Prim.Type.html" class="Module">Foundations.Prim.Type</a>
<a id="132" class="Keyword">open</a> <a id="137" class="Keyword">import</a> <a id="144" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="158" class="Keyword">open</a> <a id="163" class="Keyword">import</a> <a id="170" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Data.String.Prim.html" class="Module">Data.String.Prim</a>

<a id="215" class="Comment">-- TODO: reexport everything from here, rename as needed</a>
<a id="272" class="Comment">--       all the following stuff should go into `Reflection.Base`</a>
<a id="338" class="Keyword">import</a> <a id="345" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="369" class="Symbol">as</a> <a id="372" class="Module">R</a>

<a id="_&gt;&gt;=_"></a><a id="375" href="Reflection.Prim.html#375" class="Function Operator">_&gt;&gt;=_</a> <a id="381" class="Symbol">=</a> <a id="383" href="Agda.Builtin.Reflection.html#8389" class="Postulate">R.bindTC</a>
<a id="_&lt;|&gt;_"></a><a id="392" href="Reflection.Prim.html#392" class="Function Operator">_&lt;|&gt;_</a> <a id="398" class="Symbol">=</a> <a id="400" href="Agda.Builtin.Reflection.html#8723" class="Postulate">R.catchTC</a>

<a id="_&gt;&gt;_"></a><a id="411" href="Reflection.Prim.html#411" class="Function Operator">_&gt;&gt;_</a> <a id="416" class="Symbol">:</a> <a id="418" class="Symbol">∀</a> <a id="420" class="Symbol">{</a><a id="421" href="Reflection.Prim.html#421" class="Bound">ℓ</a> <a id="423" href="Reflection.Prim.html#423" class="Bound">ℓ&#39;</a><a id="425" class="Symbol">}</a> <a id="427" class="Symbol">{</a><a id="428" href="Reflection.Prim.html#428" class="Bound">A</a> <a id="430" class="Symbol">:</a> <a id="432" href="Foundations.Prim.Type.html#228" class="Primitive">Type</a> <a id="437" href="Reflection.Prim.html#421" class="Bound">ℓ</a><a id="438" class="Symbol">}</a> <a id="440" class="Symbol">{</a><a id="441" href="Reflection.Prim.html#441" class="Bound">B</a> <a id="443" class="Symbol">:</a> <a id="445" href="Foundations.Prim.Type.html#228" class="Primitive">Type</a> <a id="450" href="Reflection.Prim.html#423" class="Bound">ℓ&#39;</a><a id="452" class="Symbol">}</a> <a id="454" class="Symbol">→</a> <a id="456" href="Agda.Builtin.Reflection.html#8296" class="Postulate">R.TC</a> <a id="461" href="Reflection.Prim.html#428" class="Bound">A</a> <a id="463" class="Symbol">→</a> <a id="465" href="Agda.Builtin.Reflection.html#8296" class="Postulate">R.TC</a> <a id="470" href="Reflection.Prim.html#441" class="Bound">B</a> <a id="472" class="Symbol">→</a> <a id="474" href="Agda.Builtin.Reflection.html#8296" class="Postulate">R.TC</a> <a id="479" href="Reflection.Prim.html#441" class="Bound">B</a>
<a id="481" href="Reflection.Prim.html#481" class="Bound">f</a> <a id="483" href="Reflection.Prim.html#411" class="Function Operator">&gt;&gt;</a> <a id="486" href="Reflection.Prim.html#486" class="Bound">g</a> <a id="488" class="Symbol">=</a> <a id="490" href="Reflection.Prim.html#481" class="Bound">f</a> <a id="492" href="Reflection.Prim.html#375" class="Function Operator">&gt;&gt;=</a> <a id="496" class="Symbol">λ</a> <a id="498" href="Reflection.Prim.html#498" class="Bound">_</a> <a id="500" class="Symbol">→</a> <a id="502" href="Reflection.Prim.html#486" class="Bound">g</a>

<a id="505" class="Keyword">infixl</a> <a id="512" class="Number">4</a> <a id="514" href="Reflection.Prim.html#375" class="Function Operator">_&gt;&gt;=_</a> <a id="520" href="Reflection.Prim.html#411" class="Function Operator">_&gt;&gt;_</a> <a id="525" href="Reflection.Prim.html#392" class="Function Operator">_&lt;|&gt;_</a>

<a id="532" class="Comment">-- TODO naming, add more generally useful combinators</a>

<a id="liftTC"></a><a id="587" href="Reflection.Prim.html#587" class="Function">liftTC</a> <a id="594" class="Symbol">:</a> <a id="596" class="Symbol">∀</a> <a id="598" class="Symbol">{</a><a id="599" href="Reflection.Prim.html#599" class="Bound">ℓ</a> <a id="601" href="Reflection.Prim.html#601" class="Bound">ℓ&#39;</a><a id="603" class="Symbol">}</a> <a id="605" class="Symbol">{</a><a id="606" href="Reflection.Prim.html#606" class="Bound">A</a> <a id="608" class="Symbol">:</a> <a id="610" href="Foundations.Prim.Type.html#228" class="Primitive">Type</a> <a id="615" href="Reflection.Prim.html#599" class="Bound">ℓ</a><a id="616" class="Symbol">}</a> <a id="618" class="Symbol">{</a><a id="619" href="Reflection.Prim.html#619" class="Bound">B</a> <a id="621" class="Symbol">:</a> <a id="623" href="Foundations.Prim.Type.html#228" class="Primitive">Type</a> <a id="628" href="Reflection.Prim.html#601" class="Bound">ℓ&#39;</a><a id="630" class="Symbol">}</a> <a id="632" class="Symbol">→</a> <a id="634" class="Symbol">(</a><a id="635" href="Reflection.Prim.html#606" class="Bound">A</a> <a id="637" class="Symbol">→</a> <a id="639" href="Reflection.Prim.html#619" class="Bound">B</a><a id="640" class="Symbol">)</a> <a id="642" class="Symbol">→</a> <a id="644" href="Agda.Builtin.Reflection.html#8296" class="Postulate">R.TC</a> <a id="649" href="Reflection.Prim.html#606" class="Bound">A</a> <a id="651" class="Symbol">→</a> <a id="653" href="Agda.Builtin.Reflection.html#8296" class="Postulate">R.TC</a> <a id="658" href="Reflection.Prim.html#619" class="Bound">B</a>
<a id="660" href="Reflection.Prim.html#587" class="Function">liftTC</a> <a id="667" href="Reflection.Prim.html#667" class="Bound">f</a> <a id="669" href="Reflection.Prim.html#669" class="Bound">ta</a> <a id="672" class="Symbol">=</a> <a id="674" href="Reflection.Prim.html#669" class="Bound">ta</a> <a id="677" href="Reflection.Prim.html#375" class="Function Operator">&gt;&gt;=</a> <a id="681" class="Symbol">λ</a> <a id="683" href="Reflection.Prim.html#683" class="Bound">a</a> <a id="685" class="Symbol">→</a> <a id="687" href="Agda.Builtin.Reflection.html#8339" class="Postulate">R.returnTC</a> <a id="698" class="Symbol">(</a><a id="699" href="Reflection.Prim.html#667" class="Bound">f</a> <a id="701" href="Reflection.Prim.html#683" class="Bound">a</a><a id="702" class="Symbol">)</a>

<a id="v"></a><a id="705" href="Reflection.Prim.html#705" class="Function">v</a> <a id="707" class="Symbol">:</a> <a id="709" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="711" class="Symbol">→</a> <a id="713" href="Agda.Builtin.Reflection.html#4687" class="Datatype">R.Term</a>
<a id="720" href="Reflection.Prim.html#705" class="Function">v</a> <a id="722" href="Reflection.Prim.html#722" class="Bound">n</a> <a id="724" class="Symbol">=</a> <a id="726" href="Agda.Builtin.Reflection.html#4832" class="InductiveConstructor">R.var</a> <a id="732" href="Reflection.Prim.html#722" class="Bound">n</a> <a id="734" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="738" class="Keyword">pattern</a> <a id="varg"></a><a id="746" href="Reflection.Prim.html#746" class="InductiveConstructor">varg</a> <a id="751" href="Reflection.Prim.html#821" class="Bound">t</a> <a id="753" class="Symbol">=</a> <a id="755" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="761" class="Symbol">(</a><a id="762" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">R.arg-info</a> <a id="773" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">R.visible</a> <a id="783" class="Symbol">(</a><a id="784" href="Agda.Builtin.Reflection.html#3463" class="InductiveConstructor">R.modality</a> <a id="795" href="Agda.Builtin.Reflection.html#3019" class="InductiveConstructor">R.relevant</a> <a id="806" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">R.quantity-ω</a><a id="818" class="Symbol">))</a> <a id="821" href="Reflection.Prim.html#821" class="Bound">t</a>
<a id="823" class="Keyword">pattern</a> <a id="harg"></a><a id="831" href="Reflection.Prim.html#831" class="InductiveConstructor">harg</a> <a id="836" class="Symbol">{</a>q <a id="839" class="Symbol">=</a> <a id="841" href="Reflection.Prim.html#898" class="Bound">q</a><a id="842" class="Symbol">}</a> <a id="844" href="Reflection.Prim.html#902" class="Bound">t</a> <a id="846" class="Symbol">=</a> <a id="848" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">R.arg</a> <a id="854" class="Symbol">(</a><a id="855" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">R.arg-info</a> <a id="866" href="Agda.Builtin.Reflection.html#2770" class="InductiveConstructor">R.hidden</a> <a id="875" class="Symbol">(</a><a id="876" href="Agda.Builtin.Reflection.html#3463" class="InductiveConstructor">R.modality</a> <a id="887" href="Agda.Builtin.Reflection.html#3019" class="InductiveConstructor">R.relevant</a> <a id="898" href="Reflection.Prim.html#898" class="Bound">q</a><a id="899" class="Symbol">))</a> <a id="902" href="Reflection.Prim.html#902" class="Bound">t</a>
<a id="904" class="Keyword">pattern</a> <a id="_v∷_"></a><a id="912" href="Reflection.Prim.html#912" class="InductiveConstructor Operator">_v∷_</a> <a id="917" href="Reflection.Prim.html#928" class="Bound">a</a> <a id="919" href="Reflection.Prim.html#932" class="Bound">l</a> <a id="921" class="Symbol">=</a> <a id="923" href="Reflection.Prim.html#746" class="InductiveConstructor">varg</a> <a id="928" href="Reflection.Prim.html#928" class="Bound">a</a> <a id="930" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="932" href="Reflection.Prim.html#932" class="Bound">l</a>
<a id="934" class="Keyword">pattern</a> <a id="_h∷_"></a><a id="942" href="Reflection.Prim.html#942" class="InductiveConstructor Operator">_h∷_</a> <a id="947" href="Reflection.Prim.html#958" class="Bound">a</a> <a id="949" href="Reflection.Prim.html#962" class="Bound">l</a> <a id="951" class="Symbol">=</a> <a id="953" href="Reflection.Prim.html#831" class="InductiveConstructor">harg</a> <a id="958" href="Reflection.Prim.html#958" class="Bound">a</a> <a id="960" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="962" href="Reflection.Prim.html#962" class="Bound">l</a>

<a id="965" class="Keyword">infixr</a> <a id="972" class="Number">5</a> <a id="974" href="Reflection.Prim.html#912" class="InductiveConstructor Operator">_v∷_</a> <a id="979" href="Reflection.Prim.html#942" class="InductiveConstructor Operator">_h∷_</a>

<a id="vlam"></a><a id="985" href="Reflection.Prim.html#985" class="Function">vlam</a> <a id="990" class="Symbol">:</a> <a id="992" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="999" class="Symbol">→</a> <a id="1001" href="Agda.Builtin.Reflection.html#4687" class="Datatype">R.Term</a> <a id="1008" class="Symbol">→</a> <a id="1010" href="Agda.Builtin.Reflection.html#4687" class="Datatype">R.Term</a>
<a id="1017" href="Reflection.Prim.html#985" class="Function">vlam</a> <a id="1022" href="Reflection.Prim.html#1022" class="Bound">str</a> <a id="1026" href="Reflection.Prim.html#1026" class="Bound">t</a> <a id="1028" class="Symbol">=</a> <a id="1030" href="Agda.Builtin.Reflection.html#5002" class="InductiveConstructor">R.lam</a> <a id="1036" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">R.visible</a> <a id="1046" class="Symbol">(</a><a id="1047" href="Agda.Builtin.Reflection.html#3979" class="InductiveConstructor">R.abs</a> <a id="1053" href="Reflection.Prim.html#1022" class="Bound">str</a> <a id="1057" href="Reflection.Prim.html#1026" class="Bound">t</a><a id="1058" class="Symbol">)</a>

<a id="hlam"></a><a id="1061" href="Reflection.Prim.html#1061" class="Function">hlam</a> <a id="1066" class="Symbol">:</a> <a id="1068" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1075" class="Symbol">→</a> <a id="1077" href="Agda.Builtin.Reflection.html#4687" class="Datatype">R.Term</a> <a id="1084" class="Symbol">→</a> <a id="1086" href="Agda.Builtin.Reflection.html#4687" class="Datatype">R.Term</a>
<a id="1093" href="Reflection.Prim.html#1061" class="Function">hlam</a> <a id="1098" href="Reflection.Prim.html#1098" class="Bound">str</a> <a id="1102" href="Reflection.Prim.html#1102" class="Bound">t</a> <a id="1104" class="Symbol">=</a> <a id="1106" href="Agda.Builtin.Reflection.html#5002" class="InductiveConstructor">R.lam</a> <a id="1112" href="Agda.Builtin.Reflection.html#2770" class="InductiveConstructor">R.hidden</a> <a id="1121" class="Symbol">(</a><a id="1122" href="Agda.Builtin.Reflection.html#3979" class="InductiveConstructor">R.abs</a> <a id="1128" href="Reflection.Prim.html#1098" class="Bound">str</a> <a id="1132" href="Reflection.Prim.html#1102" class="Bound">t</a><a id="1133" class="Symbol">)</a>

<a id="newMeta"></a><a id="1136" href="Reflection.Prim.html#1136" class="Function">newMeta</a> <a id="1144" class="Symbol">=</a> <a id="1146" href="Agda.Builtin.Reflection.html#8608" class="Postulate">R.checkType</a> <a id="1158" href="Agda.Builtin.Reflection.html#5288" class="InductiveConstructor">R.unknown</a>

<a id="1169" class="Comment">-- makeAuxiliaryDef : String → R.Type → R.Term → R.TC R.Term</a>
<a id="1230" class="Comment">-- makeAuxiliaryDef s ty term =</a>
<a id="1262" class="Comment">--   R.freshName s &gt;&gt;= λ name →</a>
<a id="1294" class="Comment">--   R.declareDef (varg name) ty &gt;&gt;</a>
<a id="1330" class="Comment">--   R.defineFun name [ R.clause [] [] term ] &gt;&gt;</a>
<a id="1379" class="Comment">--   R.returnTC (R.def name [])</a>
</pre></body></html>