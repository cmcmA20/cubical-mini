<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Deriving.Show</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Deriving.Show.html" class="Module">Meta.Deriving.Show</a> <a id="50" class="Keyword">where</a>

<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="87" class="Keyword">open</a> <a id="92" class="Keyword">import</a> <a id="99" href="Meta.Append.html" class="Module">Meta.Append</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Meta.Effect.Traversable.html" class="Module">Meta.Effect.Traversable</a>
<a id="147" class="Keyword">open</a> <a id="152" class="Keyword">import</a> <a id="159" href="Meta.Reflection.Base.html" class="Module">Meta.Reflection.Base</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Meta.Reflection.Signature.html" class="Module">Meta.Reflection.Signature</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Meta.Show.html" class="Module">Meta.Show</a> <a id="240" class="Keyword">public</a>

<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Data.Char.Base.html" class="Module">Data.Char.Base</a>
<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Data.Float.Instances.FromNat.html" class="Module">Data.Float.Instances.FromNat</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="370" class="Keyword">open</a> <a id="375" class="Keyword">import</a> <a id="382" href="Data.List.Operations.html" class="Module">Data.List.Operations</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Data.List.Instances.Map.html" class="Module">Data.List.Instances.Map</a>
<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Data.List.Instances.FromProduct.html" class="Module">Data.List.Instances.FromProduct</a>
<a id="483" class="Keyword">open</a> <a id="488" class="Keyword">import</a> <a id="495" href="Data.List.Instances.Traversable.html" class="Module">Data.List.Instances.Traversable</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Data.String.Base.html" class="Module">Data.String.Base</a>
<a id="582" class="Keyword">open</a> <a id="587" class="Keyword">import</a> <a id="594" href="Data.String.Instances.Append.html" class="Module">Data.String.Instances.Append</a>


<a id="625" class="Keyword">private</a>
  <a id="635" class="Comment">-- Parts of a mixfix name.</a>
  <a id="664" class="Keyword">data</a> <a id="Name-part"></a><a id="669" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a> <a id="679" class="Symbol">:</a> <a id="681" href="Foundations.Prim.Type.html#322" class="Primitive">Type</a> <a id="686" class="Keyword">where</a>
    <a id="696" class="Comment">-- An underscore.</a>
    <a id="Name-part.hole"></a><a id="718" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="723" class="Symbol">:</a> <a id="725" href="Agda.Builtin.Reflection.html#797" class="Datatype">Precedence</a> <a id="736" class="Symbol">→</a> <a id="738" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a>

    <a id="753" class="Comment">-- An identifier part.</a>
    <a id="Name-part.name"></a><a id="780" href="Meta.Deriving.Show.html#780" class="InductiveConstructor">name</a> <a id="785" class="Symbol">:</a> <a id="787" href="Agda.Builtin.String.html#335" class="Postulate">String</a>     <a id="798" class="Symbol">→</a> <a id="800" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a>

  <a id="813" class="Comment">-- Parse a name to a list of its parts.</a>
  <a id="name→parts"></a><a id="855" href="Meta.Deriving.Show.html#855" class="Function">name→parts</a> <a id="866" class="Symbol">:</a> <a id="868" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="875" class="Symbol">→</a> <a id="877" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="882" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a>
  <a id="894" href="Meta.Deriving.Show.html#855" class="Function">name→parts</a> <a id="905" class="Symbol">=</a> <a id="907" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="910" href="Meta.Reflection.Base.html#3048" class="Function">full-tank</a> <a id="920" href="Foundations.Pi.Base.html#1871" class="Function Operator">∘</a> <a id="922" href="Data.String.Base.html#229" class="Primitive">string→list</a> <a id="934" class="Keyword">where</a>
    <a id="944" href="Meta.Deriving.Show.html#944" class="Function">not-under</a> <a id="954" class="Symbol">:</a> <a id="956" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="961" class="Symbol">→</a> <a id="963" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
    <a id="972" href="Meta.Deriving.Show.html#944" class="Function">not-under</a> <a id="982" class="String">&#39;_&#39;</a> <a id="986" class="Symbol">=</a> <a id="988" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
    <a id="998" href="Meta.Deriving.Show.html#944" class="Function">not-under</a> <a id="1008" class="Symbol">_</a>   <a id="1012" class="Symbol">=</a> <a id="1014" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>

    <a id="1024" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1031" class="Symbol">→</a> <a id="1033" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1038" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="1043" class="Symbol">→</a> <a id="1045" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1050" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a>
    <a id="1064" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1067" class="Number">0</a> <a id="1069" class="Symbol">_</a> <a id="1071" class="Symbol">=</a> <a id="1073" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1080" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1083" class="Symbol">(</a><a id="1084" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1088" href="Meta.Deriving.Show.html#1088" class="Bound">fuel</a><a id="1092" class="Symbol">)</a> <a id="1094" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>         <a id="1105" class="Symbol">=</a> <a id="1107" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1114" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1122" href="Meta.Deriving.Show.html#1122" class="Bound">fuel</a><a id="1126" class="Symbol">)</a> <a id="1128" class="Symbol">(</a><a id="1129" class="String">&#39;_&#39;</a> <a id="1133" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1135" href="Meta.Deriving.Show.html#1135" class="Bound">cs</a><a id="1137" class="Symbol">)</a> <a id="1139" class="Symbol">=</a> <a id="1141" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="1146" href="Agda.Builtin.Reflection.html#855" class="InductiveConstructor">unrelated</a> <a id="1156" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1158" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1161" href="Meta.Deriving.Show.html#1122" class="Bound">fuel</a> <a id="1166" href="Meta.Deriving.Show.html#1135" class="Bound">cs</a>
    <a id="1173" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1176" class="Symbol">(</a><a id="1177" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1181" href="Meta.Deriving.Show.html#1181" class="Bound">fuel</a><a id="1185" class="Symbol">)</a> <a id="1187" class="Symbol">(</a><a id="1188" href="Meta.Deriving.Show.html#1188" class="Bound">c</a>   <a id="1192" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1194" href="Meta.Deriving.Show.html#1194" class="Bound">cs</a><a id="1196" class="Symbol">)</a> <a id="1198" class="Symbol">=</a>
      <a id="1206" class="Keyword">let</a> <a id="1210" class="Symbol">(</a><a id="1211" href="Meta.Deriving.Show.html#1211" class="Bound">p</a> <a id="1213" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1215" href="Meta.Deriving.Show.html#1215" class="Bound">r</a><a id="1216" class="Symbol">)</a> <a id="1218" class="Symbol">=</a> <a id="1220" href="Data.List.Operations.html#2511" class="Function">span</a> <a id="1225" href="Meta.Deriving.Show.html#944" class="Function">not-under</a> <a id="1235" class="Symbol">(</a><a id="1236" href="Meta.Deriving.Show.html#1188" class="Bound">c</a> <a id="1238" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1240" href="Meta.Deriving.Show.html#1194" class="Bound">cs</a><a id="1242" class="Symbol">)</a>
       <a id="1251" class="Keyword">in</a> <a id="1254" href="Meta.Deriving.Show.html#780" class="InductiveConstructor">name</a> <a id="1259" class="Symbol">(</a><a id="1260" href="Data.String.Base.html#269" class="Primitive">list→string</a> <a id="1272" href="Meta.Deriving.Show.html#1211" class="Bound">p</a><a id="1273" class="Symbol">)</a> <a id="1275" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1277" href="Meta.Deriving.Show.html#1024" class="Function">go</a> <a id="1280" href="Meta.Deriving.Show.html#1181" class="Bound">fuel</a> <a id="1285" href="Meta.Deriving.Show.html#1215" class="Bound">r</a>

  <a id="1290" class="Comment">-- Intermediate representation for the values to be concatenated when</a>
  <a id="1362" class="Comment">-- generating a clause for the Show instance.</a>
  <a id="1410" class="Keyword">data</a> <a id="Shown"></a><a id="1415" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a> <a id="1421" class="Symbol">:</a> <a id="1423" href="Foundations.Prim.Type.html#322" class="Primitive">Type</a> <a id="1428" class="Keyword">where</a>
    <a id="Shown.lits"></a><a id="1438" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="1443" class="Symbol">:</a> <a id="1445" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1452" class="Symbol">→</a> <a id="1454" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a>
    <a id="Shown.term"></a><a id="1464" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="1469" class="Symbol">:</a> <a id="1471" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>   <a id="1478" class="Symbol">→</a> <a id="1480" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a>

  <a id="1489" class="Comment">-- Cons a &#39;lits&#39; onto the list, but reduce adjacent &#39;lits&#39;.</a>
  <a id="cons-lits"></a><a id="1551" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="1561" class="Symbol">:</a> <a id="1563" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1570" class="Symbol">→</a> <a id="1572" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1577" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a> <a id="1583" class="Symbol">→</a> <a id="1585" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1590" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a>
  <a id="1598" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="1608" href="Meta.Deriving.Show.html#1608" class="Bound">x</a> <a id="1610" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>            <a id="1624" class="Symbol">=</a> <a id="1626" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="1631" href="Meta.Deriving.Show.html#1608" class="Bound">x</a> <a id="1633" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1635" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="1640" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="1650" href="Meta.Deriving.Show.html#1650" class="Bound">x</a> <a id="1652" class="Symbol">(</a><a id="1653" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="1658" href="Meta.Deriving.Show.html#1658" class="Bound">y</a> <a id="1660" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1662" href="Meta.Deriving.Show.html#1662" class="Bound">xs</a><a id="1664" class="Symbol">)</a> <a id="1666" class="Symbol">=</a> <a id="1668" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="1678" class="Symbol">(</a><a id="1679" href="Meta.Deriving.Show.html#1650" class="Bound">x</a> <a id="1681" href="Meta.Append.html#188" class="Field Operator">&lt;&gt;</a> <a id="1684" href="Meta.Deriving.Show.html#1658" class="Bound">y</a><a id="1685" class="Symbol">)</a> <a id="1687" href="Meta.Deriving.Show.html#1662" class="Bound">xs</a>
  <a id="1692" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="1702" href="Meta.Deriving.Show.html#1702" class="Bound">x</a> <a id="1704" class="Symbol">(</a><a id="1705" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="1710" href="Meta.Deriving.Show.html#1710" class="Bound">t</a> <a id="1712" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1714" href="Meta.Deriving.Show.html#1714" class="Bound">xs</a><a id="1716" class="Symbol">)</a> <a id="1718" class="Symbol">=</a> <a id="1720" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="1725" href="Meta.Deriving.Show.html#1702" class="Bound">x</a> <a id="1727" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1729" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="1734" href="Meta.Deriving.Show.html#1710" class="Bound">t</a> <a id="1736" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1738" href="Meta.Deriving.Show.html#1714" class="Bound">xs</a>

  <a id="1744" class="Comment">-- Reduce any adjacent &#39;lits&#39; the given list.</a>
  <a id="reduce-shown"></a><a id="1792" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="1805" class="Symbol">:</a> <a id="1807" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1812" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a> <a id="1818" class="Symbol">→</a> <a id="1820" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1825" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a>
  <a id="1833" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="1846" class="Symbol">(</a><a id="1847" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="1852" href="Meta.Deriving.Show.html#1852" class="Bound">x</a> <a id="1854" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1856" href="Meta.Deriving.Show.html#1856" class="Bound">xs</a><a id="1858" class="Symbol">)</a> <a id="1860" class="Symbol">=</a> <a id="1862" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="1872" href="Meta.Deriving.Show.html#1852" class="Bound">x</a> <a id="1874" class="Symbol">(</a><a id="1875" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="1888" href="Meta.Deriving.Show.html#1856" class="Bound">xs</a><a id="1890" class="Symbol">)</a>
  <a id="1894" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="1907" class="Symbol">(</a><a id="1908" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="1913" href="Meta.Deriving.Show.html#1913" class="Bound">t</a> <a id="1915" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1917" href="Meta.Deriving.Show.html#1917" class="Bound">xs</a><a id="1919" class="Symbol">)</a> <a id="1921" class="Symbol">=</a> <a id="1923" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="1928" href="Meta.Deriving.Show.html#1913" class="Bound">t</a> <a id="1930" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1932" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="1945" href="Meta.Deriving.Show.html#1917" class="Bound">xs</a>
  <a id="1950" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="1963" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>            <a id="1977" class="Symbol">=</a> <a id="1979" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="quote-prec"></a><a id="1985" href="Meta.Deriving.Show.html#1985" class="Function">quote-prec</a> <a id="1996" class="Symbol">:</a> <a id="1998" href="Agda.Builtin.Reflection.html#797" class="Datatype">Precedence</a> <a id="2009" class="Symbol">→</a> <a id="2011" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2018" href="Meta.Deriving.Show.html#1985" class="Function">quote-prec</a> <a id="2029" class="Symbol">(</a><a id="2030" href="Agda.Builtin.Reflection.html#822" class="InductiveConstructor">related</a> <a id="2038" href="Meta.Deriving.Show.html#2038" class="Bound">x</a><a id="2039" class="Symbol">)</a> <a id="2041" class="Symbol">=</a> <a id="2043" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="2046" href="Agda.Builtin.Reflection.html#822" class="InductiveConstructor">related</a> <a id="2054" href="Meta.Reflection.Base.html#15710" class="Function Operator">##ₙ</a> <a id="2058" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="2062" class="Symbol">(</a><a id="2063" href="Agda.Builtin.Reflection.html#4487" class="InductiveConstructor">float</a> <a id="2069" href="Meta.Deriving.Show.html#2038" class="Bound">x</a><a id="2070" class="Symbol">)</a>
  <a id="2074" href="Meta.Deriving.Show.html#1985" class="Function">quote-prec</a> <a id="2085" href="Agda.Builtin.Reflection.html#855" class="InductiveConstructor">unrelated</a>   <a id="2097" class="Symbol">=</a> <a id="2099" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="2102" href="Agda.Builtin.Reflection.html#855" class="InductiveConstructor">unrelated</a>

  <a id="2115" class="Comment">-- Given a list of name parts, and a list of terms standing for the</a>
  <a id="2185" class="Comment">-- arguments to that name, return a list of &#39;Shown&#39; values in which</a>
  <a id="2255" class="Comment">-- the arguments are properly interspersed the parts of the name.</a>
  <a id="zip-shown"></a><a id="2323" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2333" class="Symbol">:</a> <a id="2335" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2340" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a> <a id="2350" class="Symbol">→</a> <a id="2352" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2357" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2362" class="Symbol">→</a> <a id="2364" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2369" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a>
  <a id="2377" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2387" class="Symbol">(</a><a id="2388" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="2393" href="Meta.Deriving.Show.html#2393" class="Bound">p</a> <a id="2395" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2397" href="Meta.Deriving.Show.html#2397" class="Bound">ps</a><a id="2399" class="Symbol">)</a> <a id="2401" class="Symbol">(</a><a id="2402" href="Meta.Deriving.Show.html#2402" class="Bound">t</a> <a id="2404" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2406" href="Meta.Deriving.Show.html#2406" class="Bound">ts</a><a id="2408" class="Symbol">)</a> <a id="2410" class="Symbol">=</a>
    <a id="2416" class="Keyword">let</a> <a id="2420" href="Meta.Deriving.Show.html#2420" class="Bound">t</a> <a id="2422" class="Symbol">=</a> <a id="2424" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="2428" href="Meta.Show.html#791" class="Field">shows-prec</a> <a id="2439" class="Symbol">(</a><a id="2440" href="Meta.Deriving.Show.html#1985" class="Function">quote-prec</a> <a id="2451" href="Meta.Deriving.Show.html#2393" class="Bound">p</a><a id="2452" class="Symbol">)</a> <a id="2454" href="Meta.Deriving.Show.html#2402" class="Bound">t</a>
     <a id="2461" class="Keyword">in</a> <a id="2464" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="2469" href="Meta.Deriving.Show.html#2420" class="Bound">t</a> <a id="2471" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2473" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2483" href="Meta.Deriving.Show.html#2397" class="Bound">ps</a> <a id="2486" href="Meta.Deriving.Show.html#2406" class="Bound">ts</a>
  <a id="2491" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2501" class="Symbol">(</a><a id="2502" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="2507" href="Meta.Deriving.Show.html#2507" class="Bound">p</a> <a id="2509" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2511" href="Meta.Deriving.Show.html#2511" class="Bound">ps</a><a id="2513" class="Symbol">)</a> <a id="2515" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2518" class="Symbol">=</a> <a id="2520" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="2525" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2535" class="Symbol">(</a><a id="2536" href="Meta.Deriving.Show.html#780" class="InductiveConstructor">name</a> <a id="2541" href="Meta.Deriving.Show.html#2541" class="Bound">n</a> <a id="2543" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2545" href="Meta.Deriving.Show.html#2545" class="Bound">ps</a><a id="2547" class="Symbol">)</a> <a id="2549" href="Meta.Deriving.Show.html#2549" class="Bound">ts</a> <a id="2552" class="Symbol">=</a> <a id="2554" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="2564" href="Meta.Deriving.Show.html#2541" class="Bound">n</a> <a id="2566" class="Symbol">(</a><a id="2567" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2577" href="Meta.Deriving.Show.html#2545" class="Bound">ps</a> <a id="2580" href="Meta.Deriving.Show.html#2549" class="Bound">ts</a><a id="2582" class="Symbol">)</a>
  <a id="2586" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="2596" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>            <a id="2610" href="Meta.Deriving.Show.html#2610" class="Bound">ts</a> <a id="2613" class="Symbol">=</a> <a id="2615" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="2621" class="Comment">-- Given the precedence to be used for the context and for the</a>
  <a id="2686" class="Comment">-- arguments of the constructor under consideration, propagate the</a>
  <a id="2755" class="Comment">-- context&#39;s precedence to the hole which corresponds to the direction</a>
  <a id="2828" class="Comment">-- of associativity.</a>
  <a id="2851" class="Comment">--</a>
  <a id="2856" class="Comment">-- This ensures that e.g. `show (1 , 2 , 3)` will be `(1 , 2 , 3)`,</a>
  <a id="2926" class="Comment">-- rather than `(1 , (2 , 3))`, since the second argument of `_,_`</a>
  <a id="2995" class="Comment">-- will be rendered with the same precedence as the overall</a>
  <a id="3057" class="Comment">-- expression.</a>
  <a id="assoc-name-parts"></a><a id="3074" href="Meta.Deriving.Show.html#3074" class="Function">assoc-name-parts</a> <a id="3091" class="Symbol">:</a> <a id="3093" href="Agda.Builtin.Reflection.html#675" class="Datatype">Associativity</a> <a id="3107" class="Symbol">→</a> <a id="3109" href="Agda.Builtin.Reflection.html#797" class="Datatype">Precedence</a> <a id="3120" class="Symbol">→</a> <a id="3122" href="Agda.Builtin.Reflection.html#797" class="Datatype">Precedence</a> <a id="3133" class="Symbol">→</a> <a id="3135" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3140" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a> <a id="3150" class="Symbol">→</a> <a id="3152" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3157" href="Meta.Deriving.Show.html#669" class="Datatype">Name-part</a>
  <a id="3169" href="Meta.Deriving.Show.html#3074" class="Function">assoc-name-parts</a> <a id="3186" href="Agda.Builtin.Reflection.html#703" class="InductiveConstructor">left-assoc</a> <a id="3197" href="Meta.Deriving.Show.html#3197" class="Bound">thisp</a> <a id="3203" href="Meta.Deriving.Show.html#3203" class="Bound">argp</a> <a id="3208" class="Symbol">(</a><a id="3209" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3214" class="Symbol">_</a> <a id="3216" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3218" href="Meta.Deriving.Show.html#3218" class="Bound">p</a> <a id="3220" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3222" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3227" class="Symbol">_</a> <a id="3229" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3231" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3233" class="Symbol">)</a> <a id="3235" class="Symbol">=</a>
    <a id="3241" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3246" href="Meta.Deriving.Show.html#3197" class="Bound">thisp</a> <a id="3252" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3254" href="Meta.Deriving.Show.html#3218" class="Bound">p</a> <a id="3256" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3258" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3263" href="Meta.Deriving.Show.html#3203" class="Bound">argp</a> <a id="3268" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3270" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="3275" href="Meta.Deriving.Show.html#3074" class="Function">assoc-name-parts</a> <a id="3292" href="Agda.Builtin.Reflection.html#733" class="InductiveConstructor">right-assoc</a> <a id="3304" href="Meta.Deriving.Show.html#3304" class="Bound">thisp</a> <a id="3310" href="Meta.Deriving.Show.html#3310" class="Bound">argp</a> <a id="3315" class="Symbol">(</a><a id="3316" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3321" class="Symbol">_</a> <a id="3323" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3325" href="Meta.Deriving.Show.html#3325" class="Bound">p</a> <a id="3327" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3329" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3334" class="Symbol">_</a> <a id="3336" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3338" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3340" class="Symbol">)</a> <a id="3342" class="Symbol">=</a>
    <a id="3348" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3353" href="Meta.Deriving.Show.html#3310" class="Bound">argp</a> <a id="3358" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3360" href="Meta.Deriving.Show.html#3325" class="Bound">p</a> <a id="3362" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3364" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="3369" href="Meta.Deriving.Show.html#3304" class="Bound">thisp</a> <a id="3375" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3377" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="3382" href="Meta.Deriving.Show.html#3074" class="CatchallClause Function">assoc-name-parts</a><a id="3398" class="CatchallClause"> </a><a id="3399" href="Meta.Deriving.Show.html#3399" class="CatchallClause Bound">a</a><a id="3400" class="CatchallClause"> </a><a id="3401" href="Meta.Deriving.Show.html#3401" class="CatchallClause Bound">thisp</a><a id="3406" class="CatchallClause"> </a><a id="3407" href="Meta.Deriving.Show.html#3407" class="CatchallClause Bound">argp</a><a id="3411" class="CatchallClause"> </a><a id="3412" href="Meta.Deriving.Show.html#3412" class="CatchallClause Bound">ps</a> <a id="3415" class="Symbol">=</a> <a id="3417" href="Meta.Deriving.Show.html#3412" class="Bound">ps</a>

  <a id="3423" class="Comment">-- Convert a list of &#39;Shown&#39; values to the Term standing for their</a>
  <a id="3492" class="Comment">-- concatenation.</a>
  <a id="from-shown-list"></a><a id="3512" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3528" class="Symbol">:</a> <a id="3530" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3535" href="Meta.Deriving.Show.html#1415" class="Datatype">Shown</a> <a id="3541" class="Symbol">→</a> <a id="3543" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="3550" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3566" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>                <a id="3584" class="Symbol">=</a> <a id="3586" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="3589" href="Meta.Append.html#173" class="Field">mempty</a>
  <a id="3598" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3614" class="Symbol">(</a><a id="3615" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="3620" href="Meta.Deriving.Show.html#3620" class="Bound">x</a> <a id="3622" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3624" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3626" class="Symbol">)</a>     <a id="3632" class="Symbol">=</a> <a id="3634" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="3638" href="Agda.Builtin.FromString.html#292" class="Field">from-string</a> <a id="3650" class="Symbol">(</a><a id="3651" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="3655" class="Symbol">(</a><a id="3656" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="3663" href="Meta.Deriving.Show.html#3620" class="Bound">x</a><a id="3664" class="Symbol">))</a>
  <a id="3669" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3685" class="Symbol">(</a><a id="3686" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="3691" href="Meta.Deriving.Show.html#3691" class="Bound">x</a> <a id="3693" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3695" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3697" class="Symbol">)</a>     <a id="3703" class="Symbol">=</a> <a id="3705" href="Meta.Deriving.Show.html#3691" class="Bound">x</a>
  <a id="3709" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3725" class="Symbol">(</a><a id="3726" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="3731" href="Meta.Deriving.Show.html#3731" class="Bound">x</a> <a id="3733" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3735" href="Meta.Deriving.Show.html#3735" class="Bound">y</a> <a id="3737" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3739" href="Meta.Deriving.Show.html#3739" class="Bound">xs</a><a id="3741" class="Symbol">)</a> <a id="3743" class="Symbol">=</a> <a id="3745" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="3749" href="Meta.Append.html#188" class="Field Operator">_&lt;&gt;_</a>
    <a id="3758" class="Symbol">(</a><a id="3759" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="3763" href="Agda.Builtin.FromString.html#292" class="Field">from-string</a> <a id="3775" class="Symbol">(</a><a id="3776" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="3780" class="Symbol">(</a><a id="3781" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="3788" href="Meta.Deriving.Show.html#3731" class="Bound">x</a><a id="3789" class="Symbol">)))</a>
    <a id="3797" class="Symbol">(</a><a id="3798" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3814" class="Symbol">(</a><a id="3815" href="Meta.Deriving.Show.html#3735" class="Bound">y</a> <a id="3817" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3819" href="Meta.Deriving.Show.html#3739" class="Bound">xs</a><a id="3821" class="Symbol">))</a>
  <a id="3826" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3842" class="Symbol">(</a><a id="3843" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="3848" href="Meta.Deriving.Show.html#3848" class="Bound">x</a> <a id="3850" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3852" href="Meta.Deriving.Show.html#3852" class="Bound">y</a> <a id="3854" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3856" href="Meta.Deriving.Show.html#3856" class="Bound">xs</a><a id="3858" class="Symbol">)</a> <a id="3860" class="Symbol">=</a> <a id="3862" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="3866" href="Meta.Append.html#188" class="Field Operator">_&lt;&gt;_</a> <a id="3871" href="Meta.Deriving.Show.html#3848" class="Bound">x</a> <a id="3873" class="Symbol">(</a><a id="3874" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="3890" class="Symbol">(</a><a id="3891" href="Meta.Deriving.Show.html#3852" class="Bound">y</a> <a id="3893" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3895" href="Meta.Deriving.Show.html#3856" class="Bound">xs</a><a id="3897" class="Symbol">))</a>

  <a id="3903" class="Comment">-- Create the clause of shows-prec for a constructor.</a>
  <a id="show-clause"></a><a id="3959" href="Meta.Deriving.Show.html#3959" class="Function">show-clause</a> <a id="3971" class="Symbol">:</a> <a id="3973" href="Meta.Reflection.Signature.html#1324" class="Record">Constructor</a> <a id="3985" class="Symbol">→</a> <a id="3987" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3990" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a>
  <a id="3999" href="Meta.Deriving.Show.html#3959" class="Function">show-clause</a> <a id="4011" class="Symbol">(</a><a id="4012" href="Meta.Reflection.Signature.html#1363" class="InductiveConstructor">conhead</a> <a id="4020" href="Meta.Deriving.Show.html#4020" class="Bound">conm</a> <a id="4025" class="Symbol">_</a> <a id="4027" href="Meta.Deriving.Show.html#4027" class="Bound">args</a> <a id="4032" class="Symbol">_)</a> <a id="4035" class="Symbol">=</a> <a id="4037" class="Keyword">do</a>
    <a id="4044" class="Keyword">let</a>
      <a id="4054" class="Comment">-- We&#39;ll only show the visible arguments to the constructor.</a>
      <a id="4121" class="Comment">-- Moreover, since Agda can infer the types in the telescope</a>
      <a id="4188" class="Comment">-- better than we can specify them here, we replace everything</a>
      <a id="4257" class="Comment">-- with `unknown`.</a>
      <a id="4282" href="Meta.Deriving.Show.html#4282" class="Bound">tele</a> <a id="4287" class="Symbol">:</a> <a id="4289" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4294" class="Symbol">(</a><a id="4295" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4302" href="Foundations.Sigma.Base.html#621" class="Function Operator">×</a> <a id="4304" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4308" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="4312" class="Symbol">)</a>
      <a id="4320" href="Meta.Deriving.Show.html#4282" class="Bound">tele</a> <a id="4325" class="Symbol">=</a> <a id="4327" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="4331" class="Symbol">(</a><a id="4332" href="Foundations.Sigma.Base.html#1362" class="Function">second</a> <a id="4339" class="Symbol">(</a><a id="4340" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="4344" class="Symbol">λ</a> <a id="4346" href="Meta.Deriving.Show.html#4346" class="Bound">_</a> <a id="4348" class="Symbol">→</a> <a id="4350" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a><a id="4357" class="Symbol">))</a> <a id="4360" href="Foundations.Pi.Base.html#1597" class="Function Operator">$</a>
        <a id="4370" href="Data.List.Operations.html#722" class="Function">filter</a> <a id="4377" class="Symbol">(λ</a> <a id="4380" class="Symbol">{</a> <a id="4382" class="Symbol">(_</a> <a id="4385" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4387" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="4391" class="Symbol">(</a><a id="4392" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="4401" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="4409" class="Symbol">_)</a> <a id="4412" class="Symbol">_)</a> <a id="4415" class="Symbol">→</a> <a id="4417" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
                  <a id="4440" class="Symbol">;</a> <a id="4442" class="CatchallClause Symbol">_</a> <a id="4444" class="Symbol">→</a> <a id="4446" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
                  <a id="4470" class="Symbol">})</a>
         <a id="4482" href="Meta.Deriving.Show.html#4027" class="Bound">args</a>
      <a id="4493" href="Meta.Deriving.Show.html#4493" class="Bound">ixs</a>  <a id="4498" class="Symbol">=</a> <a id="4500" href="Data.List.Base.html#924" class="Function">reverse-fast</a> <a id="4513" class="Symbol">(</a><a id="4514" href="Data.List.Operations.html#2392" class="Function">map-up</a> <a id="4521" class="Symbol">(λ</a> <a id="4524" href="Meta.Deriving.Show.html#4524" class="Bound">i</a> <a id="4526" href="Meta.Deriving.Show.html#4526" class="Bound">_</a> <a id="4528" class="Symbol">→</a> <a id="4530" href="Meta.Deriving.Show.html#4524" class="Bound">i</a><a id="4531" class="Symbol">)</a> <a id="4533" class="Number">0</a> <a id="4535" href="Meta.Deriving.Show.html#4282" class="Bound">tele</a><a id="4539" class="Symbol">)</a>

    <a id="4546" class="Comment">-- The constructor should be rendered as a concrete name in scope,</a>
    <a id="4617" class="Comment">-- rather than a fully-qualified name.</a>
    <a id="4660" href="Meta.Deriving.Show.html#4660" class="Bound">con-str</a> <a id="4668" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="4670" href="Meta.Reflection.Signature.html#6419" class="Function">render-name</a> <a id="4682" href="Meta.Deriving.Show.html#4020" class="Bound">conm</a>

    <a id="4692" href="Agda.Builtin.Reflection.html#905" class="InductiveConstructor">fixity</a> <a id="4699" href="Meta.Deriving.Show.html#4699" class="Bound">thisa</a> <a id="4705" href="Meta.Deriving.Show.html#4705" class="Bound">thisp</a> <a id="4711" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="4713" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="4718" href="Foundations.Pi.Base.html#1597" class="Function Operator">$</a> <a id="4720" href="Agda.Builtin.Reflection.html#2339" class="Primitive">name→fixity</a> <a id="4732" href="Meta.Deriving.Show.html#4020" class="Bound">conm</a>
    <a id="4741" class="Keyword">let</a> <a id="4745" href="Meta.Deriving.Show.html#4745" class="Bound">argp</a> <a id="4750" class="Symbol">=</a> <a id="4752" href="Meta.Reflection.Base.html#3273" class="Function">suc-precedence</a> <a id="4767" href="Meta.Deriving.Show.html#4705" class="Bound">thisp</a>

    <a id="4778" class="Keyword">let</a>
      <a id="4788" href="Meta.Deriving.Show.html#4788" class="Bound">shown₀</a> <a id="4795" class="Symbol">=</a> <a id="4797" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="4801" class="Symbol">(</a><a id="4802" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="4806" href="Meta.Show.html#791" class="Field">shows-prec</a> <a id="4817" class="Symbol">(</a><a id="4818" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="4821" href="Agda.Builtin.Reflection.html#855" class="InductiveConstructor">unrelated</a><a id="4830" class="Symbol">)</a> <a id="4832" href="Foundations.Pi.Base.html#1871" class="Function Operator">∘</a> <a id="4834" href="Meta.Reflection.Base.html#17026" class="InductiveConstructor">var₀</a><a id="4838" class="Symbol">)</a> <a id="4840" href="Meta.Deriving.Show.html#4493" class="Bound">ixs</a>
      <a id="4850" href="Meta.Deriving.Show.html#4850" class="Bound">parts</a>  <a id="4857" class="Symbol">=</a> <a id="4859" href="Meta.Deriving.Show.html#3074" class="Function">assoc-name-parts</a> <a id="4876" href="Meta.Deriving.Show.html#4699" class="Bound">thisa</a> <a id="4882" href="Meta.Deriving.Show.html#4705" class="Bound">thisp</a> <a id="4888" href="Meta.Deriving.Show.html#4745" class="Bound">argp</a> <a id="4893" class="Symbol">(</a><a id="4894" href="Meta.Deriving.Show.html#855" class="Function">name→parts</a> <a id="4905" href="Meta.Deriving.Show.html#4660" class="Bound">con-str</a><a id="4912" class="Symbol">)</a>

      <a id="4921" href="Meta.Deriving.Show.html#4921" class="Bound">holes</a>  <a id="4928" class="Symbol">=</a> <a id="4930" href="Data.List.Operations.html#554" class="Function">length</a> <a id="4937" class="Symbol">(</a><a id="4938" href="Data.List.Operations.html#722" class="Function">filter</a> <a id="4945" class="Symbol">(λ</a> <a id="4948" class="Symbol">{</a> <a id="4950" class="Symbol">(</a><a id="4951" href="Meta.Deriving.Show.html#718" class="InductiveConstructor">hole</a> <a id="4956" class="Symbol">_)</a> <a id="4959" class="Symbol">→</a> <a id="4961" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="4966" class="Symbol">;</a> <a id="4968" class="CatchallClause Symbol">_</a> <a id="4970" class="Symbol">→</a> <a id="4972" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4978" class="Symbol">})</a> <a id="4981" href="Meta.Deriving.Show.html#4850" class="Bound">parts</a><a id="4986" class="Symbol">)</a>

      <a id="4995" class="Comment">-- The strategy for the generated clause is as follows: if we have</a>
      <a id="5068" class="Comment">-- a mixfix name with as many holes as the constructor has visible</a>
      <a id="5141" class="Comment">-- arguments, then we&#39;ll show the constructor infix, using</a>
      <a id="5206" class="Comment">-- `zip-shown` above. Otherwise, we&#39;ll display it prefix.</a>

      <a id="5271" href="Meta.Deriving.Show.html#5271" class="Bound">shown</a> <a id="5277" class="Symbol">=</a>
        <a id="5287" href="Data.Bool.Base.html#709" class="Function Operator">if</a> <a id="5290" href="Meta.Deriving.Show.html#4921" class="Bound">holes</a> <a id="5296" href="Agda.Builtin.Nat.html#631" class="Primitive Operator">==</a> <a id="5299" href="Data.List.Operations.html#554" class="Function">length</a> <a id="5306" href="Meta.Deriving.Show.html#4788" class="Bound">shown₀</a>
          <a id="5323" href="Data.Bool.Base.html#709" class="Function Operator">then</a> <a id="5328" href="Meta.Deriving.Show.html#2323" class="Function">zip-shown</a> <a id="5338" href="Meta.Deriving.Show.html#4850" class="Bound">parts</a> <a id="5344" class="Symbol">(</a><a id="5345" href="Meta.Reflection.Base.html#17026" class="InductiveConstructor">var₀</a> <a id="5350" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a> <a id="5354" href="Meta.Deriving.Show.html#4493" class="Bound">ixs</a><a id="5357" class="Symbol">)</a>
          <a id="5369" href="Data.Bool.Base.html#709" class="Function Operator">else</a> <a id="5374" href="Meta.Deriving.Show.html#1551" class="Function">cons-lits</a> <a id="5384" href="Meta.Deriving.Show.html#4660" class="Bound">con-str</a> <a id="5392" class="Symbol">(</a><a id="5393" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="5397" href="Meta.Deriving.Show.html#1464" class="InductiveConstructor">term</a> <a id="5402" href="Meta.Deriving.Show.html#4788" class="Bound">shown₀</a><a id="5408" class="Symbol">)</a>

      <a id="5417" href="Meta.Deriving.Show.html#5417" class="Bound">inner</a> <a id="5423" class="Symbol">=</a> <a id="5425" href="Meta.Deriving.Show.html#3512" class="Function">from-shown-list</a> <a id="5441" class="Symbol">(</a><a id="5442" href="Meta.Deriving.Show.html#1792" class="Function">reduce-shown</a> <a id="5455" class="Symbol">(</a><a id="5456" href="Data.List.Base.html#1139" class="Function">intercalate</a> <a id="5468" class="Symbol">(</a><a id="5469" href="Meta.Deriving.Show.html#1438" class="InductiveConstructor">lits</a> <a id="5474" class="String">&quot; &quot;</a><a id="5477" class="Symbol">)</a> <a id="5479" href="Meta.Deriving.Show.html#5271" class="Bound">shown</a><a id="5484" class="Symbol">))</a>

      <a id="5494" class="Comment">-- But that&#39;s not the complete clause: we must also wrap the shown</a>
      <a id="5567" class="Comment">-- value in parentheses, according to the precedence of the</a>
      <a id="5633" class="Comment">-- context, *unless* the constructor is nullary. Parentheses are</a>
      <a id="5704" class="Comment">-- shown if the precedence of the context is greater than the</a>
      <a id="5772" class="Comment">-- precedence of the constructor name, as returned by name→fixity.</a>

      <a id="5846" href="Meta.Deriving.Show.html#5846" class="Bound">guard</a> <a id="5852" class="Symbol">=</a> <a id="5854" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="5858" href="Meta.Reflection.Base.html#3408" class="Function">prec-parens</a> <a id="5870" class="Symbol">(</a><a id="5871" href="Meta.Reflection.Base.html#17026" class="InductiveConstructor">var₀</a> <a id="5876" class="Symbol">(</a><a id="5877" href="Data.List.Operations.html#554" class="Function">length</a> <a id="5884" href="Meta.Deriving.Show.html#4282" class="Bound">tele</a><a id="5888" class="Symbol">))</a> <a id="5891" class="Symbol">(</a><a id="5892" href="Meta.Deriving.Show.html#1985" class="Function">quote-prec</a> <a id="5903" href="Meta.Deriving.Show.html#4705" class="Bound">thisp</a><a id="5908" class="Symbol">)</a>

      <a id="5917" href="Meta.Deriving.Show.html#5917" class="Bound">tm</a> <a id="5920" class="Symbol">=</a> <a id="5922" href="Foundations.Pi.Base.html#2277" class="Function Operator">case</a> <a id="5927" href="Meta.Deriving.Show.html#4788" class="Bound">shown₀</a> <a id="5934" href="Foundations.Pi.Base.html#2277" class="Function Operator">of</a> <a id="5937" class="Symbol">λ</a> <a id="5939" class="Keyword">where</a>
        <a id="5953" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5956" class="Symbol">→</a> <a id="5958" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="5962" href="Agda.Builtin.FromString.html#292" class="Field">from-string</a> <a id="5974" class="Symbol">(</a><a id="5975" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="5979" class="Symbol">(</a><a id="5980" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="5987" href="Meta.Deriving.Show.html#4660" class="Bound">con-str</a><a id="5994" class="Symbol">))</a>
        <a id="6005" class="CatchallClause Symbol">_</a>  <a id="6008" class="Symbol">→</a> <a id="6010" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="6014" href="Meta.Show.html#1068" class="Function">show-parens</a> <a id="6026" href="Meta.Deriving.Show.html#5846" class="Bound">guard</a> <a id="6032" href="Meta.Deriving.Show.html#5417" class="Bound">inner</a>

    <a id="6043" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="6048" href="Foundations.Pi.Base.html#1597" class="Function Operator">$</a>
      <a id="6056" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="6063" class="Symbol">((</a><a id="6065" class="String">&quot;prec&quot;</a> <a id="6072" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6074" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="6079" class="Symbol">(</a><a id="6080" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="6083" href="Agda.Builtin.Reflection.html#797" class="Datatype">Precedence</a><a id="6093" class="Symbol">))</a> <a id="6096" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6098" href="Meta.Deriving.Show.html#4282" class="Bound">tele</a><a id="6102" class="Symbol">)</a>
        <a id="6112" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="6114" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="6119" class="Symbol">(</a><a id="6120" class="InductiveConstructor">var</a> <a id="6124" class="Symbol">(</a><a id="6125" href="Data.List.Operations.html#554" class="Function">length</a> <a id="6132" href="Meta.Deriving.Show.html#4282" class="Bound">tele</a><a id="6136" class="Symbol">))</a>
        <a id="6147" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6149" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="6154" class="Symbol">(</a><a id="6155" class="InductiveConstructor">con</a> <a id="6159" href="Meta.Deriving.Show.html#4020" class="Bound">conm</a> <a id="6164" class="Symbol">(</a><a id="6165" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="6169" class="Symbol">(</a><a id="6170" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="6175" href="Foundations.Pi.Base.html#1871" class="Function Operator">∘</a> <a id="6177" class="InductiveConstructor">var</a><a id="6180" class="Symbol">)</a> <a id="6182" href="Meta.Deriving.Show.html#4493" class="Bound">ixs</a><a id="6185" class="Symbol">))</a>
        <a id="6196" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>
        <a id="6206" href="Meta.Deriving.Show.html#5917" class="Bound">tm</a>

<a id="6210" class="Comment">-- Derives an instance of &#39;Show&#39; for a datatype or record. This function</a>
<a id="6283" class="Comment">-- works whether or not the instance has previously been defined.</a>

<a id="derive-show"></a><a id="6350" href="Meta.Deriving.Show.html#6350" class="Function">derive-show</a> <a id="6362" class="Symbol">:</a> <a id="6364" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6369" class="Symbol">→</a> <a id="6371" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6376" class="Symbol">→</a> <a id="6378" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="6381" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="6383" href="Meta.Deriving.Show.html#6350" class="Function">derive-show</a> <a id="6395" href="Meta.Deriving.Show.html#6395" class="Bound">nm</a> <a id="6398" href="Meta.Deriving.Show.html#6398" class="Bound">dat</a> <a id="6402" class="Symbol">=</a> <a id="6404" class="Keyword">do</a>
  <a id="6409" href="Meta.Reflection.Signature.html#6057" class="Function">is-defined</a> <a id="6420" href="Meta.Deriving.Show.html#6395" class="Bound">nm</a> <a id="6423" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="6427" class="Symbol">λ</a> <a id="6429" class="Keyword">where</a>
    <a id="6439" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6445" class="Symbol">→</a> <a id="6447" href="Agda.Builtin.Reflection.html#9453" class="Postulate">declare-def</a> <a id="6459" class="Symbol">(</a><a id="6460" href="Meta.Reflection.Base.html#5133" class="Function">argI</a> <a id="6465" href="Meta.Deriving.Show.html#6395" class="Bound">nm</a><a id="6467" class="Symbol">)</a> <a id="6469" href="Meta.Effect.Bind.html#393" class="Function Operator">=&lt;&lt;</a> <a id="6473" href="Meta.Reflection.Signature.html#9748" class="Function">instance-type</a> <a id="6487" class="Symbol">(</a><a id="6488" class="Keyword">quote</a> <a id="6494" href="Meta.Show.html#742" class="Record">Show</a><a id="6498" class="Symbol">)</a> <a id="6500" href="Meta.Deriving.Show.html#6398" class="Bound">dat</a>
    <a id="6508" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>  <a id="6514" class="Symbol">→</a> <a id="6516" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="6521" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

  <a id="6527" href="Meta.Deriving.Show.html#6527" class="Bound">cons</a> <a id="6532" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="6534" href="Meta.Reflection.Signature.html#1958" class="Function">get-type-constructors</a> <a id="6556" href="Meta.Deriving.Show.html#6398" class="Bound">dat</a>
  <a id="6562" class="Symbol">(</a><a id="6563" href="Meta.Deriving.Show.html#6563" class="Bound">tel</a> <a id="6567" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6569" href="Meta.Deriving.Show.html#6569" class="Bound">as</a><a id="6571" class="Symbol">)</a> <a id="6573" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="6575" href="Meta.Reflection.Signature.html#9461" class="Function">instance-telescope</a> <a id="6594" class="Symbol">(</a><a id="6595" class="Keyword">quote</a> <a id="6601" href="Meta.Show.html#742" class="Record">Show</a><a id="6605" class="Symbol">)</a> <a id="6607" href="Meta.Deriving.Show.html#6398" class="Bound">dat</a>
  <a id="6613" class="Keyword">let</a> <a id="6617" href="Meta.Deriving.Show.html#6617" class="Bound">ty</a> <a id="6620" class="Symbol">=</a> <a id="6622" href="Meta.Reflection.Base.html#8537" class="Function">unpi-view</a> <a id="6632" href="Meta.Deriving.Show.html#6563" class="Bound">tel</a> <a id="6636" href="Foundations.Pi.Base.html#1597" class="Function Operator">$</a> <a id="6638" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="6642" href="Meta.Reflection.Base.html#3630" class="Function">Fun</a> <a id="6646" class="Symbol">(</a><a id="6647" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="6650" href="Agda.Builtin.Reflection.html#797" class="Datatype">Precedence</a><a id="6660" class="Symbol">)</a> <a id="6662" class="Symbol">(</a><a id="6663" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="6667" href="Meta.Reflection.Base.html#3630" class="Function">Fun</a> <a id="6671" class="Symbol">(</a><a id="6672" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6676" href="Meta.Deriving.Show.html#6398" class="Bound">dat</a> <a id="6680" href="Meta.Deriving.Show.html#6569" class="Bound">as</a><a id="6682" class="Symbol">)</a> <a id="6684" class="Symbol">(</a><a id="6685" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="6688" href="Meta.Show.html#349" class="Record">ShowS</a><a id="6693" class="Symbol">))</a>
  <a id="6698" href="Meta.Deriving.Show.html#6698" class="Bound">work</a> <a id="6703" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="6705" href="Meta.Reflection.Signature.html#7369" class="Function">helper-function</a> <a id="6721" href="Meta.Deriving.Show.html#6395" class="Bound">nm</a> <a id="6724" class="String">&quot;go&quot;</a> <a id="6729" href="Meta.Deriving.Show.html#6617" class="Bound">ty</a> <a id="6732" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="6738" href="Agda.Builtin.Reflection.html#9649" class="Postulate">define-function</a> <a id="6754" href="Meta.Deriving.Show.html#6395" class="Bound">nm</a> <a id="6757" href="Foundations.Pi.Base.html#1597" class="Function Operator">$</a>
    <a id="6763" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="6765" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="6772" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6775" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6778" class="Symbol">(</a><a id="6779" href="Meta.Reflection.Signature.html#5024" class="Macro">`constructor</a> <a id="6792" href="Meta.Show.html#742" class="Record">Show</a>
      <a id="6803" href="Meta.Reflection.Base.html#15710" class="Function Operator">##ₙ</a> <a id="6807" href="Meta.Reflection.Base.html#17000" class="InductiveConstructor">def₀</a> <a id="6812" href="Meta.Deriving.Show.html#6698" class="Bound">work</a>
      <a id="6823" href="Meta.Reflection.Base.html#15710" class="Function Operator">##ₙ</a> <a id="6827" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="6831" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="6839" class="Symbol">(</a><a id="6840" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="6844" class="String">&quot;x&quot;</a>
        <a id="6856" class="Symbol">(</a><a id="6857" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="6861" href="Meta.Show.html#396" class="Field">ShowS.unshowS</a>
          <a id="6885" class="Symbol">(</a><a id="6886" href="Meta.Reflection.Base.html#17000" class="InductiveConstructor">def₀</a> <a id="6891" href="Meta.Deriving.Show.html#6698" class="Bound">work</a> <a id="6896" href="Meta.Reflection.Base.html#15710" class="Function Operator">##ₙ</a> <a id="6900" href="Meta.Deriving.Show.html#1985" class="Function">quote-prec</a> <a id="6911" class="Symbol">(</a><a id="6912" href="Agda.Builtin.Reflection.html#822" class="InductiveConstructor">related</a> <a id="6920" class="Number">0</a><a id="6921" class="Symbol">)</a> <a id="6923" href="Meta.Reflection.Base.html#15710" class="Function Operator">##ₙ</a> <a id="6927" href="Meta.Reflection.Base.html#17026" class="InductiveConstructor">var₀</a> <a id="6932" class="Number">0</a><a id="6933" class="Symbol">)</a>
          <a id="6945" class="Symbol">(</a><a id="6946" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="6950" class="Symbol">(</a><a id="6951" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="6958" class="String">&quot;&quot;</a><a id="6960" class="Symbol">)))))</a>
    <a id="6970" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>

  <a id="6975" href="Agda.Builtin.Reflection.html#9649" class="Postulate">define-function</a> <a id="6991" href="Meta.Deriving.Show.html#6698" class="Bound">work</a> <a id="6996" href="Meta.Effect.Bind.html#393" class="Function Operator">=&lt;&lt;</a> <a id="7000" href="Meta.Effect.Traversable.html#293" class="Field">traverse</a> <a id="7009" href="Meta.Deriving.Show.html#3959" class="Function">show-clause</a> <a id="7021" href="Meta.Deriving.Show.html#6527" class="Bound">cons</a>


<a id="7028" class="Keyword">instance</a> <a id="7037" class="Keyword">unquoteDecl</a> <a id="Show-Σ"></a><a id="7049" href="Meta.Deriving.Show.html#7049" class="Function">Show-Σ</a> <a id="7056" class="Symbol">=</a> <a id="7058" href="Meta.Deriving.Show.html#6350" class="Function">derive-show</a> <a id="7070" href="Meta.Deriving.Show.html#7049" class="Function">Show-Σ</a> <a id="7077" class="Symbol">(</a><a id="7078" class="Keyword">quote</a> <a id="7084" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="7085" class="Symbol">)</a>
</pre></body></html>