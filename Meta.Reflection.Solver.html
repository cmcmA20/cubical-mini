<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Reflection.Solver</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Reflection.Solver.html" class="Module">Meta.Reflection.Solver</a> <a id="54" class="Keyword">where</a>

<a id="61" class="Keyword">open</a> <a id="66" class="Keyword">import</a> <a id="73" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="118" class="Keyword">open</a> <a id="123" class="Keyword">import</a> <a id="130" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>
<a id="173" class="Keyword">open</a> <a id="178" class="Keyword">import</a> <a id="185" href="Data.String.Instances.IsString.html" class="Module">Data.String.Instances.IsString</a>

<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Meta.Reflection.Base.html" class="Module">Meta.Reflection.Base</a>
<a id="250" class="Keyword">open</a> <a id="255" class="Keyword">import</a> <a id="262" href="Meta.Reflection.Variables.html" class="Module">Meta.Reflection.Variables</a>

<a id="289" class="Keyword">private</a> <a id="297" class="Keyword">variable</a>
  <a id="308" href="Meta.Reflection.Solver.html#308" class="Generalizable">ℓ</a> <a id="310" class="Symbol">:</a> <a id="312" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="320" href="Meta.Reflection.Solver.html#320" class="Generalizable">A</a> <a id="322" class="Symbol">:</a> <a id="324" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="329" href="Meta.Reflection.Solver.html#308" class="Generalizable">ℓ</a>

<a id="332" class="Comment">--------------------------------------------------------------------------------</a>
<a id="413" class="Comment">-- Helpers</a>

<a id="solver-failed"></a><a id="425" href="Meta.Reflection.Solver.html#425" class="Function">solver-failed</a> <a id="439" class="Symbol">:</a> <a id="441" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="446" class="Symbol">→</a> <a id="448" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="453" class="Symbol">→</a> <a id="455" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="458" href="Meta.Reflection.Solver.html#320" class="Generalizable">A</a>
<a id="460" href="Meta.Reflection.Solver.html#425" class="Function">solver-failed</a> <a id="474" href="Meta.Reflection.Solver.html#474" class="Bound">lhs</a> <a id="478" href="Meta.Reflection.Solver.html#478" class="Bound">rhs</a> <a id="482" class="Symbol">=</a>
    <a id="488" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="498" class="Symbol">(</a><a id="499" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="506" class="String">&quot;Could not equate the following expressions:\n  &quot;</a> <a id="556" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="575" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="583" href="Meta.Reflection.Solver.html#474" class="Bound">lhs</a> <a id="587" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
               <a id="604" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="611" class="String">&quot;\nAnd\n  &quot;</a> <a id="623" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="642" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="650" href="Meta.Reflection.Solver.html#478" class="Bound">rhs</a> <a id="654" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="656" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="658" class="Symbol">)</a>

<a id="print-repr"></a><a id="661" href="Meta.Reflection.Solver.html#661" class="Function">print-repr</a> <a id="672" class="Symbol">:</a> <a id="674" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="679" class="Symbol">→</a> <a id="681" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="686" class="Symbol">→</a> <a id="688" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="691" href="Meta.Reflection.Solver.html#320" class="Generalizable">A</a>
<a id="693" href="Meta.Reflection.Solver.html#661" class="Function">print-repr</a> <a id="704" href="Meta.Reflection.Solver.html#704" class="Bound">tm</a> <a id="707" href="Meta.Reflection.Solver.html#707" class="Bound">repr</a> <a id="712" class="Symbol">=</a>
  <a id="716" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="726" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="728" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="735" class="String">&quot;The expression\n  &quot;</a> <a id="756" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="774" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="782" href="Meta.Reflection.Solver.html#704" class="Bound">tm</a> <a id="785" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
              <a id="801" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="808" class="String">&quot;\nIs represented by the expression\n  &quot;</a> <a id="849" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="867" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="875" href="Meta.Reflection.Solver.html#707" class="Bound">repr</a> <a id="880" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="882" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="print-var-repr"></a><a id="886" href="Meta.Reflection.Solver.html#886" class="Function">print-var-repr</a> <a id="901" class="Symbol">:</a> <a id="903" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="908" class="Symbol">→</a> <a id="910" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="915" class="Symbol">→</a> <a id="917" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="922" class="Symbol">→</a> <a id="924" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="927" href="Meta.Reflection.Solver.html#320" class="Generalizable">A</a>
<a id="929" href="Meta.Reflection.Solver.html#886" class="Function">print-var-repr</a> <a id="944" href="Meta.Reflection.Solver.html#944" class="Bound">tm</a> <a id="947" href="Meta.Reflection.Solver.html#947" class="Bound">repr</a> <a id="952" href="Meta.Reflection.Solver.html#952" class="Bound">env</a> <a id="956" class="Symbol">=</a>
  <a id="960" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="970" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="972" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="979" class="String">&quot;The expression\n  &quot;</a> <a id="1000" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="1018" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1026" href="Meta.Reflection.Solver.html#944" class="Bound">tm</a> <a id="1029" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
              <a id="1045" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="1052" class="String">&quot;\nIs represented by the expression\n  &quot;</a> <a id="1093" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="1111" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1119" href="Meta.Reflection.Solver.html#947" class="Bound">repr</a> <a id="1124" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
              <a id="1140" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="1147" class="String">&quot;\nIn the environment\n  &quot;</a> <a id="1174" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                <a id="1192" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1200" href="Meta.Reflection.Solver.html#952" class="Bound">env</a> <a id="1204" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1206" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="1210" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1291" class="Comment">-- Simple Solvers</a>

<a id="1310" class="Keyword">record</a> <a id="SimpleSolver"></a><a id="1317" href="Meta.Reflection.Solver.html#1317" class="Record">SimpleSolver</a> <a id="1330" class="Symbol">:</a> <a id="1332" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1337" class="Keyword">where</a>
  <a id="1345" class="Keyword">constructor</a> <a id="simple-solver"></a><a id="1357" href="Meta.Reflection.Solver.html#1357" class="InductiveConstructor">simple-solver</a>
  <a id="1373" class="Keyword">field</a>
    <a id="SimpleSolver.dont-reduce"></a><a id="1383" href="Meta.Reflection.Solver.html#1383" class="Field">dont-reduce</a> <a id="1395" class="Symbol">:</a> <a id="1397" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1402" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="SimpleSolver.build-expr"></a><a id="1411" href="Meta.Reflection.Solver.html#1411" class="Field">build-expr</a> <a id="1422" class="Symbol">:</a> <a id="1424" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="1434" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>
    <a id="SimpleSolver.invoke-solver"></a><a id="1443" href="Meta.Reflection.Solver.html#1443" class="Field">invoke-solver</a> <a id="1457" class="Symbol">:</a> <a id="1459" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1471" class="Symbol">→</a> <a id="1473" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>
    <a id="SimpleSolver.invoke-normaliser"></a><a id="1482" href="Meta.Reflection.Solver.html#1482" class="Field">invoke-normaliser</a> <a id="1500" class="Symbol">:</a> <a id="1502" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1507" class="Symbol">→</a> <a id="1509" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>

<a id="1515" class="Keyword">module</a> <a id="1522" href="Meta.Reflection.Solver.html#1522" class="Module">_</a> <a id="1524" class="Symbol">(</a><a id="1525" href="Meta.Reflection.Solver.html#1525" class="Bound">solver</a> <a id="1532" class="Symbol">:</a> <a id="1534" href="Meta.Reflection.Solver.html#1317" class="Record">SimpleSolver</a><a id="1546" class="Symbol">)</a> <a id="1548" class="Keyword">where</a>
  <a id="1556" class="Keyword">open</a> <a id="1561" href="Meta.Reflection.Solver.html#1317" class="Module">SimpleSolver</a> <a id="1574" href="Meta.Reflection.Solver.html#1525" class="Bound">solver</a>

  <a id="1584" href="Meta.Reflection.Solver.html#1584" class="Function">mk-simple-solver</a> <a id="1601" class="Symbol">:</a> <a id="1603" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="1608" class="Symbol">→</a> <a id="1610" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="1613" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1617" href="Meta.Reflection.Solver.html#1584" class="Function">mk-simple-solver</a> <a id="1634" href="Meta.Reflection.Solver.html#1634" class="Bound">hole</a> <a id="1639" class="Symbol">=</a>
    <a id="1645" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="1663" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1669" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="1675" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="1690" class="Symbol">(</a><a id="1691" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1697" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1699" href="Meta.Reflection.Solver.html#1383" class="Field">dont-reduce</a><a id="1710" class="Symbol">)</a> <a id="1712" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="1714" class="Keyword">do</a>
    <a id="1721" href="Meta.Reflection.Solver.html#1721" class="Bound">goal</a> <a id="1726" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1728" href="Agda.Builtin.Reflection.html#8572" class="Postulate">inferType</a> <a id="1738" href="Meta.Reflection.Solver.html#1634" class="Bound">hole</a> <a id="1743" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1747" href="Agda.Builtin.Reflection.html#8687" class="Postulate">reduce</a>
    <a id="1758" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1763" class="Symbol">(</a><a id="1764" href="Meta.Reflection.Solver.html#1764" class="Bound">lhs</a> <a id="1768" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1770" href="Meta.Reflection.Solver.html#1770" class="Bound">rhs</a><a id="1773" class="Symbol">)</a> <a id="1775" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1777" href="Meta.Reflection.Base.html#6641" class="Function">get-boundary</a> <a id="1790" href="Meta.Reflection.Solver.html#1721" class="Bound">goal</a>
      <a id="1801" class="Keyword">where</a> <a id="1807" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1815" class="Symbol">→</a> <a id="1817" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="1827" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="1829" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="1836" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="1865" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                                  <a id="1901" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="1909" href="Meta.Reflection.Solver.html#1721" class="Bound">goal</a> <a id="1914" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1916" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1923" href="Meta.Reflection.Solver.html#1923" class="Bound">elhs</a> <a id="1928" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1930" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="1940" href="Meta.Reflection.Solver.html#1764" class="Bound">lhs</a> <a id="1944" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1948" href="Meta.Reflection.Solver.html#1411" class="Field">build-expr</a>
    <a id="1963" href="Meta.Reflection.Solver.html#1963" class="Bound">erhs</a> <a id="1968" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="1970" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="1980" href="Meta.Reflection.Solver.html#1770" class="Bound">rhs</a> <a id="1984" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="1988" href="Meta.Reflection.Solver.html#1411" class="Field">build-expr</a>
    <a id="2003" class="Symbol">(</a><a id="2004" href="Agda.Builtin.Reflection.html#10893" class="Postulate">noConstraints</a> <a id="2018" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="2020" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="2026" href="Meta.Reflection.Solver.html#1634" class="Bound">hole</a> <a id="2031" class="Symbol">(</a><a id="2032" href="Meta.Reflection.Solver.html#1443" class="Field">invoke-solver</a> <a id="2046" href="Meta.Reflection.Solver.html#1923" class="Bound">elhs</a> <a id="2051" href="Meta.Reflection.Solver.html#1963" class="Bound">erhs</a><a id="2055" class="Symbol">))</a> <a id="2058" href="Meta.Alt.html#314" class="Field Operator">&lt;|&gt;</a> <a id="2062" href="Meta.Reflection.Solver.html#425" class="Function">solver-failed</a> <a id="2076" href="Meta.Reflection.Solver.html#1923" class="Bound">elhs</a> <a id="2081" href="Meta.Reflection.Solver.html#1963" class="Bound">erhs</a>

  <a id="2089" href="Meta.Reflection.Solver.html#2089" class="Function">mk-simple-normalise</a> <a id="2109" class="Symbol">:</a> <a id="2111" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2116" class="Symbol">→</a> <a id="2118" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2128" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2132" href="Meta.Reflection.Solver.html#2089" class="Function">mk-simple-normalise</a> <a id="2152" href="Meta.Reflection.Solver.html#2152" class="Bound">tm</a> <a id="2155" href="Meta.Reflection.Solver.html#2155" class="Bound">hole</a> <a id="2160" class="Symbol">=</a>
    <a id="2166" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="2184" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2190" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="2196" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="2211" class="Symbol">(</a><a id="2212" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2218" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2220" href="Meta.Reflection.Solver.html#1383" class="Field">dont-reduce</a><a id="2231" class="Symbol">)</a> <a id="2233" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="2235" class="Keyword">do</a>
    <a id="2242" href="Meta.Reflection.Solver.html#2242" class="Bound">e</a> <a id="2244" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2246" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="2256" href="Meta.Reflection.Solver.html#2152" class="Bound">tm</a> <a id="2259" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2263" href="Meta.Reflection.Solver.html#1411" class="Field">build-expr</a>
    <a id="2278" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="2284" href="Meta.Reflection.Solver.html#2155" class="Bound">hole</a> <a id="2289" class="Symbol">(</a><a id="2290" href="Meta.Reflection.Solver.html#1482" class="Field">invoke-normaliser</a> <a id="2308" href="Meta.Reflection.Solver.html#2242" class="Bound">e</a><a id="2309" class="Symbol">)</a>

  <a id="2314" href="Meta.Reflection.Solver.html#2314" class="Function">mk-simple-repr</a> <a id="2329" class="Symbol">:</a> <a id="2331" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2336" class="Symbol">→</a> <a id="2338" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2341" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="2345" href="Meta.Reflection.Solver.html#2314" class="Function">mk-simple-repr</a> <a id="2360" href="Meta.Reflection.Solver.html#2360" class="Bound">tm</a> <a id="2363" class="Symbol">=</a>
    <a id="2369" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="2387" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2393" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="2399" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="2414" class="Symbol">(</a><a id="2415" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="2421" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2423" href="Meta.Reflection.Solver.html#1383" class="Field">dont-reduce</a><a id="2434" class="Symbol">)</a> <a id="2436" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="2438" class="Keyword">do</a>
    <a id="2445" href="Meta.Reflection.Solver.html#2445" class="Bound">repr</a> <a id="2450" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="2452" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="2462" href="Meta.Reflection.Solver.html#2360" class="Bound">tm</a> <a id="2465" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="2469" href="Meta.Reflection.Solver.html#1411" class="Field">build-expr</a>
    <a id="2484" href="Meta.Reflection.Solver.html#661" class="Function">print-repr</a> <a id="2495" href="Meta.Reflection.Solver.html#2360" class="Bound">tm</a> <a id="2498" href="Meta.Reflection.Solver.html#2445" class="Bound">repr</a>

<a id="2504" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2585" class="Comment">-- Solvers with Variables</a>

<a id="2612" class="Keyword">record</a> <a id="VariableSolver"></a><a id="2619" href="Meta.Reflection.Solver.html#2619" class="Record">VariableSolver</a> <a id="2634" class="Symbol">{</a><a id="2635" href="Meta.Reflection.Solver.html#2635" class="Bound">ℓ</a><a id="2636" class="Symbol">}</a> <a id="2638" class="Symbol">(</a><a id="2639" href="Meta.Reflection.Solver.html#2639" class="Bound">A</a> <a id="2641" class="Symbol">:</a> <a id="2643" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2648" href="Meta.Reflection.Solver.html#2635" class="Bound">ℓ</a><a id="2649" class="Symbol">)</a> <a id="2651" class="Symbol">:</a> <a id="2653" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2658" href="Meta.Reflection.Solver.html#2635" class="Bound">ℓ</a> <a id="2660" class="Keyword">where</a>
  <a id="2668" class="Keyword">constructor</a> <a id="var-solver"></a><a id="2680" href="Meta.Reflection.Solver.html#2680" class="InductiveConstructor">var-solver</a>
  <a id="2693" class="Keyword">field</a>
    <a id="VariableSolver.dont-reduce"></a><a id="2703" href="Meta.Reflection.Solver.html#2703" class="Field">dont-reduce</a> <a id="2715" class="Symbol">:</a> <a id="2717" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2722" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
    <a id="VariableSolver.build-expr"></a><a id="2731" href="Meta.Reflection.Solver.html#2731" class="Field">build-expr</a> <a id="2742" class="Symbol">:</a> <a id="2744" href="Meta.Reflection.Variables.html#1855" class="Record">Variables</a> <a id="2754" href="Meta.Reflection.Solver.html#2639" class="Bound">A</a> <a id="2756" class="Symbol">→</a> <a id="2758" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2763" class="Symbol">→</a> <a id="2765" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2768" class="Symbol">(</a><a id="2769" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2774" href="Foundations.Sigma.Base.html#498" class="Function Operator">×</a> <a id="2776" href="Meta.Reflection.Variables.html#1855" class="Record">Variables</a> <a id="2786" href="Meta.Reflection.Solver.html#2639" class="Bound">A</a><a id="2787" class="Symbol">)</a>
    <a id="VariableSolver.invoke-solver"></a><a id="2793" href="Meta.Reflection.Solver.html#2793" class="Field">invoke-solver</a> <a id="2807" class="Symbol">:</a> <a id="2809" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2814" class="Symbol">→</a> <a id="2816" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2821" class="Symbol">→</a> <a id="2823" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2828" class="Symbol">→</a> <a id="2830" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>
    <a id="VariableSolver.invoke-normaliser"></a><a id="2839" href="Meta.Reflection.Solver.html#2839" class="Field">invoke-normaliser</a> <a id="2857" class="Symbol">:</a> <a id="2859" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2864" class="Symbol">→</a> <a id="2866" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2871" class="Symbol">→</a> <a id="2873" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a>

<a id="2879" class="Keyword">module</a> <a id="2886" href="Meta.Reflection.Solver.html#2886" class="Module">_</a> <a id="2888" class="Symbol">{</a><a id="2889" href="Meta.Reflection.Solver.html#2889" class="Bound">ℓ</a><a id="2890" class="Symbol">}</a> <a id="2892" class="Symbol">{</a><a id="2893" href="Meta.Reflection.Solver.html#2893" class="Bound">A</a> <a id="2895" class="Symbol">:</a> <a id="2897" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="2902" href="Meta.Reflection.Solver.html#2889" class="Bound">ℓ</a><a id="2903" class="Symbol">}</a> <a id="2905" class="Symbol">(</a><a id="2906" href="Meta.Reflection.Solver.html#2906" class="Bound">solver</a> <a id="2913" class="Symbol">:</a> <a id="2915" href="Meta.Reflection.Solver.html#2619" class="Record">VariableSolver</a> <a id="2930" href="Meta.Reflection.Solver.html#2893" class="Bound">A</a><a id="2931" class="Symbol">)</a> <a id="2933" class="Keyword">where</a>
  <a id="2941" class="Keyword">open</a> <a id="2946" href="Meta.Reflection.Solver.html#2619" class="Module">VariableSolver</a> <a id="2961" href="Meta.Reflection.Solver.html#2906" class="Bound">solver</a>

  <a id="2971" href="Meta.Reflection.Solver.html#2971" class="Function">mk-var-solver</a> <a id="2985" class="Symbol">:</a> <a id="2987" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="2992" class="Symbol">→</a> <a id="2994" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="2997" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3001" href="Meta.Reflection.Solver.html#2971" class="Function">mk-var-solver</a> <a id="3015" href="Meta.Reflection.Solver.html#3015" class="Bound">hole</a> <a id="3020" class="Symbol">=</a>
    <a id="3026" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="3044" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3050" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="3056" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="3071" class="Symbol">(</a><a id="3072" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3078" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3080" href="Meta.Reflection.Solver.html#2703" class="Field">dont-reduce</a><a id="3091" class="Symbol">)</a> <a id="3093" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3095" class="Keyword">do</a>
    <a id="3102" href="Meta.Reflection.Solver.html#3102" class="Bound">goal</a> <a id="3107" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3109" href="Agda.Builtin.Reflection.html#8572" class="Postulate">inferType</a> <a id="3119" href="Meta.Reflection.Solver.html#3015" class="Bound">hole</a> <a id="3124" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3128" href="Agda.Builtin.Reflection.html#8687" class="Postulate">reduce</a>
    <a id="3139" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3144" class="Symbol">(</a><a id="3145" href="Meta.Reflection.Solver.html#3145" class="Bound">lhs</a> <a id="3149" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3151" href="Meta.Reflection.Solver.html#3151" class="Bound">rhs</a><a id="3154" class="Symbol">)</a> <a id="3156" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3158" href="Meta.Reflection.Base.html#6641" class="Function">get-boundary</a> <a id="3171" href="Meta.Reflection.Solver.html#3102" class="Bound">goal</a>
      <a id="3182" class="Keyword">where</a> <a id="3188" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="3196" class="Symbol">→</a> <a id="3198" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="3208" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3210" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="3217" class="String">&quot;Can&#39;t determine boundary: &quot;</a> <a id="3246" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                                  <a id="3282" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="3290" href="Meta.Reflection.Solver.html#3102" class="Bound">goal</a> <a id="3295" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3297" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="3304" href="Meta.Reflection.Solver.html#3304" class="Bound">elhs</a> <a id="3309" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3311" href="Meta.Reflection.Solver.html#3311" class="Bound">vs</a> <a id="3314" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3316" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="3326" href="Meta.Reflection.Solver.html#3145" class="Bound">lhs</a> <a id="3330" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3334" href="Meta.Reflection.Solver.html#2731" class="Field">build-expr</a> <a id="3345" href="Meta.Reflection.Variables.html#2166" class="Function">empty-vars</a>
    <a id="3360" href="Meta.Reflection.Solver.html#3360" class="Bound">erhs</a> <a id="3365" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3367" href="Meta.Reflection.Solver.html#3367" class="Bound">vs</a> <a id="3370" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3372" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="3382" href="Meta.Reflection.Solver.html#3151" class="Bound">rhs</a> <a id="3386" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3390" href="Meta.Reflection.Solver.html#2731" class="Field">build-expr</a> <a id="3401" href="Meta.Reflection.Solver.html#3311" class="Bound">vs</a>
    <a id="3408" href="Meta.Reflection.Solver.html#3408" class="Bound">size</a> <a id="3413" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3415" href="Meta.Reflection.Solver.html#3415" class="Bound">env</a> <a id="3419" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3421" href="Meta.Reflection.Variables.html#3430" class="Function">environment</a> <a id="3433" href="Meta.Reflection.Solver.html#3367" class="Bound">vs</a>
    <a id="3440" class="Symbol">(</a><a id="3441" href="Agda.Builtin.Reflection.html#10893" class="Postulate">noConstraints</a> <a id="3455" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3457" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="3463" href="Meta.Reflection.Solver.html#3015" class="Bound">hole</a> <a id="3468" class="Symbol">(</a><a id="3469" href="Meta.Reflection.Solver.html#2793" class="Field">invoke-solver</a> <a id="3483" href="Meta.Reflection.Solver.html#3304" class="Bound">elhs</a> <a id="3488" href="Meta.Reflection.Solver.html#3360" class="Bound">erhs</a> <a id="3493" href="Meta.Reflection.Solver.html#3415" class="Bound">env</a><a id="3496" class="Symbol">))</a> <a id="3499" href="Meta.Alt.html#314" class="Field Operator">&lt;|&gt;</a>
      <a id="3509" href="Agda.Builtin.Reflection.html#8509" class="Postulate">typeError</a> <a id="3519" class="Symbol">(</a><a id="3520" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="3527" class="String">&quot;Could not equate the following expressions:\n  &quot;</a> <a id="3577" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                   <a id="3598" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="3606" href="Meta.Reflection.Solver.html#3304" class="Bound">elhs</a> <a id="3611" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                 <a id="3630" href="Agda.Builtin.Reflection.html#7917" class="InductiveConstructor">strErr</a> <a id="3637" class="String">&quot;\nAnd\n  &quot;</a> <a id="3649" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
                   <a id="3670" href="Agda.Builtin.Reflection.html#7948" class="InductiveConstructor">termErr</a> <a id="3678" href="Meta.Reflection.Solver.html#3360" class="Bound">erhs</a> <a id="3683" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3685" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3687" class="Symbol">)</a>

  <a id="3692" href="Meta.Reflection.Solver.html#3692" class="Function">mk-var-normalise</a> <a id="3709" class="Symbol">:</a> <a id="3711" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="3716" class="Symbol">→</a> <a id="3718" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="3723" class="Symbol">→</a> <a id="3725" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="3728" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3732" href="Meta.Reflection.Solver.html#3692" class="Function">mk-var-normalise</a> <a id="3749" href="Meta.Reflection.Solver.html#3749" class="Bound">tm</a> <a id="3752" href="Meta.Reflection.Solver.html#3752" class="Bound">hole</a> <a id="3757" class="Symbol">=</a>
    <a id="3763" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="3781" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3787" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="3793" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="3808" class="Symbol">(</a><a id="3809" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="3815" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3817" href="Meta.Reflection.Solver.html#2703" class="Field">dont-reduce</a><a id="3828" class="Symbol">)</a> <a id="3830" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="3832" class="Keyword">do</a>
    <a id="3839" href="Meta.Reflection.Solver.html#3839" class="Bound">e</a> <a id="3841" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3843" href="Meta.Reflection.Solver.html#3843" class="Bound">vs</a> <a id="3846" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3848" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="3858" href="Meta.Reflection.Solver.html#3749" class="Bound">tm</a> <a id="3861" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="3865" href="Meta.Reflection.Solver.html#2731" class="Field">build-expr</a> <a id="3876" href="Meta.Reflection.Variables.html#2166" class="Function">empty-vars</a>
    <a id="3891" href="Meta.Reflection.Solver.html#3891" class="Bound">size</a> <a id="3896" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3898" href="Meta.Reflection.Solver.html#3898" class="Bound">env</a> <a id="3902" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3904" href="Meta.Reflection.Variables.html#3430" class="Function">environment</a> <a id="3916" href="Meta.Reflection.Solver.html#3843" class="Bound">vs</a>
    <a id="3923" href="Meta.Reflection.Solver.html#3923" class="Bound">soln</a> <a id="3928" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="3930" href="Agda.Builtin.Reflection.html#8687" class="Postulate">reduce</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Meta.Reflection.Solver.html#2839" class="Field">invoke-normaliser</a> <a id="3956" href="Meta.Reflection.Solver.html#3839" class="Bound">e</a> <a id="3958" href="Meta.Reflection.Solver.html#3898" class="Bound">env</a><a id="3961" class="Symbol">)</a>
    <a id="3967" href="Agda.Builtin.Reflection.html#8469" class="Postulate">unify</a> <a id="3973" href="Meta.Reflection.Solver.html#3752" class="Bound">hole</a> <a id="3978" href="Meta.Reflection.Solver.html#3923" class="Bound">soln</a>

  <a id="3986" href="Meta.Reflection.Solver.html#3986" class="Function">mk-var-repr</a> <a id="3998" class="Symbol">:</a> <a id="4000" href="Agda.Builtin.Reflection.html#4687" class="Datatype">Term</a> <a id="4005" class="Symbol">→</a> <a id="4007" href="Agda.Builtin.Reflection.html#8296" class="Postulate">TC</a> <a id="4010" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="4014" href="Meta.Reflection.Solver.html#3986" class="Function">mk-var-repr</a> <a id="4026" href="Meta.Reflection.Solver.html#4026" class="Bound">tm</a> <a id="4029" class="Symbol">=</a>
    <a id="4035" href="Agda.Builtin.Reflection.html#9816" class="Postulate">withNormalisation</a> <a id="4053" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4059" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a>
    <a id="4065" href="Agda.Builtin.Reflection.html#10460" class="Postulate">withReduceDefs</a> <a id="4080" class="Symbol">(</a><a id="4081" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="4087" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4089" href="Meta.Reflection.Solver.html#2703" class="Field">dont-reduce</a><a id="4100" class="Symbol">)</a> <a id="4102" href="Foundations.Pi.Base.html#813" class="Function Operator">$</a> <a id="4104" class="Keyword">do</a>
    <a id="4111" href="Meta.Reflection.Solver.html#4111" class="Bound">repr</a> <a id="4116" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4118" href="Meta.Reflection.Solver.html#4118" class="Bound">vs</a> <a id="4121" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4123" href="Agda.Builtin.Reflection.html#8651" class="Postulate">normalise</a> <a id="4133" href="Meta.Reflection.Solver.html#4026" class="Bound">tm</a> <a id="4136" href="Meta.Bind.html#190" class="Field Operator">&gt;&gt;=</a> <a id="4140" href="Meta.Reflection.Solver.html#2731" class="Field">build-expr</a> <a id="4151" href="Meta.Reflection.Variables.html#2166" class="Function">empty-vars</a>
    <a id="4166" href="Meta.Reflection.Solver.html#4166" class="Bound">size</a> <a id="4171" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4173" href="Meta.Reflection.Solver.html#4173" class="Bound">env</a> <a id="4177" href="Meta.Bind.html#190" class="Field Operator">←</a> <a id="4179" href="Meta.Reflection.Variables.html#3430" class="Function">environment</a> <a id="4191" href="Meta.Reflection.Solver.html#4118" class="Bound">vs</a>
    <a id="4198" href="Meta.Reflection.Solver.html#886" class="Function">print-var-repr</a> <a id="4213" href="Meta.Reflection.Solver.html#4026" class="Bound">tm</a> <a id="4216" href="Meta.Reflection.Solver.html#4111" class="Bound">repr</a> <a id="4221" href="Meta.Reflection.Solver.html#4173" class="Bound">env</a>
</pre></body></html>