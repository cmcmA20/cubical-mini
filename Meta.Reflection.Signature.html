<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Reflection.Signature</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Reflection.Signature.html" class="Module">Meta.Reflection.Signature</a> <a id="57" class="Keyword">where</a>

<a id="64" class="Keyword">open</a> <a id="69" class="Keyword">import</a> <a id="76" href="Foundations.Base.html" class="Module">Foundations.Base</a>

<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Meta.Append.html" class="Module">Meta.Append</a>
<a id="118" class="Keyword">open</a> <a id="123" class="Keyword">import</a> <a id="130" href="Meta.Effect.Foldable.html" class="Module">Meta.Effect.Foldable</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Meta.Effect.Traversable.html" class="Module">Meta.Effect.Traversable</a>
<a id="187" class="Keyword">open</a> <a id="192" class="Keyword">import</a> <a id="199" href="Meta.Show.html" class="Module">Meta.Show</a>
<a id="209" class="Keyword">open</a> <a id="214" class="Keyword">import</a> <a id="221" href="Meta.Reflection.Base.html" class="Module">Meta.Reflection.Base</a>
<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Meta.Reflection.Subst.html" class="Module">Meta.Reflection.Subst</a>

<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.List.Instances.Map.html" class="Module">Data.List.Instances.Map</a>
<a id="367" class="Keyword">open</a> <a id="372" class="Keyword">import</a> <a id="379" href="Data.List.Instances.Foldable.html" class="Module">Data.List.Instances.Foldable</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Data.List.Instances.FromProduct.html" class="Module">Data.List.Instances.FromProduct</a>
<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Data.List.Instances.Traversable.html" class="Module">Data.List.Instances.Traversable</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Data.List.Operations.html" class="Module">Data.List.Operations</a>
<a id="529" class="Keyword">open</a> <a id="534" class="Keyword">import</a> <a id="541" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>
<a id="557" class="Keyword">open</a> <a id="562" class="Keyword">import</a> <a id="569" href="Data.Maybe.Instances.Bind.html" class="Module">Data.Maybe.Instances.Bind</a>
<a id="595" class="Keyword">open</a> <a id="600" class="Keyword">import</a> <a id="607" href="Data.Maybe.Instances.Map.html" class="Module">Data.Maybe.Instances.Map</a>
<a id="632" class="Keyword">open</a> <a id="637" class="Keyword">import</a> <a id="644" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="658" class="Keyword">open</a> <a id="663" class="Keyword">import</a> <a id="670" href="Data.String.Instances.Append.html" class="Module">Data.String.Instances.Append</a>

<a id="700" class="Comment">-- Look up a data type definition in the signature.</a>
<a id="get-data-type"></a><a id="752" href="Meta.Reflection.Signature.html#752" class="Function">get-data-type</a> <a id="766" class="Symbol">:</a> <a id="768" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="773" class="Symbol">→</a> <a id="775" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="778" class="Symbol">(</a><a id="779" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="781" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="783" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="788" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="792" class="Symbol">)</a>
<a id="794" href="Meta.Reflection.Signature.html#752" class="Function">get-data-type</a> <a id="808" href="Meta.Reflection.Signature.html#808" class="Bound">n</a> <a id="810" class="Symbol">=</a> <a id="812" href="Agda.Builtin.Reflection.html#9732" class="Postulate">get-definition</a> <a id="827" href="Meta.Reflection.Signature.html#808" class="Bound">n</a> <a id="829" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="833" class="Symbol">λ</a> <a id="835" class="Keyword">where</a>
  <a id="843" class="Symbol">(</a><a id="844" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="854" href="Meta.Reflection.Signature.html#854" class="Bound">pars</a> <a id="859" href="Meta.Reflection.Signature.html#859" class="Bound">cs</a><a id="861" class="Symbol">)</a> <a id="863" class="Symbol">→</a> <a id="865" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="870" class="Symbol">(</a><a id="871" href="Meta.Reflection.Signature.html#854" class="Bound">pars</a> <a id="876" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="878" href="Meta.Reflection.Signature.html#859" class="Bound">cs</a><a id="880" class="Symbol">)</a>
  <a id="884" class="CatchallClause Symbol">_</a> <a id="886" class="Symbol">→</a> <a id="888" href="Agda.Builtin.Reflection.html#8815" class="Postulate">type-error</a> <a id="899" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="901" class="String">&quot;get-data-type: definition &quot;</a> <a id="930" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="932" href="Agda.Builtin.Reflection.html#8315" class="InductiveConstructor">nameErr</a> <a id="940" href="Meta.Reflection.Signature.html#808" class="Bound">n</a> <a id="942" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="944" class="String">&quot; is not a data type.&quot;</a> <a id="967" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>

<a id="970" class="Comment">-- Look up a record type definition in the signature.</a>
<a id="get-record-type"></a><a id="1024" href="Meta.Reflection.Signature.html#1024" class="Function">get-record-type</a> <a id="1040" class="Symbol">:</a> <a id="1042" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1047" class="Symbol">→</a> <a id="1049" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1052" class="Symbol">(</a><a id="1053" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1058" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="1060" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1065" class="Symbol">(</a><a id="1066" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1070" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="1074" class="Symbol">))</a>
<a id="1077" href="Meta.Reflection.Signature.html#1024" class="Function">get-record-type</a> <a id="1093" href="Meta.Reflection.Signature.html#1093" class="Bound">n</a> <a id="1095" class="Symbol">=</a> <a id="1097" href="Agda.Builtin.Reflection.html#9732" class="Postulate">get-definition</a> <a id="1112" href="Meta.Reflection.Signature.html#1093" class="Bound">n</a> <a id="1114" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="1118" class="Symbol">λ</a> <a id="1120" class="Keyword">where</a>
  <a id="1128" class="Symbol">(</a><a id="1129" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="1141" href="Meta.Reflection.Signature.html#1141" class="Bound">conm</a> <a id="1146" href="Meta.Reflection.Signature.html#1146" class="Bound">fields</a><a id="1152" class="Symbol">)</a> <a id="1154" class="Symbol">→</a> <a id="1156" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="1161" class="Symbol">(</a><a id="1162" href="Meta.Reflection.Signature.html#1141" class="Bound">conm</a> <a id="1167" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1169" href="Meta.Reflection.Signature.html#1146" class="Bound">fields</a><a id="1175" class="Symbol">)</a>
  <a id="1179" class="CatchallClause Symbol">_</a> <a id="1181" class="Symbol">→</a> <a id="1183" href="Agda.Builtin.Reflection.html#8815" class="Postulate">type-error</a> <a id="1194" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="1196" class="String">&quot;get-record-type: definition &quot;</a> <a id="1227" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1229" href="Agda.Builtin.Reflection.html#8315" class="InductiveConstructor">nameErr</a> <a id="1237" href="Meta.Reflection.Signature.html#1093" class="Bound">n</a> <a id="1239" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1241" class="String">&quot; is not a record type.&quot;</a> <a id="1266" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>

<a id="1269" class="Comment">-- Representation of a data/record constructor.</a>
<a id="1317" class="Keyword">record</a> <a id="Constructor"></a><a id="1324" href="Meta.Reflection.Signature.html#1324" class="Record">Constructor</a> <a id="1336" class="Symbol">:</a> <a id="1338" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1343" class="Keyword">where</a>
  <a id="1351" class="Keyword">constructor</a> <a id="conhead"></a><a id="1363" href="Meta.Reflection.Signature.html#1363" class="InductiveConstructor">conhead</a>
  <a id="1373" class="Keyword">field</a>
    <a id="1383" class="Comment">-- Name of the constructor itself:</a>
    <a id="Constructor.con-name"></a><a id="1422" href="Meta.Reflection.Signature.html#1422" class="Field">con-name</a>      <a id="1436" class="Symbol">:</a> <a id="1438" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>

    <a id="1448" class="Comment">-- Name of the data type:</a>
    <a id="Constructor.con-data"></a><a id="1478" href="Meta.Reflection.Signature.html#1478" class="Field">con-data</a>      <a id="1492" class="Symbol">:</a> <a id="1494" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>

    <a id="1504" class="Comment">-- Argument telescope for the constructor, with the datatype&#39;s</a>
    <a id="1571" class="Comment">-- parameters removed.</a>
    <a id="Constructor.con-arguments"></a><a id="1598" href="Meta.Reflection.Signature.html#1598" class="Field">con-arguments</a> <a id="1612" class="Symbol">:</a> <a id="1614" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a>

    <a id="1629" class="Comment">-- Return type of the constructor.</a>
    <a id="Constructor.con-returns"></a><a id="1668" href="Meta.Reflection.Signature.html#1668" class="Field">con-returns</a>   <a id="1682" class="Symbol">:</a> <a id="1684" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>

  <a id="1692" class="Comment">-- For the scoping of con-arguments and con-returns, we have</a>
  <a id="1755" class="Comment">--</a>
  <a id="1760" class="Comment">--    data D Δ : Type ... where</a>
  <a id="1794" class="Comment">--      c : Γ → D δ</a>
  <a id="1816" class="Comment">--</a>
  <a id="1821" class="Comment">--    becoming</a>
  <a id="1838" class="Comment">--</a>
  <a id="1843" class="Comment">--      c : ∀ {Δ} → Γ → D δ</a>
  <a id="1873" class="Comment">--</a>
  <a id="1878" class="Comment">--    in the signature. con-arguments is Δ ⊢ Γ, and con-returns is Δ, Γ ⊢ D δ.</a>

<a id="get-type-constructors"></a><a id="1958" href="Meta.Reflection.Signature.html#1958" class="Function">get-type-constructors</a> <a id="1980" class="Symbol">:</a> <a id="1982" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1987" class="Symbol">→</a> <a id="1989" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="1992" class="Symbol">(</a><a id="1993" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1998" href="Meta.Reflection.Signature.html#1324" class="Record">Constructor</a><a id="2009" class="Symbol">)</a>
<a id="2011" href="Meta.Reflection.Signature.html#1958" class="Function">get-type-constructors</a> <a id="2033" href="Meta.Reflection.Signature.html#2033" class="Bound">n</a> <a id="2035" class="Symbol">=</a> <a id="2037" href="Meta.Reflection.Signature.html#2069" class="Function">datatype</a> <a id="2046" href="Meta.Effect.Alt.html#320" class="Field Operator">&lt;|&gt;</a> <a id="2050" href="Meta.Reflection.Signature.html#2237" class="Function">recordtype</a> <a id="2061" class="Keyword">where</a>
  <a id="2069" href="Meta.Reflection.Signature.html#2069" class="Function">datatype</a> <a id="2078" class="Symbol">=</a> <a id="2080" class="Keyword">do</a>
    <a id="2087" class="Symbol">(</a><a id="2088" href="Meta.Reflection.Signature.html#2088" class="Bound">npars</a> <a id="2094" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2096" href="Meta.Reflection.Signature.html#2096" class="Bound">cons</a><a id="2100" class="Symbol">)</a> <a id="2102" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2104" href="Meta.Reflection.Signature.html#752" class="Function">get-data-type</a> <a id="2118" href="Meta.Reflection.Signature.html#2033" class="Bound">n</a>
    <a id="2124" href="Meta.Effect.Traversable.html#396" class="Function">for</a> <a id="2128" href="Meta.Reflection.Signature.html#2096" class="Bound">cons</a> <a id="2133" class="Symbol">λ</a> <a id="2135" href="Meta.Reflection.Signature.html#2135" class="Bound">qn</a> <a id="2138" class="Symbol">→</a> <a id="2140" class="Keyword">do</a>
      <a id="2149" class="Symbol">(</a><a id="2150" href="Meta.Reflection.Signature.html#2150" class="Bound">args</a> <a id="2155" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2157" href="Meta.Reflection.Signature.html#2157" class="Bound">ty</a><a id="2159" class="Symbol">)</a> <a id="2161" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2163" href="Meta.Reflection.Base.html#8193" class="Function">pi-view</a> <a id="2171" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a> <a id="2175" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="2184" href="Meta.Reflection.Signature.html#2135" class="Bound">qn</a>
      <a id="2193" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="2198" class="Symbol">(</a><a id="2199" href="Meta.Reflection.Signature.html#1363" class="InductiveConstructor">conhead</a> <a id="2207" href="Meta.Reflection.Signature.html#2135" class="Bound">qn</a> <a id="2210" href="Meta.Reflection.Signature.html#2033" class="Bound">n</a> <a id="2212" class="Symbol">(</a><a id="2213" href="Data.List.Operations.html#2070" class="Function">drop</a> <a id="2218" href="Meta.Reflection.Signature.html#2088" class="Bound">npars</a> <a id="2224" href="Meta.Reflection.Signature.html#2150" class="Bound">args</a><a id="2228" class="Symbol">)</a> <a id="2230" href="Meta.Reflection.Signature.html#2157" class="Bound">ty</a><a id="2232" class="Symbol">)</a>

  <a id="2237" href="Meta.Reflection.Signature.html#2237" class="Function">recordtype</a> <a id="2248" class="Symbol">=</a> <a id="2250" class="Keyword">do</a>
    <a id="2257" class="Symbol">(</a><a id="2258" href="Meta.Reflection.Signature.html#2258" class="Bound">c</a>  <a id="2261" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2263" class="Symbol">_)</a>    <a id="2269" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2271" href="Meta.Reflection.Signature.html#1024" class="Function">get-record-type</a> <a id="2287" href="Meta.Reflection.Signature.html#2033" class="Bound">n</a>
    <a id="2293" class="Symbol">(</a><a id="2294" href="Meta.Reflection.Signature.html#2294" class="Bound">np</a> <a id="2297" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2299" class="Symbol">_)</a>    <a id="2305" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2307" href="Meta.Reflection.Base.html#8193" class="Function">pi-view</a> <a id="2315" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a> <a id="2319" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="2328" href="Meta.Reflection.Signature.html#2033" class="Bound">n</a>
    <a id="2334" class="Symbol">(</a><a id="2335" href="Meta.Reflection.Signature.html#2335" class="Bound">args</a> <a id="2340" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2342" href="Meta.Reflection.Signature.html#2342" class="Bound">ty</a><a id="2344" class="Symbol">)</a> <a id="2346" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2348" href="Meta.Reflection.Base.html#8193" class="Function">pi-view</a> <a id="2356" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a> <a id="2360" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="2369" href="Meta.Reflection.Signature.html#2258" class="Bound">c</a>
    <a id="2375" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="2380" class="Symbol">((</a><a id="2382" href="Meta.Reflection.Signature.html#1363" class="InductiveConstructor">conhead</a> <a id="2390" href="Meta.Reflection.Signature.html#2258" class="Bound">c</a> <a id="2392" href="Meta.Reflection.Signature.html#2033" class="Bound">n</a> <a id="2394" class="Symbol">(</a><a id="2395" href="Data.List.Operations.html#2070" class="Function">drop</a> <a id="2400" class="Symbol">(</a><a id="2401" href="Data.List.Operations.html#554" class="Function">length</a> <a id="2408" href="Meta.Reflection.Signature.html#2294" class="Bound">np</a><a id="2410" class="Symbol">)</a> <a id="2412" href="Meta.Reflection.Signature.html#2335" class="Bound">args</a><a id="2416" class="Symbol">)</a> <a id="2418" href="Meta.Reflection.Signature.html#2342" class="Bound">ty</a><a id="2420" class="Symbol">)</a> <a id="2422" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2424" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2426" class="Symbol">)</a>

<a id="2429" class="Comment">-- Look up a constructor in the signature.</a>
<a id="get-constructor"></a><a id="2472" href="Meta.Reflection.Signature.html#2472" class="Function">get-constructor</a> <a id="2488" class="Symbol">:</a> <a id="2490" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2495" class="Symbol">→</a> <a id="2497" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2500" href="Meta.Reflection.Signature.html#1324" class="Record">Constructor</a>
<a id="2512" href="Meta.Reflection.Signature.html#2472" class="Function">get-constructor</a> <a id="2528" href="Meta.Reflection.Signature.html#2528" class="Bound">n</a> <a id="2530" class="Symbol">=</a> <a id="2532" href="Agda.Builtin.Reflection.html#9732" class="Postulate">get-definition</a> <a id="2547" href="Meta.Reflection.Signature.html#2528" class="Bound">n</a> <a id="2549" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="2553" class="Symbol">λ</a> <a id="2555" class="Keyword">where</a>
  <a id="2563" class="Symbol">(</a><a id="2564" href="Agda.Builtin.Reflection.html#7680" class="InductiveConstructor">data-cons</a> <a id="2574" href="Meta.Reflection.Signature.html#2574" class="Bound">t</a><a id="2575" class="Symbol">)</a> <a id="2577" class="Symbol">→</a> <a id="2579" class="Keyword">do</a>
    <a id="2586" class="Symbol">(</a><a id="2587" href="Meta.Reflection.Signature.html#2587" class="Bound">npars</a> <a id="2593" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2595" href="Meta.Reflection.Signature.html#2595" class="Bound">cons</a><a id="2599" class="Symbol">)</a> <a id="2601" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2603" href="Meta.Reflection.Signature.html#752" class="Function">get-data-type</a> <a id="2617" href="Meta.Reflection.Signature.html#2574" class="Bound">t</a>
    <a id="2623" class="Symbol">(</a><a id="2624" href="Meta.Reflection.Signature.html#2624" class="Bound">args</a> <a id="2629" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2631" href="Meta.Reflection.Signature.html#2631" class="Bound">ty</a><a id="2633" class="Symbol">)</a>    <a id="2638" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="2640" href="Meta.Reflection.Base.html#8193" class="Function">pi-view</a> <a id="2648" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a> <a id="2652" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="2661" href="Meta.Reflection.Signature.html#2528" class="Bound">n</a>
    <a id="2667" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="2672" class="Symbol">(</a><a id="2673" href="Meta.Reflection.Signature.html#1363" class="InductiveConstructor">conhead</a> <a id="2681" href="Meta.Reflection.Signature.html#2528" class="Bound">n</a> <a id="2683" href="Meta.Reflection.Signature.html#2574" class="Bound">t</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Data.List.Operations.html#2070" class="Function">drop</a> <a id="2691" href="Meta.Reflection.Signature.html#2587" class="Bound">npars</a> <a id="2697" href="Meta.Reflection.Signature.html#2624" class="Bound">args</a><a id="2701" class="Symbol">)</a> <a id="2703" href="Meta.Reflection.Signature.html#2631" class="Bound">ty</a><a id="2705" class="Symbol">)</a>
  <a id="2709" class="CatchallClause Symbol">_</a> <a id="2711" class="Symbol">→</a> <a id="2713" href="Agda.Builtin.Reflection.html#8815" class="Postulate">type-error</a> <a id="2724" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="2726" class="String">&quot;get-constructor: &quot;</a> <a id="2746" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2748" href="Agda.Builtin.Reflection.html#8315" class="InductiveConstructor">nameErr</a> <a id="2756" href="Meta.Reflection.Signature.html#2528" class="Bound">n</a> <a id="2758" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2760" class="String">&quot; is not a data constructor.&quot;</a> <a id="2790" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>

<a id="2793" class="Comment">-- If a term reduces to an application of a record type, return</a>
<a id="2857" class="Comment">-- information about that record.</a>
<a id="get-record"></a><a id="2891" href="Meta.Reflection.Signature.html#2891" class="Function">get-record</a> <a id="2902" class="Symbol">:</a> <a id="2904" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2909" class="Symbol">→</a> <a id="2911" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="2914" class="Symbol">(</a><a id="2915" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2920" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="2922" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2927" class="Symbol">(</a><a id="2928" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2932" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="2936" class="Symbol">))</a>
<a id="2939" href="Meta.Reflection.Signature.html#2891" class="Function">get-record</a> <a id="2950" href="Meta.Reflection.Signature.html#2950" class="Bound">tm</a> <a id="2953" class="Symbol">=</a> <a id="2955" href="Agda.Builtin.Reflection.html#8993" class="Postulate">reduce</a> <a id="2962" href="Meta.Reflection.Signature.html#2950" class="Bound">tm</a> <a id="2965" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="2969" class="Symbol">λ</a> <a id="2971" class="Keyword">where</a>
  <a id="2979" class="Symbol">(</a><a id="2980" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="2984" href="Meta.Reflection.Signature.html#2984" class="Bound">qn</a> <a id="2987" class="Symbol">_)</a> <a id="2990" class="Symbol">→</a> <a id="2992" href="Meta.Reflection.Signature.html#1024" class="Function">get-record-type</a> <a id="3008" href="Meta.Reflection.Signature.html#2984" class="Bound">qn</a>
  <a id="3013" class="CatchallClause Symbol">_</a>          <a id="3024" class="Symbol">→</a> <a id="3026" href="Agda.Builtin.Reflection.html#8815" class="Postulate">type-error</a> <a id="3037" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="3039" class="String">&quot;get-record: &quot;</a> <a id="3054" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3056" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="3064" href="Meta.Reflection.Signature.html#2950" class="Bound">tm</a> <a id="3067" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3069" class="String">&quot; is not a record type.&quot;</a> <a id="3094" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>

<a id="telescope→patterns"></a><a id="3097" href="Meta.Reflection.Signature.html#3097" class="Function">telescope→patterns</a> <a id="3116" class="Symbol">:</a> <a id="3118" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="3128" class="Symbol">→</a> <a id="3130" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3135" class="Symbol">(</a><a id="3136" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="3140" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a><a id="3147" class="Symbol">)</a>
<a id="3149" href="Meta.Reflection.Signature.html#3097" class="Function">telescope→patterns</a> <a id="3168" href="Meta.Reflection.Signature.html#3168" class="Bound">tel</a> <a id="3172" class="Symbol">=</a> <a id="3174" href="Meta.Reflection.Signature.html#3206" class="Function">go</a> <a id="3177" class="Symbol">(</a><a id="3178" href="Data.List.Operations.html#554" class="Function">length</a> <a id="3185" href="Meta.Reflection.Signature.html#3168" class="Bound">tel</a> <a id="3189" href="Data.Nat.Base.html#320" class="Primitive Operator">∸</a> <a id="3191" class="Number">1</a><a id="3192" class="Symbol">)</a> <a id="3194" href="Meta.Reflection.Signature.html#3168" class="Bound">tel</a> <a id="3198" class="Keyword">where</a>
  <a id="3206" href="Meta.Reflection.Signature.html#3206" class="Function">go</a> <a id="3209" class="Symbol">:</a> <a id="3211" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3213" class="Symbol">→</a> <a id="3215" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="3225" class="Symbol">→</a> <a id="3227" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3232" class="Symbol">(</a><a id="3233" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="3237" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a><a id="3244" class="Symbol">)</a>
  <a id="3248" href="Meta.Reflection.Signature.html#3206" class="Function">go</a> <a id="3251" href="Meta.Reflection.Signature.html#3251" class="Bound">n</a> <a id="3253" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>                  <a id="3273" class="Symbol">=</a> <a id="3275" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="3280" href="Meta.Reflection.Signature.html#3206" class="Function">go</a> <a id="3283" href="Meta.Reflection.Signature.html#3283" class="Bound">n</a> <a id="3285" class="Symbol">((_</a> <a id="3289" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3291" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3295" href="Meta.Reflection.Signature.html#3295" class="Bound">i</a> <a id="3297" class="Symbol">_)</a> <a id="3300" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3302" href="Meta.Reflection.Signature.html#3302" class="Bound">t</a><a id="3303" class="Symbol">)</a> <a id="3305" class="Symbol">=</a> <a id="3307" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3311" href="Meta.Reflection.Signature.html#3295" class="Bound">i</a> <a id="3313" class="Symbol">(</a><a id="3314" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">var</a> <a id="3318" href="Meta.Reflection.Signature.html#3283" class="Bound">n</a><a id="3319" class="Symbol">)</a> <a id="3321" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3323" href="Meta.Reflection.Signature.html#3206" class="Function">go</a> <a id="3326" class="Symbol">(</a><a id="3327" href="Meta.Reflection.Signature.html#3283" class="Bound">n</a> <a id="3329" href="Data.Nat.Base.html#320" class="Primitive Operator">∸</a> <a id="3331" class="Number">1</a><a id="3332" class="Symbol">)</a> <a id="3334" href="Meta.Reflection.Signature.html#3302" class="Bound">t</a>

<a id="3337" class="Comment">-- Get the argument telescope of something in the signature. NOTE: If</a>
<a id="3407" class="Comment">-- the Name refers to a Constructor, the returned telescope *will*</a>
<a id="3474" class="Comment">-- include the data/record parameters!</a>
<a id="get-argument-tele"></a><a id="3513" href="Meta.Reflection.Signature.html#3513" class="Function">get-argument-tele</a> <a id="3531" class="Symbol">:</a> <a id="3533" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3538" class="Symbol">→</a> <a id="3540" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="3543" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a>
<a id="3553" href="Meta.Reflection.Signature.html#3513" class="Function">get-argument-tele</a> <a id="3571" href="Meta.Reflection.Signature.html#3571" class="Bound">qn</a> <a id="3574" class="Symbol">=</a> <a id="3576" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="3585" href="Meta.Reflection.Signature.html#3571" class="Bound">qn</a> <a id="3588" href="Meta.Effect.Map.html#604" class="Function Operator">&lt;&amp;&gt;</a> <a id="3592" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="3596" href="Foundations.Pi.Base.html#1711" class="Function Operator">∘</a> <a id="3598" href="Meta.Reflection.Base.html#8193" class="Function">pi-view</a>

<a id="3607" class="Keyword">record</a> <a id="Has-constr"></a><a id="3614" href="Meta.Reflection.Signature.html#3614" class="Record">Has-constr</a> <a id="3625" class="Symbol">{</a><a id="3626" href="Meta.Reflection.Signature.html#3626" class="Bound">ℓ</a><a id="3627" class="Symbol">}</a> <a id="3629" class="Symbol">(</a><a id="3630" href="Meta.Reflection.Signature.html#3630" class="Bound">A</a> <a id="3632" class="Symbol">:</a> <a id="3634" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="3639" href="Meta.Reflection.Signature.html#3626" class="Bound">ℓ</a><a id="3640" class="Symbol">)</a> <a id="3642" class="Symbol">:</a> <a id="3644" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="3649" href="Meta.Reflection.Signature.html#3626" class="Bound">ℓ</a> <a id="3651" class="Keyword">where</a>
  <a id="3659" class="Keyword">field</a> <a id="Has-constr.from-constr"></a><a id="3665" href="Meta.Reflection.Signature.html#3665" class="Field">from-constr</a> <a id="3677" class="Symbol">:</a> <a id="3679" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3684" class="Symbol">→</a> <a id="3686" href="Meta.Reflection.Signature.html#3630" class="Bound">A</a>

<a id="3689" class="Keyword">record</a> <a id="Has-def"></a><a id="3696" href="Meta.Reflection.Signature.html#3696" class="Record">Has-def</a> <a id="3704" class="Symbol">{</a><a id="3705" href="Meta.Reflection.Signature.html#3705" class="Bound">ℓ</a><a id="3706" class="Symbol">}</a> <a id="3708" class="Symbol">(</a><a id="3709" href="Meta.Reflection.Signature.html#3709" class="Bound">A</a> <a id="3711" class="Symbol">:</a> <a id="3713" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="3718" href="Meta.Reflection.Signature.html#3705" class="Bound">ℓ</a><a id="3719" class="Symbol">)</a> <a id="3721" class="Symbol">:</a> <a id="3723" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="3728" href="Meta.Reflection.Signature.html#3705" class="Bound">ℓ</a> <a id="3730" class="Keyword">where</a>
  <a id="3738" class="Keyword">field</a> <a id="Has-def.from-def"></a><a id="3744" href="Meta.Reflection.Signature.html#3744" class="Field">from-def</a> <a id="3753" class="Symbol">:</a> <a id="3755" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3760" class="Symbol">→</a> <a id="3762" href="Meta.Reflection.Signature.html#3709" class="Bound">A</a>

<a id="3765" class="Keyword">instance</a>
  <a id="Has-constr-Pattern"></a><a id="3776" href="Meta.Reflection.Signature.html#3776" class="Function">Has-constr-Pattern</a> <a id="3795" class="Symbol">:</a> <a id="3797" href="Meta.Reflection.Signature.html#3614" class="Record">Has-constr</a> <a id="3808" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a>
  <a id="3818" href="Meta.Reflection.Signature.html#3776" class="Function">Has-constr-Pattern</a> <a id="3837" class="Symbol">=</a> <a id="3839" class="Keyword">record</a> <a id="3846" class="Symbol">{</a> <a id="3848" href="Meta.Reflection.Signature.html#3665" class="Field">from-constr</a> <a id="3860" class="Symbol">=</a> <a id="3862" href="Meta.Reflection.Base.html#16048" class="InductiveConstructor">con₀</a> <a id="3867" class="Symbol">}</a>

  <a id="Has-constr-Term"></a><a id="3872" href="Meta.Reflection.Signature.html#3872" class="Function">Has-constr-Term</a> <a id="3888" class="Symbol">:</a> <a id="3890" href="Meta.Reflection.Signature.html#3614" class="Record">Has-constr</a> <a id="3901" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="3908" href="Meta.Reflection.Signature.html#3872" class="Function">Has-constr-Term</a> <a id="3924" class="Symbol">=</a> <a id="3926" class="Keyword">record</a> <a id="3933" class="Symbol">{</a> <a id="3935" href="Meta.Reflection.Signature.html#3665" class="Field">from-constr</a> <a id="3947" class="Symbol">=</a> <a id="3949" href="Meta.Reflection.Base.html#16048" class="InductiveConstructor">con₀</a> <a id="3954" class="Symbol">}</a>

  <a id="Has-def-Term"></a><a id="3959" href="Meta.Reflection.Signature.html#3959" class="Function">Has-def-Term</a> <a id="3972" class="Symbol">:</a> <a id="3974" href="Meta.Reflection.Signature.html#3696" class="Record">Has-def</a> <a id="3982" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="3989" href="Meta.Reflection.Signature.html#3959" class="Function">Has-def-Term</a> <a id="4002" class="Symbol">=</a> <a id="4004" class="Keyword">record</a> <a id="4011" class="Symbol">{</a> <a id="4013" href="Meta.Reflection.Signature.html#3744" class="Field">from-def</a> <a id="4022" class="Symbol">=</a> <a id="4024" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="4029" class="Symbol">}</a>

  <a id="Has-constr-Name"></a><a id="4034" href="Meta.Reflection.Signature.html#4034" class="Function">Has-constr-Name</a> <a id="4050" class="Symbol">:</a> <a id="4052" href="Meta.Reflection.Signature.html#3614" class="Record">Has-constr</a> <a id="4063" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="4070" href="Meta.Reflection.Signature.html#4034" class="Function">Has-constr-Name</a> <a id="4086" class="Symbol">=</a> <a id="4088" class="Keyword">record</a> <a id="4095" class="Symbol">{</a> <a id="4097" href="Meta.Reflection.Signature.html#3665" class="Field">from-constr</a> <a id="4109" class="Symbol">=</a> <a id="4111" href="Foundations.Pi.Base.html#1239" class="Function">id</a> <a id="4114" class="Symbol">}</a>

  <a id="Has-def-Name"></a><a id="4119" href="Meta.Reflection.Signature.html#4119" class="Function">Has-def-Name</a> <a id="4132" class="Symbol">:</a> <a id="4134" href="Meta.Reflection.Signature.html#3696" class="Record">Has-def</a> <a id="4142" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="4149" href="Meta.Reflection.Signature.html#4119" class="Function">Has-def-Name</a> <a id="4162" class="Symbol">=</a> <a id="4164" class="Keyword">record</a> <a id="4171" class="Symbol">{</a> <a id="4173" href="Meta.Reflection.Signature.html#3744" class="Field">from-def</a> <a id="4182" class="Symbol">=</a> <a id="4184" href="Foundations.Pi.Base.html#1239" class="Function">id</a> <a id="4187" class="Symbol">}</a>

<a id="4190" class="Keyword">private</a>
  <a id="it-worker"></a><a id="4200" href="Meta.Reflection.Signature.html#4200" class="Function">it-worker</a> <a id="4210" class="Symbol">:</a> <a id="4212" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4217" class="Symbol">→</a> <a id="4219" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="4222" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="4229" href="Meta.Reflection.Signature.html#4200" class="Function">it-worker</a> <a id="4239" href="Meta.Reflection.Signature.html#4239" class="Bound">n</a> <a id="4241" class="Symbol">=</a> <a id="4243" href="Agda.Builtin.Reflection.html#9732" class="Postulate">get-definition</a> <a id="4258" href="Meta.Reflection.Signature.html#4239" class="Bound">n</a> <a id="4260" href="Meta.Effect.Map.html#604" class="Function Operator">&lt;&amp;&gt;</a> <a id="4264" class="Symbol">λ</a> <a id="4266" class="Keyword">where</a>
    <a id="4276" class="Symbol">(</a><a id="4277" href="Agda.Builtin.Reflection.html#7680" class="InductiveConstructor">data-cons</a> <a id="4287" class="Symbol">_)</a> <a id="4290" class="Symbol">→</a>
      <a id="4298" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="4303" class="Symbol">(</a><a id="4304" class="Keyword">quote</a> <a id="4310" href="Meta.Reflection.Signature.html#3665" class="Field">Has-constr.from-constr</a><a id="4332" class="Symbol">)</a> <a id="4334" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="4338" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="4343" class="Symbol">(</a><a id="4344" class="Keyword">quote</a> <a id="4350" href="Foundations.Base.html#21236" class="Function">by-instance</a><a id="4361" class="Symbol">)</a> <a id="4363" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="4367" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="4371" class="Symbol">(</a><a id="4372" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="4377" href="Meta.Reflection.Signature.html#4239" class="Bound">n</a><a id="4378" class="Symbol">)</a>
    <a id="4384" class="CatchallClause Symbol">_</a> <a id="4386" class="Symbol">→</a>
      <a id="4394" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="4399" class="Symbol">(</a><a id="4400" class="Keyword">quote</a> <a id="4406" href="Meta.Reflection.Signature.html#3744" class="Field">Has-def.from-def</a><a id="4422" class="Symbol">)</a> <a id="4424" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="4428" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="4433" class="Symbol">(</a><a id="4434" class="Keyword">quote</a> <a id="4440" href="Foundations.Base.html#21236" class="Function">by-instance</a><a id="4451" class="Symbol">)</a> <a id="4453" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="4457" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="4461" class="Symbol">(</a><a id="4462" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="4467" href="Meta.Reflection.Signature.html#4239" class="Bound">n</a><a id="4468" class="Symbol">)</a>

<a id="4471" class="Keyword">macro</a>
  <a id="4479" class="Comment">-- Macro which turns a Name into its quoted Term/Pattern</a>
  <a id="4538" class="Comment">-- representation.</a>
  <a id="4559" class="Comment">--</a>
  <a id="4564" class="Comment">-- If the Name refers to a constructor, it&#39;s wrapped in con₀,</a>
  <a id="4628" class="Comment">-- otherwise, it&#39;s wrapped in def₀.</a>
  <a id="4666" class="Comment">--</a>
  <a id="4671" class="Comment">-- Since `it` is a macro, you can use this as `it Foo` rather than</a>
  <a id="4740" class="Comment">-- `def₀ (quote Foo)`.</a>
  <a id="it"></a><a id="4765" href="Meta.Reflection.Signature.html#4765" class="Function">it</a> <a id="4768" class="Symbol">:</a> <a id="4770" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4775" class="Symbol">→</a> <a id="4777" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4782" class="Symbol">→</a> <a id="4784" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="4787" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="4791" href="Meta.Reflection.Signature.html#4765" class="Function">it</a> <a id="4794" href="Meta.Reflection.Signature.html#4794" class="Bound">n</a> <a id="4796" href="Meta.Reflection.Signature.html#4796" class="Bound">g</a> <a id="4798" class="Symbol">=</a> <a id="4800" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="4806" href="Meta.Reflection.Signature.html#4796" class="Bound">g</a> <a id="4808" href="Meta.Effect.Bind.html#393" class="Function Operator">=&lt;&lt;</a> <a id="4812" href="Meta.Reflection.Signature.html#4200" class="Function">it-worker</a> <a id="4822" href="Meta.Reflection.Signature.html#4794" class="Bound">n</a>

<a id="4825" href="Meta.Reflection.Signature.html#4825" class="Function">_</a> <a id="4827" class="Symbol">:</a> <a id="4829" href="Foundations.Prim.Kan.html#1374" class="Function">Path</a> <a id="4834" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4839" class="Symbol">(</a><a id="4840" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="4843" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="4844" class="Symbol">)</a> <a id="4846" class="Symbol">(</a><a id="4847" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="4851" class="Symbol">(</a><a id="4852" class="Keyword">quote</a> <a id="4858" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="4859" class="Symbol">)</a> <a id="4861" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4863" class="Symbol">)</a>
<a id="4865" class="Symbol">_</a> <a id="4867" class="Symbol">=</a> <a id="4869" href="Foundations.Prim.Kan.html#1451" class="Function">refl</a>

<a id="4875" class="Keyword">macro</a>
  <a id="4883" class="Comment">-- Macro which turns a *record name* into the quoted representation of</a>
  <a id="4956" class="Comment">-- its *constructor*, e.g. `constructor Σ` is `con₀ (quote _,_)`.</a>
  <a id="`constructor"></a><a id="5024" href="Meta.Reflection.Signature.html#5024" class="Function">`constructor</a> <a id="5037" class="Symbol">:</a> <a id="5039" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5044" class="Symbol">→</a> <a id="5046" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5051" class="Symbol">→</a> <a id="5053" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="5056" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="5060" href="Meta.Reflection.Signature.html#5024" class="Function">`constructor</a> <a id="5073" href="Meta.Reflection.Signature.html#5073" class="Bound">n</a> <a id="5075" href="Meta.Reflection.Signature.html#5075" class="Bound">g</a> <a id="5077" class="Symbol">=</a> <a id="5079" class="Keyword">do</a>
    <a id="5086" class="Symbol">(</a><a id="5087" href="Meta.Reflection.Signature.html#5087" class="Bound">c</a> <a id="5089" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5091" class="Symbol">_)</a> <a id="5094" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="5096" href="Meta.Reflection.Signature.html#1024" class="Function">get-record-type</a> <a id="5112" href="Meta.Reflection.Signature.html#5073" class="Bound">n</a>
    <a id="5118" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="5124" href="Meta.Reflection.Signature.html#5075" class="Bound">g</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="5130" href="Meta.Reflection.Signature.html#3665" class="Field">Has-constr.from-constr</a> <a id="5153" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="5157" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="5162" class="Symbol">(</a><a id="5163" class="Keyword">quote</a> <a id="5169" href="Foundations.Base.html#21236" class="Function">by-instance</a><a id="5180" class="Symbol">)</a> <a id="5182" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="5186" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="5190" class="Symbol">(</a><a id="5191" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="5196" href="Meta.Reflection.Signature.html#5087" class="Bound">c</a><a id="5197" class="Symbol">))</a>

<a id="5201" href="Meta.Reflection.Signature.html#5201" class="Function">_</a> <a id="5203" class="Symbol">:</a> <a id="5205" href="Foundations.Prim.Kan.html#1374" class="Function">Path</a> <a id="5210" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5215" class="Symbol">(</a><a id="5216" href="Meta.Reflection.Signature.html#5024" class="Macro">`constructor</a> <a id="5229" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="5230" class="Symbol">)</a> <a id="5232" class="Symbol">(</a><a id="5233" href="Meta.Reflection.Base.html#16048" class="InductiveConstructor">con₀</a> <a id="5238" class="Symbol">(</a><a id="5239" class="Keyword">quote</a> <a id="5245" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="5248" class="Symbol">))</a>
<a id="5251" class="Symbol">_</a> <a id="5253" class="Symbol">=</a> <a id="5255" href="Foundations.Prim.Kan.html#1451" class="Function">refl</a>

<a id="5261" class="Keyword">macro</a>
  <a id="5269" class="Comment">-- Like &#39;it&#39;, but the quoted representation is additionally wrapped in</a>
  <a id="5342" class="Comment">-- enough lambdas to apply the given definition to all of its visible</a>
  <a id="5414" class="Comment">-- arguments.</a>
  <a id="itₙ"></a><a id="5430" href="Meta.Reflection.Signature.html#5430" class="Function">itₙ</a> <a id="5434" class="Symbol">:</a> <a id="5436" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5441" class="Symbol">→</a> <a id="5443" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5448" class="Symbol">→</a> <a id="5450" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="5453" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="5457" href="Meta.Reflection.Signature.html#5430" class="Function">itₙ</a> <a id="5461" href="Meta.Reflection.Signature.html#5461" class="Bound">n</a> <a id="5463" href="Meta.Reflection.Signature.html#5463" class="Bound">g</a> <a id="5465" class="Symbol">=</a> <a id="5467" class="Keyword">do</a>
    <a id="5474" href="Meta.Reflection.Signature.html#5474" class="Bound">tm</a>   <a id="5479" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="5481" href="Meta.Reflection.Signature.html#4200" class="Function">it-worker</a> <a id="5491" href="Meta.Reflection.Signature.html#5461" class="Bound">n</a>
    <a id="5497" href="Meta.Reflection.Signature.html#5497" class="Bound">args</a> <a id="5502" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="5504" href="Meta.Reflection.Signature.html#3513" class="Function">get-argument-tele</a> <a id="5522" href="Meta.Reflection.Signature.html#5461" class="Bound">n</a>
    <a id="5528" class="Keyword">let</a>
      <a id="5538" href="Meta.Reflection.Signature.html#5538" class="Bound">args</a> <a id="5543" class="Symbol">=</a> <a id="5545" href="Data.List.Operations.html#722" class="Function">filter</a> <a id="5552" class="Symbol">(λ</a> <a id="5555" class="Symbol">{</a> <a id="5557" class="Symbol">(_</a> <a id="5560" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5562" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="5566" class="Symbol">(</a><a id="5567" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="5576" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="5584" class="Symbol">_)</a> <a id="5587" class="Symbol">_)</a> <a id="5590" class="Symbol">→</a> <a id="5592" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="5597" class="Symbol">;</a> <a id="5599" class="CatchallClause Symbol">_</a> <a id="5601" class="Symbol">→</a> <a id="5603" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="5609" class="Symbol">})</a> <a id="5612" href="Meta.Reflection.Signature.html#5497" class="Bound">args</a>

      <a id="5624" href="Meta.Reflection.Signature.html#5624" class="Bound">tm</a> <a id="5627" class="Symbol">=</a> <a id="5629" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5633" class="Symbol">(</a><a id="5634" class="Keyword">quote</a> <a id="5640" href="Meta.Reflection.Base.html#14337" class="Field">applyⁿᵉ</a><a id="5647" class="Symbol">)</a> <a id="5649" class="Symbol">(</a><a id="5650" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="5655" href="Meta.Reflection.Signature.html#5474" class="Bound">tm</a> <a id="5658" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5660" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="5665" class="Symbol">(</a><a id="5666" href="Meta.Reflection.Base.html#12000" class="Function">list-term</a> <a id="5676" class="Symbol">(</a><a id="5677" href="Data.List.Base.html#835" class="Function">reverse</a> <a id="5685" class="Symbol">(</a><a id="5686" href="Data.List.Operations.html#2392" class="Function">map-up</a> <a id="5693" class="Symbol">(λ</a> <a id="5696" href="Meta.Reflection.Signature.html#5696" class="Bound">i</a> <a id="5698" href="Meta.Reflection.Signature.html#5698" class="Bound">_</a> <a id="5700" class="Symbol">→</a> <a id="5702" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="5705" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="5710" href="Meta.Reflection.Base.html#14784" class="Function Operator">##ₙ</a> <a id="5714" href="Meta.Reflection.Base.html#16100" class="InductiveConstructor">var₀</a> <a id="5719" href="Meta.Reflection.Signature.html#5696" class="Bound">i</a><a id="5720" class="Symbol">)</a> <a id="5722" class="Number">0</a> <a id="5724" href="Meta.Reflection.Signature.html#5538" class="Bound">args</a><a id="5728" class="Symbol">)))</a> <a id="5732" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5734" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5736" class="Symbol">)</a>
      <a id="5744" href="Meta.Reflection.Signature.html#5744" class="Bound">tm</a> <a id="5747" class="Symbol">=</a> <a id="5749" href="Meta.Effect.Foldable.html#270" class="Field">fold-r</a> <a id="5756" class="Symbol">(λ</a> <a id="5759" href="Meta.Reflection.Signature.html#5759" class="Bound">_</a> <a id="5761" href="Meta.Reflection.Signature.html#5761" class="Bound">y</a> <a id="5763" class="Symbol">→</a> <a id="5765" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="5769" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="5777" class="Symbol">(</a><a id="5778" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="5782" class="String">&quot;_&quot;</a> <a id="5786" href="Meta.Reflection.Signature.html#5761" class="Bound">y</a><a id="5787" class="Symbol">))</a> <a id="5790" href="Meta.Reflection.Signature.html#5624" class="Bound">tm</a> <a id="5793" href="Meta.Reflection.Signature.html#5538" class="Bound">args</a>

      <a id="5805" href="Meta.Reflection.Signature.html#5805" class="Bound">ty</a> <a id="5808" class="Symbol">=</a> <a id="5810" href="Meta.Effect.Foldable.html#270" class="Field">fold-r</a> <a id="5817" class="Symbol">(λ</a> <a id="5820" href="Meta.Reflection.Signature.html#5820" class="Bound">_</a> <a id="5822" href="Meta.Reflection.Signature.html#5822" class="Bound">y</a> <a id="5824" class="Symbol">→</a> <a id="5826" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5830" class="Symbol">(</a><a id="5831" class="Keyword">quote</a> <a id="5837" href="Meta.Reflection.Base.html#3630" class="Function">Fun</a><a id="5840" class="Symbol">)</a> <a id="5842" class="Symbol">(</a><a id="5843" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="5848" class="Symbol">(</a><a id="5849" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="5852" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="5856" class="Symbol">)</a> <a id="5858" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5860" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="5865" href="Meta.Reflection.Signature.html#5822" class="Bound">y</a> <a id="5867" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5869" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5871" class="Symbol">))</a> <a id="5874" class="Symbol">(</a><a id="5875" href="Meta.Reflection.Signature.html#4765" class="Macro">it</a> <a id="5878" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="5882" class="Symbol">)</a> <a id="5884" href="Meta.Reflection.Signature.html#5538" class="Bound">args</a>

    <a id="5894" href="Agda.Builtin.Reflection.html#8914" class="Postulate">check-type</a> <a id="5905" href="Meta.Reflection.Signature.html#5463" class="Bound">g</a> <a id="5907" href="Meta.Reflection.Signature.html#5805" class="Bound">ty</a>
    <a id="5914" href="Agda.Builtin.Reflection.html#8775" class="Postulate">unify</a> <a id="5920" href="Meta.Reflection.Signature.html#5463" class="Bound">g</a> <a id="5922" href="Meta.Reflection.Signature.html#5744" class="Bound">tm</a>

<a id="5926" href="Meta.Reflection.Signature.html#5926" class="Function">_</a> <a id="5928" class="Symbol">:</a> <a id="5930" href="Foundations.Prim.Kan.html#1374" class="Function">Path</a> <a id="5935" class="Symbol">(</a><a id="5936" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5941" class="Symbol">→</a> <a id="5943" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5948" class="Symbol">→</a> <a id="5950" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="5954" class="Symbol">)</a> <a id="5956" class="Symbol">(</a><a id="5957" href="Meta.Reflection.Signature.html#5430" class="Macro">itₙ</a> <a id="5961" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="5962" class="Symbol">)</a> <a id="5964" class="Symbol">(λ</a> <a id="5967" href="Meta.Reflection.Signature.html#5967" class="Bound">x</a> <a id="5969" href="Meta.Reflection.Signature.html#5969" class="Bound">y</a> <a id="5971" class="Symbol">→</a> <a id="5973" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5977" class="Symbol">(</a><a id="5978" class="Keyword">quote</a> <a id="5984" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="5985" class="Symbol">)</a> <a id="5987" class="Symbol">(</a><a id="5988" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="5993" href="Meta.Reflection.Signature.html#5967" class="Bound">x</a> <a id="5995" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5997" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="6002" href="Meta.Reflection.Signature.html#5969" class="Bound">y</a> <a id="6004" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6006" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6008" class="Symbol">))</a>
<a id="6011" class="Symbol">_</a> <a id="6013" class="Symbol">=</a> <a id="6015" href="Foundations.Prim.Kan.html#1451" class="Function">refl</a>

<a id="6021" class="Comment">-- Check whether a name is defined.</a>
<a id="is-defined"></a><a id="6057" href="Meta.Reflection.Signature.html#6057" class="Function">is-defined</a> <a id="6068" class="Symbol">:</a> <a id="6070" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6075" class="Symbol">→</a> <a id="6077" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="6080" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6085" href="Meta.Reflection.Signature.html#6057" class="Function">is-defined</a> <a id="6096" href="Meta.Reflection.Signature.html#6096" class="Bound">nm</a> <a id="6099" class="Symbol">=</a> <a id="6101" class="Symbol">(</a><a id="6102" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="6107" href="Meta.Effect.Map.html#549" class="Function Operator">&lt;$</a> <a id="6110" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="6119" href="Meta.Reflection.Signature.html#6096" class="Bound">nm</a><a id="6121" class="Symbol">)</a> <a id="6123" href="Meta.Effect.Alt.html#320" class="Field Operator">&lt;|&gt;</a> <a id="6127" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="6132" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="6139" class="Comment">-- Render a defined name as it would appear in the current scope.</a>
<a id="6205" class="Comment">--</a>
<a id="6208" class="Comment">-- This will be the &quot;least qualified&quot; possible concrete representation</a>
<a id="6279" class="Comment">-- for the given name, if one is available.</a>
<a id="6323" class="Comment">--</a>
<a id="6326" class="Comment">-- If the name is not defined, return the shown representation, which is</a>
<a id="6399" class="Comment">-- fully qualified.</a>
<a id="render-name"></a><a id="6419" href="Meta.Reflection.Signature.html#6419" class="Function">render-name</a> <a id="6431" class="Symbol">:</a> <a id="6433" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6438" class="Symbol">→</a> <a id="6440" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="6443" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="6450" href="Meta.Reflection.Signature.html#6419" class="Function">render-name</a> <a id="6462" href="Meta.Reflection.Signature.html#6462" class="Bound">def-nm</a> <a id="6469" class="Symbol">=</a> <a id="6471" class="Keyword">do</a>
  <a id="6476" href="Meta.Reflection.Signature.html#6476" class="Bound">d</a> <a id="6478" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="6480" href="Meta.Reflection.Signature.html#6057" class="Function">is-defined</a> <a id="6491" href="Meta.Reflection.Signature.html#6462" class="Bound">def-nm</a>
  <a id="6500" class="Keyword">let</a>
    <a id="6508" href="Meta.Reflection.Signature.html#6508" class="Bound">fancy</a> <a id="6514" class="Symbol">=</a> <a id="6516" href="Agda.Builtin.Reflection.html#9732" class="Postulate">get-definition</a> <a id="6531" href="Meta.Reflection.Signature.html#6462" class="Bound">def-nm</a> <a id="6538" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="6542" class="Symbol">λ</a> <a id="6544" class="Keyword">where</a>
      <a id="6556" class="Symbol">(</a><a id="6557" href="Agda.Builtin.Reflection.html#7680" class="InductiveConstructor">data-cons</a> <a id="6567" class="Symbol">_)</a> <a id="6570" class="Symbol">→</a> <a id="6572" href="Agda.Builtin.Reflection.html#10895" class="Postulate">format-error-parts</a> <a id="6591" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="6593" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="6601" class="Symbol">(</a><a id="6602" href="Meta.Reflection.Base.html#16048" class="InductiveConstructor">con₀</a> <a id="6607" href="Meta.Reflection.Signature.html#6462" class="Bound">def-nm</a><a id="6613" class="Symbol">)</a> <a id="6615" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>
      <a id="6623" class="CatchallClause Symbol">_</a>             <a id="6637" class="Symbol">→</a> <a id="6639" href="Agda.Builtin.Reflection.html#10895" class="Postulate">format-error-parts</a> <a id="6658" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="6660" href="Agda.Builtin.Reflection.html#8254" class="InductiveConstructor">termErr</a> <a id="6668" class="Symbol">(</a><a id="6669" href="Meta.Reflection.Base.html#16074" class="InductiveConstructor">def₀</a> <a id="6674" href="Meta.Reflection.Signature.html#6462" class="Bound">def-nm</a><a id="6680" class="Symbol">)</a> <a id="6682" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>
    <a id="6688" href="Meta.Reflection.Signature.html#6688" class="Bound">plain</a> <a id="6694" class="Symbol">=</a> <a id="6696" href="Meta.Show.html#831" class="Field">show</a> <a id="6701" href="Meta.Reflection.Signature.html#6462" class="Bound">def-nm</a>
  <a id="6710" href="Data.Bool.Base.html#709" class="Function Operator">if</a> <a id="6713" href="Meta.Reflection.Signature.html#6476" class="Bound">d</a> <a id="6715" href="Data.Bool.Base.html#709" class="Function Operator">then</a> <a id="6720" href="Meta.Reflection.Signature.html#6508" class="Bound">fancy</a> <a id="6726" href="Data.Bool.Base.html#709" class="Function Operator">else</a> <a id="6731" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="6736" href="Meta.Reflection.Signature.html#6688" class="Bound">plain</a>

<a id="6743" class="Comment">-- Generate a fresh name for a &quot;helper function&quot; to the given</a>
<a id="6805" class="Comment">-- definition.</a>
<a id="6820" class="Comment">-- Example: `helper-function-name (quote f) &quot;foo&quot;` will be `quote</a>
<a id="6886" class="Comment">-- f·foo`.</a>
<a id="helper-function-name"></a><a id="6897" href="Meta.Reflection.Signature.html#6897" class="Function">helper-function-name</a> <a id="6918" class="Symbol">:</a> <a id="6920" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6925" class="Symbol">→</a> <a id="6927" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="6934" class="Symbol">→</a> <a id="6936" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="6939" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
<a id="6944" href="Meta.Reflection.Signature.html#6897" class="Function">helper-function-name</a> <a id="6965" href="Meta.Reflection.Signature.html#6965" class="Bound">def-nm</a> <a id="6972" href="Meta.Reflection.Signature.html#6972" class="Bound">suf</a> <a id="6976" class="Symbol">=</a> <a id="6978" class="Keyword">do</a>
  <a id="6983" href="Meta.Reflection.Signature.html#6983" class="Bound">t</a> <a id="6985" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="6987" href="Meta.Reflection.Signature.html#6419" class="Function">render-name</a> <a id="6999" href="Meta.Reflection.Signature.html#6965" class="Bound">def-nm</a>
  <a id="7008" href="Agda.Builtin.Reflection.html#9415" class="Postulate">fresh-name</a> <a id="7019" href="Foundations.Pi.Base.html#1524" class="Function Operator">$</a> <a id="7021" href="Meta.Reflection.Signature.html#6983" class="Bound">t</a> <a id="7023" href="Meta.Append.html#188" class="Field Operator">&lt;&gt;</a> <a id="7026" class="String">&quot;·&quot;</a> <a id="7030" href="Meta.Append.html#188" class="Field Operator">&lt;&gt;</a> <a id="7033" href="Meta.Reflection.Signature.html#6972" class="Bound">suf</a>

<a id="7038" class="Comment">-- Declare and optionally define a helper function for the given</a>
<a id="7103" class="Comment">-- definition; returns the generated name.</a>
<a id="7146" class="Comment">--</a>
<a id="7149" class="Comment">-- The helper is always defined with default visibility.</a>
<a id="7206" class="Comment">--</a>
<a id="7209" class="Comment">-- If the list of clauses is empty, the function will not be declared,</a>
<a id="7280" class="Comment">-- so it can be filled in later. This supports generating</a>
<a id="7338" class="Comment">-- mutually-recursive helpers.</a>
<a id="helper-function"></a><a id="7369" href="Meta.Reflection.Signature.html#7369" class="Function">helper-function</a> <a id="7385" class="Symbol">:</a> <a id="7387" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7392" class="Symbol">→</a> <a id="7394" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7401" class="Symbol">→</a> <a id="7403" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7408" class="Symbol">→</a> <a id="7410" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7415" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a> <a id="7422" class="Symbol">→</a> <a id="7424" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="7427" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
<a id="7432" href="Meta.Reflection.Signature.html#7369" class="Function">helper-function</a> <a id="7448" href="Meta.Reflection.Signature.html#7448" class="Bound">def-nm</a> <a id="7455" href="Meta.Reflection.Signature.html#7455" class="Bound">suf</a> <a id="7459" href="Meta.Reflection.Signature.html#7459" class="Bound">ty</a> <a id="7462" href="Meta.Reflection.Signature.html#7462" class="Bound">cls</a> <a id="7466" class="Symbol">=</a> <a id="7468" class="Keyword">do</a>
  <a id="7473" href="Meta.Reflection.Signature.html#7473" class="Bound">nm</a> <a id="7476" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="7478" href="Meta.Reflection.Signature.html#6897" class="Function">helper-function-name</a> <a id="7499" href="Meta.Reflection.Signature.html#7448" class="Bound">def-nm</a> <a id="7506" href="Meta.Reflection.Signature.html#7455" class="Bound">suf</a>
  <a id="7512" href="Agda.Builtin.Reflection.html#9453" class="Postulate">declare-def</a> <a id="7524" class="Symbol">(</a><a id="7525" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="7530" href="Meta.Reflection.Signature.html#7473" class="Bound">nm</a><a id="7532" class="Symbol">)</a> <a id="7534" href="Meta.Reflection.Signature.html#7459" class="Bound">ty</a>
  <a id="7539" href="Foundations.Pi.Base.html#2117" class="Function Operator">case</a> <a id="7544" href="Meta.Reflection.Signature.html#7462" class="Bound">cls</a> <a id="7548" href="Foundations.Pi.Base.html#2117" class="Function Operator">of</a> <a id="7551" class="Symbol">λ</a> <a id="7553" class="Keyword">where</a>
    <a id="7563" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="7566" class="Symbol">→</a> <a id="7568" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="7573" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
    <a id="7580" class="CatchallClause Symbol">_</a>  <a id="7583" class="Symbol">→</a> <a id="7585" href="Agda.Builtin.Reflection.html#9649" class="Postulate">define-function</a> <a id="7601" href="Meta.Reflection.Signature.html#7473" class="Bound">nm</a> <a id="7604" href="Meta.Reflection.Signature.html#7462" class="Bound">cls</a>
  <a id="7610" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="7615" href="Meta.Reflection.Signature.html#7473" class="Bound">nm</a>

<a id="7619" class="Keyword">private</a>
  <a id="make-args"></a><a id="7629" href="Meta.Reflection.Signature.html#7629" class="Function">make-args</a> <a id="7639" class="Symbol">:</a> <a id="7641" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7643" class="Symbol">→</a> <a id="7645" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7650" class="Symbol">(</a><a id="7651" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7655" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="7656" class="Symbol">)</a> <a id="7658" class="Symbol">→</a> <a id="7660" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7665" class="Symbol">(</a><a id="7666" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7670" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="7674" class="Symbol">)</a>
  <a id="7678" href="Meta.Reflection.Signature.html#7629" class="Function">make-args</a> <a id="7688" href="Meta.Reflection.Signature.html#7688" class="Bound">n</a> <a id="7690" href="Meta.Reflection.Signature.html#7690" class="Bound">xs</a> <a id="7693" class="Symbol">=</a> <a id="7695" href="Data.List.Base.html#924" class="Function">reverse-fast</a> <a id="7708" href="Foundations.Pi.Base.html#1524" class="Function Operator">$</a> <a id="7710" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="7714" class="Symbol">(</a><a id="7715" href="Meta.Effect.Map.html#344" class="Field">map</a> <a id="7719" class="Symbol">(λ</a> <a id="7722" href="Meta.Reflection.Signature.html#7722" class="Bound">i</a> <a id="7724" class="Symbol">→</a> <a id="7726" href="Meta.Reflection.Base.html#16100" class="InductiveConstructor">var₀</a> <a id="7731" class="Symbol">(</a><a id="7732" href="Meta.Reflection.Signature.html#7688" class="Bound">n</a> <a id="7734" href="Data.Nat.Base.html#320" class="Primitive Operator">∸</a> <a id="7736" href="Meta.Reflection.Signature.html#7722" class="Bound">i</a> <a id="7738" href="Data.Nat.Base.html#320" class="Primitive Operator">∸</a> <a id="7740" class="Number">1</a><a id="7741" class="Symbol">)))</a> <a id="7745" href="Meta.Reflection.Signature.html#7690" class="Bound">xs</a>

  <a id="class-for-param"></a><a id="7751" href="Meta.Reflection.Signature.html#7751" class="Function">class-for-param</a> <a id="7767" class="Symbol">:</a> <a id="7769" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7774" class="Symbol">→</a> <a id="7776" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7778" class="Symbol">→</a> <a id="7780" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7785" class="Symbol">(</a><a id="7786" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7790" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="7791" class="Symbol">)</a> <a id="7793" class="Symbol">→</a> <a id="7795" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7800" class="Symbol">→</a> <a id="7802" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="7808" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="7815" href="Meta.Reflection.Signature.html#7751" class="Function">class-for-param</a> <a id="7831" href="Meta.Reflection.Signature.html#7831" class="Bound">class</a> <a id="7837" href="Meta.Reflection.Signature.html#7837" class="Bound">n</a> <a id="7839" href="Meta.Reflection.Signature.html#7839" class="Bound">xs</a> <a id="7842" class="Symbol">(</a><a id="7843" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">agda-sort</a> <a id="7853" class="Symbol">_)</a> <a id="7856" class="Symbol">=</a>
    <a id="7862" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7867" class="Symbol">(</a><a id="7868" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="7872" href="Meta.Reflection.Signature.html#7831" class="Bound">class</a> <a id="7878" class="Symbol">(</a><a id="7879" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="7884" class="Symbol">(</a><a id="7885" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="7889" href="Meta.Reflection.Signature.html#7837" class="Bound">n</a> <a id="7891" class="Symbol">(</a><a id="7892" href="Meta.Reflection.Signature.html#7629" class="Function">make-args</a> <a id="7902" href="Meta.Reflection.Signature.html#7837" class="Bound">n</a> <a id="7904" href="Meta.Reflection.Signature.html#7839" class="Bound">xs</a><a id="7906" class="Symbol">))</a> <a id="7909" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7911" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7913" class="Symbol">))</a>
  <a id="7918" href="Meta.Reflection.Signature.html#7751" class="Function">class-for-param</a> <a id="7934" href="Meta.Reflection.Signature.html#7934" class="Bound">class</a> <a id="7940" href="Meta.Reflection.Signature.html#7940" class="Bound">n</a> <a id="7942" href="Meta.Reflection.Signature.html#7942" class="Bound">xs</a> <a id="7945" class="Symbol">(</a><a id="7946" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="7949" href="Meta.Reflection.Signature.html#7949" class="Bound">a</a> <a id="7951" class="Symbol">(</a><a id="7952" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="7956" href="Meta.Reflection.Signature.html#7956" class="Bound">s</a> <a id="7958" href="Meta.Reflection.Signature.html#7958" class="Bound">b</a><a id="7959" class="Symbol">))</a> <a id="7962" class="Symbol">=</a>
    <a id="7968" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="7971" class="Symbol">(</a><a id="7972" href="Meta.Reflection.Base.html#5128" class="Function">argH</a> <a id="7977" class="Symbol">(</a><a id="7978" href="Meta.Reflection.Base.html#3696" class="Function">unarg</a> <a id="7984" href="Meta.Reflection.Signature.html#7949" class="Bound">a</a><a id="7985" class="Symbol">))</a> <a id="7988" href="Foundations.Pi.Base.html#1711" class="Function Operator">∘</a> <a id="7990" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="7994" href="Meta.Reflection.Signature.html#7956" class="Bound">s</a> <a id="7996" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a>
     <a id="8005" href="Meta.Reflection.Signature.html#7751" class="Function">class-for-param</a> <a id="8021" href="Meta.Reflection.Signature.html#7934" class="Bound">class</a> <a id="8027" class="Symbol">(</a><a id="8028" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8032" href="Meta.Reflection.Signature.html#7940" class="Bound">n</a><a id="8033" class="Symbol">)</a> <a id="8035" class="Symbol">(</a><a id="8036" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="8040" class="Symbol">(</a><a id="8041" href="Meta.Reflection.Base.html#3735" class="Function">unai</a> <a id="8046" href="Meta.Reflection.Signature.html#7949" class="Bound">a</a><a id="8047" class="Symbol">)</a> <a id="8049" href="Meta.Reflection.Signature.html#7940" class="Bound">n</a> <a id="8051" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8053" href="Meta.Reflection.Signature.html#7942" class="Bound">xs</a><a id="8055" class="Symbol">)</a> <a id="8057" href="Meta.Reflection.Signature.html#7958" class="Bound">b</a>
  <a id="8061" href="Meta.Reflection.Signature.html#7751" class="CatchallClause Function">class-for-param</a><a id="8076" class="CatchallClause"> </a><a id="8077" class="CatchallClause Symbol">_</a><a id="8078" class="CatchallClause"> </a><a id="8079" class="CatchallClause Symbol">_</a><a id="8080" class="CatchallClause"> </a><a id="8081" class="CatchallClause Symbol">_</a><a id="8082" class="CatchallClause"> </a><a id="8083" class="CatchallClause Symbol">_</a> <a id="8085" class="Symbol">=</a> <a id="8087" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

  <a id="compute-telescope"></a><a id="8098" href="Meta.Reflection.Signature.html#8098" class="Function">compute-telescope</a> <a id="8116" class="Symbol">:</a> <a id="8118" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8123" class="Symbol">→</a> <a id="8125" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8127" class="Symbol">→</a> <a id="8129" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8134" class="Symbol">(</a><a id="8135" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8139" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="8140" class="Symbol">)</a> <a id="8142" class="Symbol">→</a> <a id="8144" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="8154" class="Symbol">→</a> <a id="8156" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="8166" class="Symbol">→</a> <a id="8168" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="8178" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="8180" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8185" class="Symbol">(</a><a id="8186" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8190" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="8194" class="Symbol">)</a>
  <a id="8198" href="Meta.Reflection.Signature.html#8098" class="Function">compute-telescope</a> <a id="8216" href="Meta.Reflection.Signature.html#8216" class="Bound">d</a> <a id="8218" href="Meta.Reflection.Signature.html#8218" class="Bound">n</a> <a id="8220" href="Meta.Reflection.Signature.html#8220" class="Bound">xs</a> <a id="8223" href="Meta.Reflection.Signature.html#8223" class="Bound">is</a> <a id="8226" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8229" class="Symbol">=</a> <a id="8231" href="Data.List.Base.html#835" class="Function">reverse</a> <a id="8239" href="Meta.Reflection.Signature.html#8223" class="Bound">is</a> <a id="8242" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8244" href="Meta.Reflection.Signature.html#7629" class="Function">make-args</a> <a id="8254" class="Symbol">(</a><a id="8255" href="Meta.Reflection.Signature.html#8218" class="Bound">n</a> <a id="8257" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="8259" href="Data.List.Operations.html#554" class="Function">length</a> <a id="8266" href="Meta.Reflection.Signature.html#8223" class="Bound">is</a><a id="8268" class="Symbol">)</a> <a id="8270" href="Meta.Reflection.Signature.html#8220" class="Bound">xs</a>
  <a id="8275" href="Meta.Reflection.Signature.html#8098" class="Function">compute-telescope</a> <a id="8293" href="Meta.Reflection.Signature.html#8293" class="Bound">d</a> <a id="8295" href="Meta.Reflection.Signature.html#8295" class="Bound">n</a> <a id="8297" href="Meta.Reflection.Signature.html#8297" class="Bound">xs</a> <a id="8300" href="Meta.Reflection.Signature.html#8300" class="Bound">is</a> <a id="8303" class="Symbol">((</a><a id="8305" href="Meta.Reflection.Signature.html#8305" class="Bound">x</a> <a id="8307" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8309" href="Meta.Reflection.Signature.html#8309" class="Bound">a</a><a id="8310" class="Symbol">)</a> <a id="8312" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8314" href="Meta.Reflection.Signature.html#8314" class="Bound">tel</a><a id="8317" class="Symbol">)</a> <a id="8319" class="Symbol">=</a>
    <a id="8325" class="Keyword">let</a>
      <a id="8335" href="Meta.Reflection.Signature.html#8335" class="Bound">narg</a> <a id="8340" class="Symbol">=</a> <a id="8342" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="8346" class="Symbol">(</a><a id="8347" href="Meta.Reflection.Base.html#3735" class="Function">unai</a> <a id="8352" href="Meta.Reflection.Signature.html#8309" class="Bound">a</a><a id="8353" class="Symbol">)</a> <a id="8355" href="Meta.Reflection.Signature.html#8295" class="Bound">n</a>
      <a id="8363" href="Meta.Reflection.Signature.html#8363" class="Bound">is′</a> <a id="8367" class="Symbol">=</a> <a id="8369" href="Meta.Effect.Traversable.html#293" class="Field">traverse</a> <a id="8378" class="Symbol">(λ</a> <a id="8381" class="Symbol">(</a><a id="8382" href="Meta.Reflection.Signature.html#8382" class="Bound">s</a> <a id="8384" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8386" href="Meta.Reflection.Signature.html#8386" class="Bound">t</a><a id="8387" class="Symbol">)</a> <a id="8389" class="Symbol">→</a> <a id="8391" href="Meta.Reflection.Subst.html#1849" class="Function">raise</a> <a id="8397" class="Number">1</a> <a id="8399" href="Meta.Reflection.Signature.html#8386" class="Bound">t</a> <a id="8401" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="8405" class="Symbol">λ</a> <a id="8407" href="Meta.Reflection.Signature.html#8407" class="Bound">x</a> <a id="8409" class="Symbol">→</a> <a id="8411" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="8416" class="Symbol">(</a><a id="8417" href="Meta.Reflection.Signature.html#8382" class="Bound">s</a> <a id="8419" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8421" href="Meta.Reflection.Signature.html#8407" class="Bound">x</a><a id="8422" class="Symbol">))</a> <a id="8425" href="Meta.Reflection.Signature.html#8300" class="Bound">is</a>
      <a id="8434" href="Meta.Reflection.Signature.html#8434" class="Bound">z</a> <a id="8436" class="Symbol">:</a> <a id="8438" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8444" class="Symbol">(</a><a id="8445" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="8455" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="8457" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8462" class="Symbol">(</a><a id="8463" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8467" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="8471" class="Symbol">))</a>
      <a id="8480" href="Meta.Reflection.Signature.html#8434" class="Bound">z</a> <a id="8482" class="Symbol">=</a> <a id="8484" href="Foundations.Pi.Base.html#2117" class="Function Operator">case</a> <a id="8489" class="Symbol">(</a><a id="8490" href="Meta.Reflection.Subst.html#1849" class="Function">raise</a> <a id="8496" class="Number">1</a> <a id="8498" class="Symbol">(</a><a id="8499" href="Meta.Reflection.Base.html#3696" class="Function">unarg</a> <a id="8505" href="Meta.Reflection.Signature.html#8309" class="Bound">a</a><a id="8506" class="Symbol">)</a> <a id="8508" href="Meta.Effect.Bind.html#266" class="Field Operator">&gt;&gt;=</a> <a id="8512" href="Meta.Reflection.Signature.html#7751" class="Function">class-for-param</a> <a id="8528" href="Meta.Reflection.Signature.html#8293" class="Bound">d</a> <a id="8530" class="Number">0</a> <a id="8532" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8534" class="Symbol">)</a> <a id="8536" href="Foundations.Pi.Base.html#2117" class="Function Operator">of</a> <a id="8539" class="Symbol">λ</a> <a id="8541" class="Keyword">where</a>
        <a id="8555" class="Symbol">(</a><a id="8556" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8561" href="Meta.Reflection.Signature.html#8561" class="Bound">i</a><a id="8562" class="Symbol">)</a> <a id="8564" class="Symbol">→</a> <a id="8566" class="Keyword">do</a>
          <a id="8579" href="Meta.Reflection.Signature.html#8579" class="Bound">is″</a> <a id="8583" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="8585" href="Meta.Reflection.Signature.html#8363" class="Bound">is′</a>
          <a id="8599" href="Meta.Reflection.Signature.html#8599" class="Bound">r</a> <a id="8601" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="8603" href="Meta.Reflection.Subst.html#1849" class="Function">raise</a> <a id="8609" class="Symbol">(</a><a id="8610" href="Data.List.Operations.html#554" class="Function">length</a> <a id="8617" href="Meta.Reflection.Signature.html#8300" class="Bound">is</a><a id="8619" class="Symbol">)</a> <a id="8621" href="Meta.Reflection.Signature.html#8561" class="Bound">i</a>
          <a id="8633" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="8638" href="Foundations.Pi.Base.html#1524" class="Function Operator">$</a> <a id="8640" href="Meta.Reflection.Signature.html#8098" class="Function">compute-telescope</a> <a id="8658" href="Meta.Reflection.Signature.html#8293" class="Bound">d</a> <a id="8660" class="Symbol">(</a><a id="8661" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8665" href="Meta.Reflection.Signature.html#8295" class="Bound">n</a><a id="8666" class="Symbol">)</a> <a id="8668" class="Symbol">(</a><a id="8669" href="Meta.Reflection.Signature.html#8335" class="Bound">narg</a> <a id="8674" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8676" href="Meta.Reflection.Signature.html#8297" class="Bound">xs</a><a id="8678" class="Symbol">)</a> <a id="8680" class="Symbol">((</a><a id="8682" href="Meta.Reflection.Signature.html#8305" class="Bound">x</a> <a id="8684" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8686" href="Meta.Reflection.Base.html#5133" class="Function">argI</a> <a id="8691" href="Meta.Reflection.Signature.html#8599" class="Bound">r</a><a id="8692" class="Symbol">)</a> <a id="8694" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8696" href="Meta.Reflection.Signature.html#8579" class="Bound">is″</a><a id="8699" class="Symbol">)</a> <a id="8701" href="Meta.Reflection.Signature.html#8314" class="Bound">tel</a>
        <a id="8713" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="8721" class="Symbol">→</a> <a id="8723" class="Keyword">do</a>
          <a id="8736" href="Meta.Reflection.Signature.html#8736" class="Bound">is″</a> <a id="8740" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="8742" href="Meta.Reflection.Signature.html#8363" class="Bound">is′</a>
          <a id="8756" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="8761" href="Foundations.Pi.Base.html#1524" class="Function Operator">$</a> <a id="8763" href="Meta.Reflection.Signature.html#8098" class="Function">compute-telescope</a> <a id="8781" href="Meta.Reflection.Signature.html#8293" class="Bound">d</a> <a id="8783" class="Symbol">(</a><a id="8784" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8788" href="Meta.Reflection.Signature.html#8295" class="Bound">n</a><a id="8789" class="Symbol">)</a> <a id="8791" class="Symbol">(</a><a id="8792" href="Meta.Reflection.Signature.html#8335" class="Bound">narg</a> <a id="8797" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8799" href="Meta.Reflection.Signature.html#8297" class="Bound">xs</a><a id="8801" class="Symbol">)</a> <a id="8803" href="Meta.Reflection.Signature.html#8736" class="Bound">is″</a> <a id="8807" href="Meta.Reflection.Signature.html#8314" class="Bound">tel</a>
    <a id="8815" class="Keyword">in</a> <a id="8818" href="Foundations.Pi.Base.html#2117" class="Function Operator">case</a> <a id="8823" href="Meta.Reflection.Signature.html#8434" class="Bound">z</a> <a id="8825" href="Foundations.Pi.Base.html#2117" class="Function Operator">of</a> <a id="8828" class="Symbol">λ</a> <a id="8830" class="Keyword">where</a>
      <a id="8842" class="Symbol">(</a><a id="8843" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8848" class="Symbol">(</a><a id="8849" href="Meta.Reflection.Signature.html#8849" class="Bound">tele</a> <a id="8854" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8856" href="Meta.Reflection.Signature.html#8856" class="Bound">args</a><a id="8860" class="Symbol">))</a> <a id="8863" class="Symbol">→</a> <a id="8865" class="Symbol">(</a><a id="8866" href="Meta.Reflection.Signature.html#8305" class="Bound">x</a> <a id="8868" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8870" href="Meta.Reflection.Base.html#5128" class="Function">argH</a> <a id="8875" class="Symbol">(</a><a id="8876" href="Meta.Reflection.Base.html#3696" class="Function">unarg</a> <a id="8882" href="Meta.Reflection.Signature.html#8309" class="Bound">a</a><a id="8883" class="Symbol">))</a> <a id="8886" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8888" href="Meta.Reflection.Signature.html#8849" class="Bound">tele</a> <a id="8893" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8895" href="Meta.Reflection.Signature.html#8856" class="Bound">args</a>
      <a id="8906" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="8914" class="Symbol">→</a> <a id="8916" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8919" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8921" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8924" class="Comment">-- ???</a>

<a id="8932" class="Comment">-- Given the name of a &quot;class&quot;, and the name of a &quot;data type&quot;, compute</a>
<a id="9003" class="Comment">-- the telescope, and arguments *of the data type*, for a &quot;derived</a>
<a id="9070" class="Comment">-- instance&quot; of that class. This is best demonstrated by example:</a>
<a id="9136" class="Comment">--</a>
<a id="9139" class="Comment">--   instance-telescope (quote Show) (quote Vec) =</a>
<a id="9190" class="Comment">--     ( {ℓ : Level} {A : Type ℓ} ⦃ _ : Show A ⦄ {n : Nat}</a>
<a id="9249" class="Comment">--     , [ ℓ , A , n ]</a>
<a id="9272" class="Comment">--     )</a>
<a id="9281" class="Comment">--</a>
<a id="9284" class="Comment">-- That is, all the parameters of the data type are bound invisibly, and</a>
<a id="9357" class="Comment">-- parameters that (end in) a type additionally have corresponding</a>
<a id="9424" class="Comment">-- instances of the class available.</a>
<a id="instance-telescope"></a><a id="9461" href="Meta.Reflection.Signature.html#9461" class="Function">instance-telescope</a> <a id="9480" class="Symbol">:</a> <a id="9482" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9487" class="Symbol">→</a> <a id="9489" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9494" class="Symbol">→</a> <a id="9496" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="9499" class="Symbol">(</a><a id="9500" href="Agda.Builtin.Reflection.html#5076" class="Function">Telescope</a> <a id="9510" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="9512" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9517" class="Symbol">(</a><a id="9518" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="9522" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="9526" class="Symbol">))</a>
<a id="9529" href="Meta.Reflection.Signature.html#9461" class="Function">instance-telescope</a> <a id="9548" href="Meta.Reflection.Signature.html#9548" class="Bound">class</a> <a id="9554" href="Meta.Reflection.Signature.html#9554" class="Bound">dat</a> <a id="9558" class="Symbol">=</a> <a id="9560" class="Keyword">do</a>
  <a id="9565" class="Symbol">(</a><a id="9566" href="Meta.Reflection.Signature.html#9566" class="Bound">tele</a> <a id="9571" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9573" class="Symbol">_)</a> <a id="9576" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="9578" href="Meta.Reflection.Base.html#8193" class="Function">pi-view</a> <a id="9586" href="Meta.Effect.Map.html#494" class="Function Operator">&lt;$&gt;</a> <a id="9590" href="Agda.Builtin.Reflection.html#9696" class="Postulate">get-type</a> <a id="9599" href="Meta.Reflection.Signature.html#9554" class="Bound">dat</a>
  <a id="9605" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="9610" class="Symbol">(</a><a id="9611" href="Meta.Reflection.Signature.html#8098" class="Function">compute-telescope</a> <a id="9629" href="Meta.Reflection.Signature.html#9548" class="Bound">class</a> <a id="9635" class="Number">0</a> <a id="9637" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="9640" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="9643" href="Meta.Reflection.Signature.html#9566" class="Bound">tele</a><a id="9647" class="Symbol">)</a>

<a id="9650" class="Comment">-- Like `instance-telescope`, but instead return the complete pi-type of</a>
<a id="9723" class="Comment">-- the derived instance.</a>
<a id="instance-type"></a><a id="9748" href="Meta.Reflection.Signature.html#9748" class="Function">instance-type</a> <a id="9762" class="Symbol">:</a> <a id="9764" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9769" class="Symbol">→</a> <a id="9771" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9776" class="Symbol">→</a> <a id="9778" href="Agda.Builtin.Reflection.html#8602" class="Postulate">TC</a> <a id="9781" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="9786" href="Meta.Reflection.Signature.html#9748" class="Function">instance-type</a> <a id="9800" href="Meta.Reflection.Signature.html#9800" class="Bound">class</a> <a id="9806" href="Meta.Reflection.Signature.html#9806" class="Bound">dat</a> <a id="9810" class="Symbol">=</a> <a id="9812" class="Keyword">do</a>
  <a id="9817" class="Symbol">(</a><a id="9818" href="Meta.Reflection.Signature.html#9818" class="Bound">tel</a> <a id="9822" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9824" href="Meta.Reflection.Signature.html#9824" class="Bound">vs</a><a id="9826" class="Symbol">)</a> <a id="9828" href="Meta.Effect.Bind.html#266" class="Field Operator">←</a> <a id="9830" href="Meta.Reflection.Signature.html#9461" class="Function">instance-telescope</a> <a id="9849" href="Meta.Reflection.Signature.html#9800" class="Bound">class</a> <a id="9855" href="Meta.Reflection.Signature.html#9806" class="Bound">dat</a>
  <a id="9861" href="Meta.Effect.Idiom.html#354" class="Field">pure</a> <a id="9866" href="Foundations.Pi.Base.html#1524" class="Function Operator">$</a> <a id="9868" href="Meta.Reflection.Base.html#8325" class="Function">unpi-view</a> <a id="9878" href="Meta.Reflection.Signature.html#9818" class="Bound">tel</a> <a id="9882" href="Foundations.Pi.Base.html#1524" class="Function Operator">$</a> <a id="9884" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="9888" href="Meta.Reflection.Signature.html#9800" class="Bound">class</a> <a id="9894" href="Meta.Literals.FromProduct.html#385" class="Function Operator">[</a> <a id="9896" href="Meta.Reflection.Base.html#5138" class="Function">argN</a> <a id="9901" class="Symbol">(</a><a id="9902" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="9906" href="Meta.Reflection.Signature.html#9806" class="Bound">dat</a> <a id="9910" href="Meta.Reflection.Signature.html#9824" class="Bound">vs</a><a id="9912" class="Symbol">)</a> <a id="9914" href="Meta.Literals.FromProduct.html#385" class="Function Operator">]</a>
</pre></body></html>