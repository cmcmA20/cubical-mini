<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Meta.Search.Decidable</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Meta.Search.Decidable.html" class="Module">Meta.Search.Decidable</a> <a id="53" class="Keyword">where</a>

<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="Foundations.Base.html" class="Module">Foundations.Base</a>
<a id="89" class="Keyword">open</a> <a id="94" class="Keyword">import</a> <a id="101" href="Foundations.Equiv.html" class="Module">Foundations.Equiv</a>

<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Meta.Reflection.html" class="Module">Meta.Reflection</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Meta.Search.Base.html" class="Module">Meta.Search.Base</a> <a id="177" class="Keyword">public</a>

<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Correspondences.Decidable.html" class="Module">Correspondences.Decidable</a>
<a id="223" class="Keyword">open</a> <a id="228" href="Correspondences.Decidable.html" class="Module">Correspondences.Decidable</a> <a id="254" class="Keyword">public</a>
  <a id="263" class="Keyword">using</a> <a id="269" class="Symbol">(</a> <a id="271" href="Correspondences.Decidable.html#534" class="Function">decide</a> <a id="278" class="Symbol">;</a> <a id="280" href="Correspondences.Decidable.html#583" class="Function">×-decision</a> <a id="291" class="Symbol">;</a> <a id="293" href="Correspondences.Decidable.html#817" class="Function">fun-decision</a> <a id="306" class="Symbol">)</a>

<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="Data.Dec.Base.html" class="Module">Data.Dec.Base</a>
<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Data.Empty.Base.html" class="Module">Data.Empty.Base</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Data.Fin.Instances.FromNat.html" class="Module">Data.Fin.Instances.FromNat</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Data.List.Base.html" class="Module">Data.List.Base</a>
<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Data.List.Instances.FromProduct.html" class="Module">Data.List.Instances.FromProduct</a>

<a id="474" class="Keyword">private</a> <a id="482" class="Keyword">variable</a>
  <a id="493" href="Meta.Search.Decidable.html#493" class="Generalizable">ℓ</a> <a id="495" href="Meta.Search.Decidable.html#495" class="Generalizable">ℓ′</a> <a id="498" href="Meta.Search.Decidable.html#498" class="Generalizable">ℓa</a> <a id="501" href="Meta.Search.Decidable.html#501" class="Generalizable">ℓb</a> <a id="504" href="Meta.Search.Decidable.html#504" class="Generalizable">ℓc</a> <a id="507" href="Meta.Search.Decidable.html#507" class="Generalizable">ℓd</a> <a id="510" class="Symbol">:</a> <a id="512" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="520" href="Meta.Search.Decidable.html#520" class="Generalizable">T</a> <a id="522" class="Symbol">:</a> <a id="524" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="529" href="Meta.Search.Decidable.html#493" class="Generalizable">ℓ</a>
  <a id="533" href="Meta.Search.Decidable.html#533" class="Generalizable">A</a> <a id="535" class="Symbol">:</a> <a id="537" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="542" href="Meta.Search.Decidable.html#498" class="Generalizable">ℓa</a>
  <a id="547" href="Meta.Search.Decidable.html#547" class="Generalizable">B</a> <a id="549" class="Symbol">:</a> <a id="551" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="556" href="Meta.Search.Decidable.html#501" class="Generalizable">ℓb</a>

<a id="560" class="Keyword">instance</a>
  <a id="Tactic-decide"></a><a id="571" href="Meta.Search.Decidable.html#571" class="Function">Tactic-decide</a> <a id="585" class="Symbol">:</a> <a id="587" href="Meta.Search.Base.html#1794" class="Record">Tactic-desc</a> <a id="599" class="Symbol">(</a><a id="600" class="Keyword">quote</a> <a id="606" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="609" class="Symbol">)</a> <a id="611" href="Meta.Search.Base.html#597" class="InductiveConstructor">none</a>
  <a id="618" href="Meta.Search.Decidable.html#571" class="Function">Tactic-decide</a> <a id="632" class="Symbol">.</a><a id="633" href="Meta.Search.Base.html#1876" class="Field">Tactic-desc.args-length</a> <a id="657" class="Symbol">=</a> <a id="659" class="Number">2</a>
  <a id="663" href="Meta.Search.Decidable.html#571" class="Function">Tactic-decide</a> <a id="677" class="Symbol">.</a><a id="678" href="Meta.Search.Base.html#1896" class="Field">Tactic-desc.goal-selector</a> <a id="704" class="Symbol">=</a> <a id="706" class="Number">1</a>
  <a id="710" href="Meta.Search.Decidable.html#571" class="Function">Tactic-decide</a> <a id="724" class="Symbol">.</a><a id="725" href="Meta.Search.Base.html#2115" class="Field">Tactic-desc.other-atoms</a> <a id="749" class="Symbol">=</a> <a id="751" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="753" class="Keyword">quote</a> <a id="759" href="Agda.Builtin.Cubical.Equiv.html#1012" class="Function Operator">_≃_</a> <a id="763" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>
  <a id="767" href="Meta.Search.Decidable.html#571" class="Function">Tactic-decide</a> <a id="781" class="Symbol">.</a><a id="782" href="Meta.Search.Base.html#2143" class="Field">Tactic-desc.instance-helper</a> <a id="810" class="Symbol">=</a> <a id="812" class="Keyword">quote</a> <a id="818" href="Correspondences.Decidable.html#534" class="Function">decide</a>

<a id="decide-tactic-worker"></a><a id="826" href="Meta.Search.Decidable.html#826" class="Function">decide-tactic-worker</a> <a id="847" class="Symbol">=</a> <a id="849" href="Meta.Search.Base.html#21094" class="Function">search-tactic-worker</a> <a id="870" href="Meta.Search.Decidable.html#571" class="Function">Tactic-decide</a>
<a id="884" class="Keyword">macro</a> <a id="decide!"></a><a id="890" href="Meta.Search.Decidable.html#890" class="Function">decide!</a> <a id="898" class="Symbol">=</a> <a id="900" href="Meta.Search.Decidable.html#826" class="Function">decide-tactic-worker</a>

<a id="922" class="Keyword">instance</a>
  <a id="decomp-dec-×"></a><a id="933" href="Meta.Search.Decidable.html#933" class="Function">decomp-dec-×</a> <a id="946" class="Symbol">:</a> <a id="948" href="Meta.Search.Base.html#2777" class="Datatype">goal-decomposition</a> <a id="967" class="Symbol">(</a><a id="968" class="Keyword">quote</a> <a id="974" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="977" class="Symbol">)</a> <a id="979" class="Symbol">(</a><a id="980" href="Meta.Search.Decidable.html#533" class="Generalizable">A</a> <a id="982" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="984" href="Meta.Search.Decidable.html#547" class="Generalizable">B</a><a id="985" class="Symbol">)</a>
  <a id="989" href="Meta.Search.Decidable.html#933" class="Function">decomp-dec-×</a> <a id="1002" class="Symbol">=</a> <a id="1004" href="Meta.Search.Base.html#2928" class="InductiveConstructor">decomp</a> <a id="1011" class="Symbol">(</a><a id="1012" class="Keyword">quote</a> <a id="1018" href="Correspondences.Decidable.html#583" class="Function">×-decision</a><a id="1028" class="Symbol">)</a>
    <a id="1034" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="1036" href="Meta.Search.Base.html#2665" class="InductiveConstructor">`search</a> <a id="1044" class="Symbol">(</a><a id="1045" class="Keyword">quote</a> <a id="1051" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1054" class="Symbol">)</a> <a id="1056" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1058" href="Meta.Search.Base.html#2665" class="InductiveConstructor">`search</a> <a id="1066" class="Symbol">(</a><a id="1067" class="Keyword">quote</a> <a id="1073" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1076" class="Symbol">)</a> <a id="1078" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

  <a id="decomp-dec-neg"></a><a id="1083" href="Meta.Search.Decidable.html#1083" class="Function">decomp-dec-neg</a> <a id="1098" class="Symbol">:</a> <a id="1100" href="Meta.Search.Base.html#2777" class="Datatype">goal-decomposition</a> <a id="1119" class="Symbol">(</a><a id="1120" class="Keyword">quote</a> <a id="1126" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1129" class="Symbol">)</a> <a id="1131" class="Symbol">(</a><a id="1132" href="Data.Empty.Base.html#923" class="Function Operator">¬</a> <a id="1134" href="Meta.Search.Decidable.html#533" class="Generalizable">A</a><a id="1135" class="Symbol">)</a>
  <a id="1139" href="Meta.Search.Decidable.html#1083" class="Function">decomp-dec-neg</a> <a id="1154" class="Symbol">=</a> <a id="1156" href="Meta.Search.Base.html#2928" class="InductiveConstructor">decomp</a> <a id="1163" class="Symbol">(</a><a id="1164" class="Keyword">quote</a> <a id="1170" href="Correspondences.Decidable.html#1080" class="Function">¬-decision</a><a id="1180" class="Symbol">)</a> <a id="1182" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="1184" href="Meta.Search.Base.html#2665" class="InductiveConstructor">`search</a> <a id="1192" class="Symbol">(</a><a id="1193" class="Keyword">quote</a> <a id="1199" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1202" class="Symbol">)</a> <a id="1204" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

  <a id="decomp-dec-fun"></a><a id="1209" href="Meta.Search.Decidable.html#1209" class="Function">decomp-dec-fun</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="Meta.Search.Base.html#2777" class="Datatype">goal-decomposition</a> <a id="1245" class="Symbol">(</a><a id="1246" class="Keyword">quote</a> <a id="1252" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1255" class="Symbol">)</a> <a id="1257" class="Symbol">(</a><a id="1258" href="Meta.Search.Decidable.html#533" class="Generalizable">A</a> <a id="1260" class="Symbol">→</a> <a id="1262" href="Meta.Search.Decidable.html#547" class="Generalizable">B</a><a id="1263" class="Symbol">)</a>
  <a id="1267" href="Meta.Search.Decidable.html#1209" class="Function">decomp-dec-fun</a> <a id="1282" class="Symbol">=</a> <a id="1284" href="Meta.Search.Base.html#2928" class="InductiveConstructor">decomp</a> <a id="1291" class="Symbol">(</a><a id="1292" class="Keyword">quote</a> <a id="1298" href="Correspondences.Decidable.html#817" class="Function">fun-decision</a><a id="1310" class="Symbol">)</a> <a id="1312" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="1314" href="Meta.Search.Base.html#2665" class="InductiveConstructor">`search</a> <a id="1322" class="Symbol">(</a><a id="1323" class="Keyword">quote</a> <a id="1329" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1332" class="Symbol">)</a> <a id="1334" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1336" href="Meta.Search.Base.html#2665" class="InductiveConstructor">`search</a> <a id="1344" class="Symbol">(</a><a id="1345" class="Keyword">quote</a> <a id="1351" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1354" class="Symbol">)</a> <a id="1356" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

  <a id="decomp-dec-lift"></a><a id="1361" href="Meta.Search.Decidable.html#1361" class="Function">decomp-dec-lift</a> <a id="1377" class="Symbol">:</a> <a id="1379" href="Meta.Search.Base.html#2777" class="Datatype">goal-decomposition</a> <a id="1398" class="Symbol">(</a><a id="1399" class="Keyword">quote</a> <a id="1405" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1408" class="Symbol">)</a> <a id="1410" class="Symbol">(</a><a id="1411" href="Foundations.Prim.Type.html#538" class="Record">Lift</a> <a id="1416" href="Meta.Search.Decidable.html#493" class="Generalizable">ℓ</a> <a id="1418" href="Meta.Search.Decidable.html#533" class="Generalizable">A</a><a id="1419" class="Symbol">)</a>
  <a id="1423" href="Meta.Search.Decidable.html#1361" class="Function">decomp-dec-lift</a> <a id="1439" class="Symbol">=</a> <a id="1441" href="Meta.Search.Base.html#2928" class="InductiveConstructor">decomp</a> <a id="1448" class="Symbol">(</a><a id="1449" class="Keyword">quote</a> <a id="1455" href="Correspondences.Decidable.html#1223" class="Function">lift-decision</a><a id="1468" class="Symbol">)</a> <a id="1470" href="Meta.Literals.FromProduct.html#325" class="Function Operator">[</a> <a id="1472" href="Meta.Search.Base.html#2665" class="InductiveConstructor">`search</a> <a id="1480" class="Symbol">(</a><a id="1481" class="Keyword">quote</a> <a id="1487" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1490" class="Symbol">)</a> <a id="1492" href="Meta.Literals.FromProduct.html#325" class="Function Operator">]</a>

  <a id="decomp-dec-uni"></a><a id="1497" href="Meta.Search.Decidable.html#1497" class="Function">decomp-dec-uni</a> <a id="1512" class="Symbol">:</a> <a id="1514" href="Meta.Search.Base.html#2777" class="Datatype">goal-decomposition</a> <a id="1533" class="Symbol">(</a><a id="1534" class="Keyword">quote</a> <a id="1540" href="Data.Dec.Base.html#1386" class="Record">Dec</a><a id="1543" class="Symbol">)</a> <a id="1545" class="Symbol">(</a><a id="1546" href="Foundations.Prim.Type.html#295" class="Primitive">Type</a> <a id="1551" href="Meta.Search.Decidable.html#493" class="Generalizable">ℓ</a><a id="1552" class="Symbol">)</a>
  <a id="1556" href="Meta.Search.Decidable.html#1497" class="Function">decomp-dec-uni</a> <a id="1571" class="Symbol">=</a> <a id="1573" href="Meta.Search.Base.html#2928" class="InductiveConstructor">decomp</a> <a id="1580" class="Symbol">(</a><a id="1581" class="Keyword">quote</a> <a id="1587" href="Correspondences.Decidable.html#1389" class="Function">universe-decision</a><a id="1604" class="Symbol">)</a> <a id="1606" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="1610" class="Comment">-- Usage</a>
<a id="1619" class="Keyword">private</a>
  <a id="1629" class="Keyword">module</a> <a id="1636" href="Meta.Search.Decidable.html#1636" class="Module">_</a> <a id="1638" class="Symbol">⦃</a> <a id="1640" href="Meta.Search.Decidable.html#1640" class="Bound">A?</a> <a id="1643" class="Symbol">:</a> <a id="1645" href="Data.Dec.Base.html#1386" class="Record">Dec</a> <a id="1649" href="Meta.Search.Decidable.html#533" class="Generalizable">A</a> <a id="1651" class="Symbol">⦄</a> <a id="1653" class="Symbol">⦃</a> <a id="1655" href="Meta.Search.Decidable.html#1655" class="Bound">B?</a> <a id="1658" class="Symbol">:</a> <a id="1660" href="Data.Dec.Base.html#1386" class="Record">Dec</a> <a id="1664" href="Meta.Search.Decidable.html#547" class="Generalizable">B</a> <a id="1666" class="Symbol">⦄</a> <a id="1668" class="Keyword">where</a>
    <a id="1678" href="Meta.Search.Decidable.html#1678" class="Function">_</a> <a id="1680" class="Symbol">:</a> <a id="1682" href="Data.Dec.Base.html#1386" class="Record">Dec</a> <a id="1686" class="Symbol">(</a><a id="1687" href="Data.Empty.Base.html#923" class="Function Operator">¬</a> <a id="1689" href="Meta.Search.Decidable.html#1649" class="Bound">A</a> <a id="1691" class="Symbol">→</a> <a id="1693" href="Meta.Search.Decidable.html#1664" class="Bound">B</a> <a id="1695" href="Foundations.Sigma.Base.html#588" class="Function Operator">×</a> <a id="1697" href="Meta.Search.Decidable.html#1649" class="Bound">A</a><a id="1698" class="Symbol">)</a>
    <a id="1704" class="Symbol">_</a> <a id="1706" class="Symbol">=</a> <a id="1708" href="Meta.Search.Decidable.html#890" class="Macro">decide!</a>
</pre></body></html>